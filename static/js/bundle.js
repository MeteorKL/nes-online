webpackJsonp([0],[function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}var r=i(1),n=s(r),o=i(28),a=s(o),l=i(166),u=i(204);i(257);var h=i(261),c=s(h),d=i(291),p=s(d),f=i(295),m=s(f),_=i(302),g=s(_),b=i(305),R=s(b),E=i(306),y=s(E),S=i(307),v=s(S),T=i(313),O=s(T),A=i(280),C=(s(A),i(266)),w=s(C),N=i(272),k=(s(N),i(264));s(k);a.default.render(n.default.createElement("div",null,n.default.createElement(l.Provider,{store:w.default},n.default.createElement(u.Router,{history:u.hashHistory},n.default.createElement(u.Route,{path:"/",component:c.default},n.default.createElement(u.IndexRoute,{component:m.default}),n.default.createElement(u.Route,{path:"/gameList",component:m.default}),n.default.createElement(u.Route,{path:"/game/:gameName",component:p.default}),n.default.createElement(u.Route,{path:"/roomList",component:g.default}),n.default.createElement(u.Route,{path:"/active/:active_code",component:R.default}),n.default.createElement(u.Route,{path:"/resetPassword/:verifyCode",component:y.default}),n.default.createElement(u.Route,{path:"/settings/account",component:v.default}),n.default.createElement(u.Route,{path:"/room/:roomID",component:O.default}))))),document.getElementById("App"));(function(){"undefined"==typeof __REACT_HOT_LOADER__})()},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){var s=i(258);"string"==typeof s&&(s=[[e.id,s,""]]);i(260)(s,{});s.locals&&(e.exports=s.locals)},function(e,t,i){t=e.exports=i(259)(),t.push([e.id,"html{-webkit-tap-highlight-color:transparent;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%}body{font-size:14.5px;line-height:1.8;font-family:Consolas,monaco,Helvetica Neue,Helvetica,Arial,Hiragino Sans GB,Microsoft YaHei,微软雅黑,STHeiti,WenQuanYi Micro Hei,sans-serif}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}*{margin:0;padding:0;box-sizing:border-box}a{color:#2561c2;text-decoration:none;background-color:transparent}a:focus,a:hover{color:#b42522}:focus,:hover{transition:all .3s}a:focus,a:hover{text-decoration:none}p{margin:0 0 10px}:after,:before{box-sizing:border-box}",""])},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var i=this[t];i[2]?e.push("@media "+i[2]+"{"+i[1]+"}"):e.push(i[1])}return e.join("")},e.i=function(t,i){"string"==typeof t&&(t=[[null,t,""]]);for(var s={},r=0;r<this.length;r++){var n=this[r][0];"number"==typeof n&&(s[n]=!0)}for(r=0;r<t.length;r++){var o=t[r];"number"==typeof o[0]&&s[o[0]]||(i&&!o[2]?o[2]=i:i&&(o[2]="("+o[2]+") and ("+i+")"),e.push(o))}},e}},function(e,t,i){function s(e,t){for(var i=0;i<e.length;i++){var s=e[i],r=p[s.id];if(r){r.refs++;for(var n=0;n<r.parts.length;n++)r.parts[n](s.parts[n]);for(;n<s.parts.length;n++)r.parts.push(u(s.parts[n],t))}else{for(var o=[],n=0;n<s.parts.length;n++)o.push(u(s.parts[n],t));p[s.id]={id:s.id,refs:1,parts:o}}}}function r(e){for(var t=[],i={},s=0;s<e.length;s++){var r=e[s],n=r[0],o=r[1],a=r[2],l=r[3],u={css:o,media:a,sourceMap:l};i[n]?i[n].parts.push(u):t.push(i[n]={id:n,parts:[u]})}return t}function n(e,t){var i=_(),s=R[R.length-1];if("top"===e.insertAt)s?s.nextSibling?i.insertBefore(t,s.nextSibling):i.appendChild(t):i.insertBefore(t,i.firstChild),R.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");i.appendChild(t)}}function o(e){e.parentNode.removeChild(e);var t=R.indexOf(e);t>=0&&R.splice(t,1)}function a(e){var t=document.createElement("style");return t.type="text/css",n(e,t),t}function l(e){var t=document.createElement("link");return t.rel="stylesheet",n(e,t),t}function u(e,t){var i,s,r;if(t.singleton){var n=b++;i=g||(g=a(t)),s=h.bind(null,i,n,!1),r=h.bind(null,i,n,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=l(t),s=d.bind(null,i),r=function(){o(i),i.href&&URL.revokeObjectURL(i.href)}):(i=a(t),s=c.bind(null,i),r=function(){o(i)});return s(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;s(e=t)}else r()}}function h(e,t,i,s){var r=i?"":s.css;if(e.styleSheet)e.styleSheet.cssText=E(t,r);else{var n=document.createTextNode(r),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(n,o[t]):e.appendChild(n)}}function c(e,t){var i=t.css,s=t.media;if(s&&e.setAttribute("media",s),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}function d(e,t){var i=t.css,s=t.sourceMap;s&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */");var r=new Blob([i],{type:"text/css"}),n=e.href;e.href=URL.createObjectURL(r),n&&URL.revokeObjectURL(n)}var p={},f=function(e){var t;return function(){return"undefined"==typeof t&&(t=e.apply(this,arguments)),t}},m=f(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),_=f(function(){return document.head||document.getElementsByTagName("head")[0]}),g=null,b=0,R=[];e.exports=function(e,t){t=t||{},"undefined"==typeof t.singleton&&(t.singleton=m()),"undefined"==typeof t.insertAt&&(t.insertAt="bottom");var i=r(e);return s(i,t),function(e){for(var n=[],o=0;o<i.length;o++){var a=i[o],l=p[a.id];l.refs--,n.push(l)}if(e){var u=r(e);s(u,t)}for(var o=0;o<n.length;o++){var l=n[o];if(0===l.refs){for(var h=0;h<l.parts.length;h++)l.parts[h]();delete p[l.id]}}}};var E=function(){var e=[];return function(t,i){return e[t]=i,e.filter(Boolean).join("\n")}}()},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){return{user:e.user,tab:e.tab}}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),u=i(1),h=s(u),c=i(166);i(204);i(262);var d=i(264),p=s(d),f=i(272),m=s(f),_=i(284),g=s(_),b=i(288),R=s(b),E=i(289),y=s(E),S=i(290),v=s(S),T=i(280),O=i(281),A=s(O),C=function(e){function t(e){return r(this,t),n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return o(t,e),l(t,[{key:"componentWillMount",value:function(){var e=this;A.default.addOnmessage("relogin",function(t){alert("您已登录 不能重复登录"),e.props.userSet(m.default.INIT_USER_STATE)}),null!=this.props.tab&&""!=this.props.tab||this.props.user.type!=m.default.USER_UNLOGIN||p.default.checkLogin().then(function(t){return t.error?void e.props.tabSet("VisitorLogin"):(e.props.userSet(t.data),void A.default.create())})}},{key:"componentDidUpdate",value:function(){null!=this.props.tab&&""!=this.props.tab||this.props.user.type!=m.default.USER_UNLOGIN||this.props.tabSet("VisitorLogin")}},{key:"componentDidUnmount",value:function(){A.default.removeOnmessage("relogin")}},{key:"logout",value:function(){var e=this;p.default.logout().then(function(t){e.props.userSet(m.default.INIT_USER_STATE)})}},{key:"render",value:function(){var e=this,t=this.props.user.type,i=this.props.user.name;return h.default.createElement("div",null,"VisitorLogin"==this.props.tab?h.default.createElement(R.default,null):"Login"==this.props.tab?h.default.createElement(g.default,null):"Register"==this.props.tab?h.default.createElement(y.default,null):"ForgetPassword"==this.props.tab?h.default.createElement(v.default,null):h.default.createElement("div",null),h.default.createElement("div",{className:"Header"},h.default.createElement("a",{href:"#/gameList"},h.default.createElement("img",{src:"/img/logo@48.png"})),h.default.createElement("a",{href:"#/gameList"},"NES Online"),t==-1?h.default.createElement("div",{className:"Navbar"},h.default.createElement("a",{onClick:function(){return e.props.tabSet("VisitorLogin")}},"游客登录"),h.default.createElement("span",null," | "),h.default.createElement("a",{onClick:function(){return e.props.tabSet("Register")}},"注册"),h.default.createElement("span",null," | "),h.default.createElement("a",{className:"CurrentLocation",onClick:function(){return e.props.tabSet("Login")}},"登录")):0==t?h.default.createElement("div",{className:"Navbar"},h.default.createElement("a",{href:"#/settings/account"},"设置"),h.default.createElement("span",null," | "),h.default.createElement("a",{onClick:function(){return e.logout()}},"注销"),h.default.createElement("span",null," | "),h.default.createElement("span",null," ",i," ")):h.default.createElement("div",{className:"Navbar"},h.default.createElement("a",{href:"#/settings/account"},"设置"),h.default.createElement("span",null," | "),h.default.createElement("a",{onClick:function(){return e.logout()}},"注销"),h.default.createElement("span",null," | "),h.default.createElement("span",null,i))),h.default.createElement("div",{className:"Body"},this.props.children),h.default.createElement("div",{className:"Footer"},h.default.createElement("p",null,h.default.createElement("span",null," Copyright © 2017 "),h.default.createElement("a",{href:"http://MeteorKL.com/"}," MeteorKL "),h.default.createElement("a",{href:"http://www.miibeian.gov.cn/",rel:"nofollow",target:"_blank"}," 浙ICP备 16025067号-1 "))))}}]),t}(h.default.Component),w=(0,c.connect)(a,{userSet:T.userSet,tabSet:T.tabSet})(C);t.default=w;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(C,"Index","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Index.jsx"),__REACT_HOT_LOADER__.register(a,"mapStateToProps","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Index.jsx"),__REACT_HOT_LOADER__.register(w,"default","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Index.jsx"))})()},function(e,t,i){var s=i(263);"string"==typeof s&&(s=[[e.id,s,""]]);i(260)(s,{});s.locals&&(e.exports=s.locals)},function(e,t,i){t=e.exports=i(259)(),t.push([e.id,".scrollDiv{width:10px;position:absolute;top:0;bottom:0;background:#666;border-radius:10px}.scrollDiv:hover{background:#444}.Header{width:100%;margin:8px;border-bottom:1px solid #eaecef}.Header .Title{background:url(/img/logo@48.png) no-repeat;outline:none;border:0;font-size:16px;padding:6px 64px;height:64px}.Header>.Navbar{margin:10px;position:absolute;top:0;right:0}.Header>.Navbar>img{margin:0 12px;height:48px;width:48px}.Body .LocationBar{border:1px solid #eaecef;margin:10px 0;padding:5px 10px}.Body .LocationBar>a{border-bottom:1px}.Body .LocationBar>.CurrentLocation{color:#004693;border-bottom:1px solid #004693}.Footer{clear:both;border-top:1px solid #eaecef;padding:15px;text-align:center;font-size:12px;line-height:1.5;color:#586069;margin-top:20px}.Account{position:fixed;top:16px;left:0;height:32px;width:100%;background:linear-gradient(#2c2c2c,#4c4c4c)}.Account>.user{position:absolute;right:168px;top:0}.Account>.user>img{height:32px;width:32px}.Account>.user>input{position:absolute;top:0;left:40px;width:68px;outline:none;border:none;background:none;color:#fff;font-size:16px}",""])},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}var r=i(265),n=s(r),o=i(266),a=(s(o),i(280)),l=(s(a),i(272)),u=(s(l),i(281));s(u);t.checkLogin=function(){return new Promise(function(e){var t="/api/checkLogin";n.default.Post(t).then(function(t){e(JSON.parse(t))}).catch(function(e){console.error(e)})})},t.login=function(e,t){return new Promise(function(i){var s="/api/login",r="account="+e+"&password="+t;n.default.Post(s,r).then(function(e){i(JSON.parse(e))}).catch(function(e){console.error(e)})})},t.visitorLogin=function(e){return new Promise(function(t){var i="/api/visitorLogin",s="name="+e;n.default.Post(i,s).then(function(e){t(JSON.parse(e))}).catch(function(e){console.error(e)})})},t.logout=function(){return new Promise(function(e){var t="/api/logout";n.default.Post(t).then(function(t){e(t)}).catch(function(e){console.error(e)})})},t.checkMail=function(e){return new Promise(function(t){var i="/api/checkMail?mail="+e;n.default.Get(i).then(function(e){t(JSON.parse(e))}).catch(function(e){console.error(e)})})},t.checkName=function(e){return new Promise(function(t){var i="/api/checkName?name="+e;n.default.Get(i).then(function(e){t(JSON.parse(e))}).catch(function(e){console.error(e)})})},t.register=function(e,t,i){return new Promise(function(s){var r="/api/register",o="mail="+e+"&name="+t+"&password="+i;n.default.Post(r,o).then(function(e){s(JSON.parse(e))}).catch(function(e){console.error(e)})})},t.active=function(e){return new Promise(function(t){var i="/api/active",s="active_code="+e;n.default.Post(i,s).then(function(e){t(JSON.parse(e))}).catch(function(e){console.error(e)})})},t.forgetPassword=function(e){return new Promise(function(t){var i="/api/forgetPassword",s="mail="+e;n.default.Post(i,s).then(function(e){t(JSON.parse(e))}).catch(function(e){console.error(e)})})},t.resetPassword=function(e,t,i){return new Promise(function(s){var r="/api/resetPassword",o="mail="+e+"&verify_code="+t+"&password="+i;n.default.Post(r,o).then(function(e){s(JSON.parse(e))}).catch(function(e){console.error(e)})})},t.changePassword=function(e,t){return new Promise(function(i){var s="/api/changePassword",r="&oldPassword="+e+"&password="+t;n.default.Post(s,r).then(function(e){i(JSON.parse(e))}).catch(function(e){console.error(e)})})},t.changeName=function(e){return new Promise(function(t){var i="/api/changeName",s="name="+e;n.default.Post(i,s).then(function(e){t(JSON.parse(e))}).catch(function(e){console.error(e)})})};(function(){"undefined"==typeof __REACT_HOT_LOADER__})()},function(e,t){"use strict";function i(e){if("object"!=("undefined"==typeof e?"undefined":s(e)))return void alert("输入的参数必须是对象");if("function"==typeof FormData){var t=new FormData;for(var i in e)t.append(i,e[i]);return t}var r=new Array,n=0;for(var i in e)r[n]=encodeURIComponent(i)+"="+encodeURIComponent(e[i]),n++;return r.join("&")}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.Get=function(e){return new Promise(function(t,i){var s=new XMLHttpRequest;s.open("GET",e),s.send(null),s.addEventListener("readystatechange",function(){if(4===s.readyState&&200===s.status)try{t(s.responseText)}catch(e){i(e)}}),s.addEventListener("error",function(e){i(e)})})},t.GetBinary=function(e){return new Promise(function(t,i){var s=new XMLHttpRequest;s.open("GET",e),s.send(null),s.overrideMimeType("text/plain; charset=x-user-defined"),s.addEventListener("readystatechange",function(){if(4===s.readyState&&200===s.status)try{t(s.responseText)}catch(e){i(e)}}),s.addEventListener("error",function(e){i(e)})})},t.Post=function(e,t){return new Promise(function(i,s){var r=new XMLHttpRequest;r.open("POST",e,!0),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.send(t),r.addEventListener("readystatechange",function(){if(4===r.readyState&&200===r.status)try{i(r.responseText)}catch(e){s(e)}}),r.addEventListener("error",function(e){s(e)})})};(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(i,"postDataFormat","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/api/ajax.js")})()},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=i(177),n=i(267),o=s(n),a=window.__INITIAL_STATE__;window.store=(0,r.createStore)(o.default,a,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());var l=store;t.default=l;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(a,"initialState","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/store.js"),__REACT_HOT_LOADER__.register(l,"default","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/store.js"))})()},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=i(177),n=i(268),o=s(n),a=i(269),l=s(a),u=i(270),h=s(u),c=i(271),d=s(c),p=i(273),f=s(p),m=i(275),_=s(m),g=i(276),b=s(g),R=i(277),E=s(R),y=i(278),S=s(y),v=i(279),T=s(v),O=(0,r.combineReducers)({game:o.default,tab:l.default,gameTab:h.default,room:d.default,roomlist:f.default,user:_.default,msg:b.default,nes:E.default,keyboard:S.default,gamelist:T.default});t.default=O;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(O,"default","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/reducers/index.js")})()},function(e,t){"use strict";function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments[1];switch(t.type){case"gameSet":return t.game;default:return e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var s="";(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(s,"initialState","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/reducers/game.js"),__REACT_HOT_LOADER__.register(i,"reducer","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/reducers/game.js"))})()},function(e,t){"use strict";function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments[1];switch(t.type){case"tabSet":return t.tab;default:return e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var s="";(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(s,"initialState","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/reducers/tab.js"),__REACT_HOT_LOADER__.register(i,"reducer","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/reducers/tab.js"))})()},function(e,t){"use strict";function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments[1];switch(t.type){case"gameTabSet":return t.gameTab;default:return e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var s="";(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(s,"initialState","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/reducers/gameTab.js"),__REACT_HOT_LOADER__.register(i,"reducer","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/reducers/gameTab.js"))})()},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments[1];switch(t.type){case"roomSet":return t.room;case"roomTabSet":return t.roomTab;default:return e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var n=i(272),o=s(n),a={room:null,roomTab:o.default.ROOM_STATE_NORMAL};(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(a,"initialState","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/reducers/room.js"),__REACT_HOT_LOADER__.register(r,"reducer","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/reducers/room.js"))})()},function(e,t){"use strict";t.USER_UNLOGIN=-1,t.USER_VISITOR=0,t.USER_LOGIN=1,t.ROOM_PLAYER_STATE_EMPTY=0,t.ROOM_PLAYER_STATE_UNREADY=1,t.ROOM_PLAYER_STATE_READY=2,t.ROOM_PLAYER_STATE_IN_GAME=3,t.ROOM_PLAYER_STATE_TEXT=["","","已准备","游戏中"],t.ROOM_STATE_NORMAL=0,t.ROOM_STATE_IN_GAME=1,t.ROOM_STATE_TEXT=["等待开始","游戏中"],t.INIT_USER_STATE={type:t.USER_UNLOGIN};var i=document.location.host,s="http://nes.meteorkl.com"+document.location.pathname+document.location.hash;t.wsServer="ws://"+i+"/ws",t.qqRedirectURL=escape("http://"+i+"/api/loginQQ?redirect_uri="+escape(s)),t.MSG_FROM_SYSTEM="系统",t.PLAY_MODE_LOCAL=0,t.PLAY_MODE_ONLINE=1,t.DEFAULT_KEYBOARD={up:87,down:83,left:65,right:68,select:86,start:66,A:75,B:74,X:73,Y:85},t.LOADINGROOM=0,t.LOADINGMAP=1,t.LOADED=2,t.ROOM_AVATAR_TOPN="/img/open.png",t.KEYCODE_TABLE={27:"Escape",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",120:"F9",121:"F10",192:"`",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",48:"0",189:"-",187:"=",8:"Backspace",9:"Tab",81:"Q",87:"W",69:"E",82:"R",84:"T",89:"Y",85:"U",73:"I",79:"O",80:"P",219:"[",221:"]",220:"\\",20:"CapsLock",65:"A",83:"S",68:"D",70:"F",71:"G",72:"H",74:"J",75:"K",76:"L",186:"",222:"'",13:"Enter",16:"Shift",90:"Z",88:"X",67:"C",86:"V",66:"B",78:"N",77:"M",188:",",190:".",191:"/",17:"Control",18:"Alt",91:"Meta",32:" ",38:"ArrowUp",40:"ArrowDown",37:"ArrowLeft",39:"ArrowRight"};(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(i,"host","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/constant.js"),__REACT_HOT_LOADER__.register(s,"redirect_uri","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/constant.js"))})()},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments[1];switch(t.type){case"roomlistUpdate":var i=o.default.copyState(e);return i[t.room.id]=t.room,i;case"roomlistRemove":var i=o.default.copyState(e);return delete i[t.roomID],i;case"roomlistSet":return t.roomlist;default:return e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var n=i(274),o=s(n),a=new Object;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(a,"initialState","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/reducers/roomlist.js"),__REACT_HOT_LOADER__.register(r,"reducer","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/reducers/roomlist.js"))})()},function(e,t){"use strict";t.copyState=function(e){var t=new Object;for(var i in e)t[i]=e[i];return t};(function(){"undefined"==typeof __REACT_HOT_LOADER__})()},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.default.INIT_USER_STATE,t=arguments[1];switch(t.type){case"userSet":return t.user;case"userUpdate":var i=o.default.copyState(e);return i[t.key]=t.value,i;default:return e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var n=i(274),o=s(n),a=i(272),l=s(a);(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(r,"reducer","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/reducers/user.js")})()},function(e,t){"use strict";function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments[1];switch(t.type){case"msgSet":return t.msg;case"msgAdd":var i=e.concat();return i.push(t.msg),i;default:return e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var s=[];(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(s,"initialState","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/reducers/msg.js"),__REACT_HOT_LOADER__.register(i,"reducer","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/reducers/msg.js"))})()},function(e,t){"use strict";function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments[1];switch(t.type){case"nesSet":return t.nes;default:return e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var s=new Object;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(s,"initialState","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/reducers/nes.js"),__REACT_HOT_LOADER__.register(i,"reducer","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/reducers/nes.js"))})()},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments[1];switch(t.type){case"keyboardSet":return t.keyboard;case"keyboardSetOne":var i=o.default.copyState(e);return i[t.key]=t.value,i;default:return e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var n=i(274),o=s(n),a={};(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(a,"initialState","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/reducers/keyboard.js"),__REACT_HOT_LOADER__.register(r,"reducer","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/reducers/keyboard.js"))})()},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,t=arguments[1];switch(t.type){case"gamelistSet":return t.gamelist;default:return e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var n=i(274),o=(s(n),new Array);(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(o,"initialState","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/reducers/gamelist.js"),__REACT_HOT_LOADER__.register(r,"reducer","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/reducers/gamelist.js"))})()},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}var r=i(266),n=s(r);t.gameSet=function(e){return{type:"gameSet",game:e}},t.keyboardSet=function(e){return{type:"keyboardSet",keyboard:e}},t.gamelistSet=function(e){return{type:"gamelistSet",gamelist:e}},t.roomSet=function(e){return{type:"roomSet",room:e}},t.nesSet=function(e){return{type:"nesSet",nes:e}},t.userUpdate=function(e,t){return{type:"userUpdate",key:e,value:t}},t.msgSet=function(e){return{type:"msgSet",msg:e}},t.msgAdd=function(e){return{type:"msgAdd",msg:e}},t.roomlistSet=function(e){return{type:"roomlistSet",roomlist:e}},t.roomlistUpdate=function(e){return{type:"roomlistUpdate",room:e}},t.roomlistRemove=function(e){return{type:"roomlistRemove",roomID:e}},t.userSet=function(e){return{type:"userSet",user:e}},t.gameTabSet=function(e){return{type:"gameTabSet",gameTab:e}},t.roomTabSet=function(e){return{type:"roomTabSet",roomTab:e}},t.tabSet=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t||"Room"!=n.default.getState().tab?t||"Game"!=n.default.getState().tab?{type:"tabSet",tab:e}:{type:"inGame"}:(alert("你在房间中，请退出房间后再进行操作！"),{type:"inRoom"})};(function(){"undefined"==typeof __REACT_HOT_LOADER__})()},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}var r=i(282),n=s(r),o=i(283),a=s(o),l=i(266),u=s(l),h=i(280),c=s(h),d=i(272),p=s(d),f=null,m={};t.create=function(){return window.WebSocket?(f=new WebSocket(p.default.wsServer),f.onopen=function(){console.log("WebSocket已经打开..."),n.default.handler(m),a.default.handler(m)},f.onmessage=function(e){var t=JSON.parse(e.data);for(var i in m)t.type==i&&m[i](t)},f.onerror=function(e){console.error(e.message)},void(f.onclose=function(e){console.log(e.code,e.reason),alert("WebSocket已经断开"),u.default.dispatch(c.default.userSet(p.default.INIT_USER_STATE))})):void alert("该浏览器不支持websocket，建议使用最新版chrome")},t.addOnmessage=function(e,t){console.log("on "+e),m[e]=t},t.removeOnmessage=function(e){console.log("delete "+e),delete m[e]},t.close=function(){f.close()};var _=function(e){f.send(JSON.stringify(e))};t.send=function(e){null!=f?f.send(JSON.stringify(e)):setTimeout(function(){null!=f&&f.send(JSON.stringify(e))},2e3)},t.createRoom=function(e){_({type:"createRoom",game:e})},t.getRoom=function(e){_({type:"getRoom",roomID:e})},t.leaveRoom=function(){_({type:"leaveRoom"})},t.ready=function(){_({type:"ready"})},t.unready=function(){_({type:"unready"})},t.start=function(){_({type:"start"})};(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(f,"ws","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/websocket/index.js"),__REACT_HOT_LOADER__.register(m,"wsHandler","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/websocket/index.js"),__REACT_HOT_LOADER__.register(_,"send","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/websocket/index.js"))})()},function(e,t){"use strict";t.handler=function(e){};(function(){"undefined"==typeof __REACT_HOT_LOADER__})()},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}var r=i(266),n=(s(r),i(280));s(n);t.handler=function(e){};(function(){"undefined"==typeof __REACT_HOT_LOADER__})()},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),l=i(1),u=s(l),h=(i(204),i(166));i(285);var c=i(287),d=(s(c),i(264)),p=s(d),f=i(280),m=i(281),_=s(m),g=i(272),b=(s(g),function(e){function t(e){r(this,t);var i=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.state={login:{color:"",value:""}},i}return o(t,e),a(t,[{key:"login",value:function(){var e=this,t=this.refs.account.value,i=this.refs.password.value;p.default.login(t,i).then(function(t){return t.error?void e.setState({login:{color:"red",value:t.msg}}):(e.props.userSet(t.data),_.default.create(),e.setState({login:{color:"green",value:t.msg}}),e.props.tabSet(""),void location.reload(!0))})}},{key:"render",value:function(){var e=this;return u.default.createElement("div",{className:"MaskLayer"},u.default.createElement("div",{className:"Form"},u.default.createElement("span",{className:"Close",onClick:function(){return e.props.tabSet("")}},"X"),u.default.createElement("h1",null,"登录"),u.default.createElement("input",{type:"text",placeholder:"用户名/邮箱",ref:"account",autoComplete:"off",autoFocus:!0}),u.default.createElement("input",{type:"password",placeholder:"密码",ref:"password",autoComplete:"off",onKeyUp:function(t){13==t.keyCode&&e.login()}}),u.default.createElement("div",{className:"link"},u.default.createElement("a",{onClick:function(){return e.props.tabSet("Register")},className:"leftLink"},"没有帐号？"),u.default.createElement("a",{onClick:function(){return e.props.tabSet("ForgetPassword")},className:"rightLink"},"忘记密码？")),u.default.createElement("button",{type:"button",className:"enableButton",onClick:this.login.bind(this)},"登 录"),u.default.createElement("div",{className:"msg",style:{color:this.state.login.color}},this.state.login.value),u.default.createElement("p",null,"快捷登录"),u.default.createElement("a",{href:"https://github.com/login/oauth/authorize?client_id=2443d910b04cd68c5a66&scope="},u.default.createElement("img",{src:"/img/github.png"})),u.default.createElement("a",{href:"/api/qqLoginRedirect?redirect_uri="+document.location.href},u.default.createElement("img",{src:"/img/qq.png"}))))}}]),t}(u.default.Component)),R=(0,h.connect)(null,{userSet:f.userSet,tabSet:f.tabSet})(b);t.default=R;(function(){
"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(b,"Login","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Account/Login.jsx"),__REACT_HOT_LOADER__.register(R,"default","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Account/Login.jsx"))})()},function(e,t,i){var s=i(286);"string"==typeof s&&(s=[[e.id,s,""]]);i(260)(s,{});s.locals&&(e.exports=s.locals)},function(e,t,i){t=e.exports=i(259)(),t.push([e.id,".MaskLayer{position:fixed;left:0;top:0;width:100%;height:100%;background-color:#444;opacity:.9;-moz-opacity:.9;filter:alpha(opacity=90);z-index:100;font-family:arial}.Form{width:500px;margin:50px auto;background:#fff;padding:50px}.Form>.Close{position:relative;right:0;top:0}.Form>h1{text-align:center}.Form>input:-moz-placeholder,.Form>input::-moz-placeholder{color:#b9b9b9}.Form>input:-ms-input-placeholder{color:#b9b9b9}.Form>input::-webkit-input-placeholder{color:#b9b9b9}.Form>input{position:relative;margin:5px 0;width:100%;height:40px;padding:5px 7px 5px 15px;border:1px solid #ddd;font-size:14px;border-radius:6px;transition:all .2s}.Form>input:focus{border:1px solid #fff;outline:none;box-shadow:inset 0 2px 3px 0 rgba(0,0,0,.1),0 2px 7px 0 rgba(0,0,0,.2)}.Form>.errMsg{color:red;height:15px;margin-bottom:10px}.Form>.errMsg,.Form>.msg{font-size:15px;margin-left:5px}.Form>.msg{height:24px}.link{height:15px;margin:5px}.link>.leftLink,.link>.rightLink{text-decoration:none;color:#b9b9b9;font-size:15px;margin-bottom:15px}.link>.leftLink{float:left}.link>.rightLink{float:right}.link>.leftLink:hover,.link>.rightLink:hover{text-decoration:underline;color:#000}.Form>button{display:inline-block;margin-bottom:10px;width:100%;font-size:16px;height:40px;color:#fff;text-decoration:none;border:none;outline:none;border-radius:6px;-moz-border-radius:6px;-webkit-border-radius:6px}.Form>.disableButton{background:#b9b9b9}.Form>.enableButton{background:#1ad996}.Form>.enableButton:hover{background:#2ae9a6}.Form>.enableButton:active{background:#0ac986}.Form>p{text-align:center}",""])},function(e,t){"use strict";t.msgERR=function(e,t){document.getElementById(e).innerHTML="<span style='color:red'>"+t+"</span>"},t.msgOK=function(e,t){document.getElementById(e).innerHTML="<span style='color:green'>"+t+"</span>"},t.msgInfo=function(e,t){document.getElementById(e).innerHTML="<span style='color:white'>"+t+"</span>"};(function(){"undefined"==typeof __REACT_HOT_LOADER__})()},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),l=i(1),u=s(l),h=(i(204),i(166));i(285);var c=i(287),d=(s(c),i(264)),p=s(d),f=i(280),m=i(281),_=s(m),g=function(e){function t(e){r(this,t);var i=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.state={login:{color:"",value:""}},i}return o(t,e),a(t,[{key:"login",value:function(){var e=this,t=this.refs.name.value;p.default.visitorLogin(t).then(function(t){return t.error?void e.setState({login:{color:"red",value:t.msg}}):(e.props.userSet(t.data),_.default.create(),e.setState({login:{color:"green",value:t.msg}}),e.props.tabSet(""),void location.reload(!0))})}},{key:"render",value:function(){var e=this;return u.default.createElement("div",{className:"MaskLayer"},u.default.createElement("div",{className:"Form"},u.default.createElement("span",{className:"Close",onClick:function(){return e.props.tabSet("")}},"X"),u.default.createElement("h1",null,"请先登录"),u.default.createElement("input",{type:"text",placeholder:"为自己取个昵称吧",ref:"name",autoComplete:"off",autoFocus:!0,onKeyUp:function(t){13==t.keyCode&&e.login()}}),u.default.createElement("div",{className:"link"},u.default.createElement("a",{onClick:function(){return e.props.tabSet("Register")},className:"leftLink"},"注册账号"),u.default.createElement("a",{onClick:function(){return e.props.tabSet("Login")},className:"rightLink"},"已有账号,登录")),u.default.createElement("button",{type:"button",className:"enableButton",onClick:this.login.bind(this)},"游客登录"),u.default.createElement("div",{className:"msg",style:{color:this.state.login.color}},this.state.login.value)))}}]),t}(u.default.Component),b=(0,h.connect)(null,{userSet:f.userSet,tabSet:f.tabSet})(g);t.default=b;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(g,"VisitorLogin","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Account/VisitorLogin.jsx"),__REACT_HOT_LOADER__.register(b,"default","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Account/VisitorLogin.jsx"))})()},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),l=i(1),u=s(l),h=(i(204),i(166));i(285);var c=i(287),d=(s(c),i(264)),p=s(d),f=i(280),m=function(e){function t(e){r(this,t);var i=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.state={checkMail:{color:"",value:""},checkName:{color:"",value:""},checkPassword:{color:"",value:""},buttonEnable:!1,register:{color:"",value:""}},i}return o(t,e),a(t,[{key:"updateCheck",value:function(e,t){this.buttonEnable()?this.setState({key:{color:"green",value:e},buttonEnable:!0}):this.setState({key:{color:"green",value:e},buttonEnable:!1})}},{key:"checkMail",value:function(){var e=this,t=this.refs.mail.value;if(""==t)return void this.setState({checkMail:{color:"red",value:"请填写你的邮箱地址"},buttonEnable:!1});var i=/^(\w-*\.*)+@(\w-?)+(\.\w{2,})+$/;return i.test(t)?void p.default.checkMail(t).then(function(t){t.error?e.setState({checkMail:{color:"red",value:t.msg},buttonEnable:!1}):"green"==e.state.checkName.color&&"green"==e.state.checkPassword.color?e.setState({checkMail:{color:"green",value:t.msg},buttonEnable:!0}):e.setState({checkMail:{color:"green",value:t.msg},buttonEnable:!1})}):void this.setState({checkMail:{color:"red",value:"请填写有效的邮箱地址"},buttonEnable:!1})}},{key:"checkName",value:function(){var e=this,t=this.refs.name.value;""==t?this.setState({checkName:{color:"red",value:"请填写你的昵称"},buttonEnable:!1}):t.indexOf("@")>0?this.setState({checkName:{color:"red",value:"用户名中不允许包含@"},buttonEnable:!1}):p.default.checkName(t).then(function(t){t.error?e.setState({checkName:{color:"red",value:t.msg},buttonEnable:!1}):"green"==e.state.checkMail.color&&"green"==e.state.checkPassword.color?e.setState({checkName:{color:"green",value:t.msg},buttonEnable:!0}):e.setState({checkName:{color:"green",value:t.msg},buttonEnable:!1})})}},{key:"checkPassword",value:function(){var e=this.refs.password.value,t=this.refs.rePassword.value;""==e?this.setState({checkPassword:{color:"red",value:"请输入密码"},buttonEnable:!1}):e!=t?this.setState({checkPassword:{color:"red",value:"两次输入的密码不一致"},buttonEnable:!1}):"green"==this.state.checkMail.color&&"green"==this.state.checkName.color?this.setState({checkPassword:{color:"green",value:""},buttonEnable:!0}):this.setState({checkPassword:{color:"green",value:""},buttonEnable:!1})}},{key:"register",value:function(){var e=this;if("green"==this.state.checkMail.color&&"green"==this.state.checkName.color&&"green"==this.state.checkPassword.color){var t=this.refs.mail.value,i=this.refs.name.value,s=this.refs.password.value;p.default.register(t,i,s).then(function(t){return t.error?void e.setState({register:{color:"red",value:t.msg}}):void e.setState({register:{color:"green",value:t.msg}})})}else this.setState({buttonEnable:!1})}},{key:"render",value:function(){var e=this;return u.default.createElement("div",{className:"MaskLayer"},u.default.createElement("div",{className:"Form"},u.default.createElement("span",{className:"Close",onClick:function(){return e.props.tabSet("")}},"X"),u.default.createElement("h1",null,"注册"),u.default.createElement("input",{type:"email",placeholder:"邮箱",ref:"mail",onBlur:this.checkMail.bind(this),autoFocus:!0}),u.default.createElement("div",{ref:"checkMail",className:"msg",style:{color:this.state.checkMail.color}},this.state.checkMail.value),u.default.createElement("input",{type:"text",placeholder:"用户名",ref:"name",onBlur:this.checkName.bind(this)}),u.default.createElement("div",{ref:"checkName",className:"msg",style:{color:this.state.checkName.color}},this.state.checkName.value),u.default.createElement("input",{type:"password",placeholder:"密码",ref:"password",onBlur:this.checkPassword.bind(this)}),u.default.createElement("input",{type:"password",placeholder:"再次输入密码",ref:"rePassword",onBlur:this.checkPassword.bind(this)}),u.default.createElement("div",{ref:"checkPassword",className:"msg",style:{color:this.state.checkPassword.color}},this.state.checkPassword.value),u.default.createElement("div",{className:"link"},u.default.createElement("a",{onClick:function(){return e.props.tabSet("Login")},className:"rightLink"},"已有帐号？登录")),u.default.createElement("button",{type:"button",className:this.state.buttonEnable?"enableButton":"disableButton",onClick:this.register.bind(this)},"发送注册邮件"),u.default.createElement("div",{ref:"register",className:"msg",style:{color:this.state.register.color}},this.state.register.value)))}}]),t}(u.default.Component),_=(0,h.connect)(null,{tabSet:f.tabSet})(m);t.default=_;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(m,"Register","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Account/Register.jsx"),__REACT_HOT_LOADER__.register(_,"default","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Account/Register.jsx"))})()},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),l=i(1),u=s(l),h=(i(204),i(166));i(285);var c=i(287),d=(s(c),i(264)),p=s(d),f=i(280),m=function(e){function t(e){r(this,t);var i=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.state={forgetPassword:{color:"",value:""}},i}return o(t,e),a(t,[{key:"forgetPassword",value:function(){var e=this,t=this.refs.mail.value;p.default.forgetPassword(t).then(function(t){return t.error?void e.setState({forgetPassword:{color:"red",value:t.msg}}):void e.setState({forgetPassword:{color:"green",value:t.msg}})})}},{key:"render",value:function(){var e=this;return u.default.createElement("div",{className:"MaskLayer"},u.default.createElement("div",{className:"Form"},u.default.createElement("span",{className:"Close",onClick:function(){return e.props.tabSet("")}},"X"),u.default.createElement("h1",null,"忘记密码"),u.default.createElement("input",{ref:"mail",type:"text",placeholder:"邮箱",autoFocus:!0}),u.default.createElement("div",{className:"link"},u.default.createElement("a",{onClick:function(){return e.props.tabSet("Login")},className:"leftLink"},"想起密码了？登录吧")),u.default.createElement("button",{type:"button",className:"enableButton",onClick:this.forgetPassword.bind(this)},"发送验证邮件"),u.default.createElement("div",{className:"msg",style:{color:this.state.forgetPassword.color}},this.state.forgetPassword.value)))}}]),t}(u.default.Component),_=(0,h.connect)(null,{tabSet:f.tabSet})(m);t.default=_;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(m,"ForgetPassword","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Account/ForgetPassword.jsx"),__REACT_HOT_LOADER__.register(_,"default","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Account/ForgetPassword.jsx"))})()},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),l=i(1),u=s(l);i(166);i(292);var h=i(294),c=(s(h),i(264)),d=(s(c),i(281)),p=s(d),f=(i(280),function(e){function t(e){return r(this,t),n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return o(t,e),a(t,[{key:"componentWillMount",value:function(){p.default.addOnmessage("createRoom",function(e){location.href="#/room/"+e.room.id})}},{key:"componentWillUnmount",value:function(){p.default.removeOnmessage("createRoom")}},{key:"createRoom",value:function(){p.default.createRoom(this.props.params.gameName)}},{key:"render",value:function(){var e=this,t=this.props.params.gameName;return u.default.createElement("div",null,u.default.createElement("div",{className:"LocationBar"},u.default.createElement("a",{href:"#/gameList"},"游戏大厅"),u.default.createElement("span",null," >> "),u.default.createElement("a",{className:"CurrentLocation",href:"#/game/"+t},t),u.default.createElement("span",null," | "),u.default.createElement("a",{href:"#/roomList/"},"房间列表")),u.default.createElement("div",{className:"GameInfo"},u.default.createElement("div",{className:"window"},u.default.createElement("img",{src:"/roms/"+t+".jpg"}),u.default.createElement("div",null,"游戏名称：",t),u.default.createElement("div",null,"游戏大小：100k"),u.default.createElement("div",null,"Mapper类型：1")),u.default.createElement("div",{className:"gameButtonBox"},u.default.createElement("button",{onClick:function(){return e.createRoom()}},"创建游戏"),u.default.createElement("button",{onClick:function(){location.href="#/gameList"}},"返回"))))}}]),t}(u.default.Component)),m=f;t.default=m;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(f,"GameInfo","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/GameInfo/GameInfo.jsx"),__REACT_HOT_LOADER__.register(m,"default","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/GameInfo/GameInfo.jsx"))})()},function(e,t,i){var s=i(293);"string"==typeof s&&(s=[[e.id,s,""]]);i(260)(s,{});s.locals&&(e.exports=s.locals)},function(e,t,i){t=e.exports=i(259)(),t.push([e.id,".GameInfo{position:relative;width:100%;text-align:center;border:1px solid #eaecef}.GameInfo>.window{border-bottom:1px solid #eaecef;padding:10px}.GameInfo>.window>img{margin:10px auto;width:256px;height:256px}.GameInfo>.gameButtonBox{text-align:center}.GameInfo>.gameButtonBox>button{background:#205ec5;color:#efefef;height:35px;width:75px;margin:10px;border:1px;border-radius:2px;outline:none}.GameInfo>.gameButtonBox>button:hover{color:#fff;background:#004693;cursor:pointer}",""])},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}var r=i(265),n=s(r);t.createRoom=function(e){return new Promise(function(t){var i="/api/createRoom?game="+e;n.default.Get(i).then(function(e){t(JSON.parse(e))}).catch(function(e){console.error(e)})})};(function(){"undefined"==typeof __REACT_HOT_LOADER__})()},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),l=i(1),u=s(l);i(166);i(296);var h=i(298),c=s(h),d=i(299),p=(s(d),i(280),function(e){function t(e){r(this,t);var i=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.state={gameList:[]},i}return o(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this;c.default.getGameList().then(function(t){t.error||e.setState({gameList:t.data})})}},{key:"chooseGame",value:function(e){return location.href="#/game/"+e,!1}},{key:"render",value:function(){var e=this;return u.default.createElement("div",null,u.default.createElement("div",{className:"LocationBar"},u.default.createElement("a",{className:"CurrentLocation",href:"#/gameList"},"游戏大厅"),u.default.createElement("span",null," | "),u.default.createElement("a",{href:"#/roomList/"},"房间列表")),u.default.createElement("div",{className:"GameList"},this.state.gameList.map(function(t){return u.default.createElement("div",{className:"GameListBlock",id:"Block",key:t.name,onClick:e.chooseGame.bind(e,t.name)},u.default.createElement("img",{src:"/roms/"+t.name+".jpg"}),u.default.createElement("div",{className:"BlockGameName"},t.name),u.default.createElement("div",{className:"BlockMask"}))})))}}]),t}(u.default.Component)),f=p;t.default=f;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(p,"GameList","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/GameList/GameList.jsx"),__REACT_HOT_LOADER__.register(f,"default","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/GameList/GameList.jsx"))})()},function(e,t,i){var s=i(297);"string"==typeof s&&(s=[[e.id,s,""]]);i(260)(s,{});s.locals&&(e.exports=s.locals)},function(e,t,i){t=e.exports=i(259)(),t.push([e.id,".GameList{position:relative;width:100%;min-height:300px;overflow:scroll;border:1px solid #eaecef}.GameList>.GameListBlock{position:relative;float:left;width:128px;height:128px;text-align:center;margin:9px;overflow:hidden}.GameList>.GameListBlock:hover{cursor:pointer}.GameList>.GameListBlock:hover>img{opacity:.7}.GameList>.GameListBlock>img{position:absolute;left:0;top:0;width:100%;height:100;z-index:0}.GameList>.GameListBlock>.BlockGameName{position:absolute;left:5px;bottom:0;z-index:2;border:0;padding:0;margin:0;text-align:center;font-size:13px;color:#fff}.GameList>.GameListBlock>.BlockMask{position:absolute;bottom:0;height:36px;width:100%;z-index:1;background:-webkit-gradient(linear,0 0,0 bottom,from(transparent),to(#000));background:-o-linear-gradient(top,transparent,#000)}",""])},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}var r=i(265),n=s(r);t.getGameList=function(){return new Promise(function(e){var t="/api/getGameList";n.default.Get(t).then(function(t){e(JSON.parse(t))}).catch(function(e){console.error(e)})})},t.getRom=function(e){return new Promise(function(t){var i="/roms/"+e+".nes";n.default.GetBinary(i).then(function(e){t(e)}).catch(function(e){console.error(e)})})};(function(){"undefined"==typeof __REACT_HOT_LOADER__})()},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),l=i(1),u=s(l);i(300);var h=function(e){function t(e){r(this,t);var i=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.wheelData=0,i.state={scrollDynamicStyle:{height:"0"}},i.resizeHandler=function(){i.updateScroll()},i}return o(t,e),a(t,[{key:"bind",value:function(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent?e.attachEvent("on"+t,i):e["on"+t]=i}},{key:"mouseWheel",value:function(e,t){function i(e){var t=e||window.event;return t.wheelDelta?t.wheelDelta:40*t.detail}this.bind(e,"mousewheel",function(e){var s=-i(e);t(s),document.all?window.event.returnValue=!1:e.preventDefault()}),this.bind(e,"DOMMouseScroll",function(e){var s=i(e);t(s),e.preventDefault()})}},{key:"componentWillReceiveProps",value:function(e){"undefined"!=typeof e.scrollUpdate&&this.updateScroll()}},{key:"updateScroll",value:function(){var e=document.getElementById(this.props.contentID).offsetHeight,t=document.getElementById(this.props.mainBoxID).offsetHeight,i=parseInt(t*(t/e)),s=i>=t?t+"px":i+"px";this.setState({scrollDynamicStyle:{height:s}})}},{key:"tragScroll",value:function(e,t,i){var s=this,r=e.clientHeight;i.onmousedown=function(n){var o=i.offsetTop,a=n||window.event,l=a.clientY;document.onmousemove=function(n){var a=n||window.event,u=a.clientY;u=o+u-l,u>r-i.offsetHeight&&(u=r-i.offsetHeight),u<=0&&(u=0),i.style.top=u+"px",t.style.top=-u*(t.offsetHeight/e.offsetHeight)+"px",s.wheelData=u},document.onmouseup=function(e){document.onmousemove=null}}}},{key:"wheelChange",value:function(e,t,i){var s=this,r=0,n=0;this.mouseWheel(e,function(o){n+=o,s.wheelData>=0?(r=s.wheelData,i.style.top=r+"px",n=12*s.wheelData,s.wheelData=-1):r=n/12,r<=0&&(r=0,n=0),r>=e.offsetHeight-i.offsetHeight&&(r=e.clientHeight-i.offsetHeight,n=12*(e.clientHeight-i.offsetHeight)),i.style.top=r+"px",t.style.top=-r*(t.offsetHeight/e.offsetHeight)+"px"})}},{key:"componentDidMount",value:function(){var e=document.getElementById(this.props.mainBoxID),t=document.getElementById(this.props.contentID),i=document.getElementById(this.props.mainBoxID+"-scroll");this.updateScroll(),this.tragScroll(e,t,i),this.wheelChange(e,t,i),window.addEventListener("resize",this.resizeHandler)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resizeHandler)}},{key:"render",value:function(){return u.default.createElement("div",{className:this.props.scrollBackgroundStyle},u.default.createElement("div",{className:this.props.scrollStyle,id:this.props.mainBoxID+"-scroll",style:this.state.scrollDynamicStyle}))}}],[{key:"defaultProps",get:function(){return{scrollBackgroundStyle:"defaultScrollBackground",scrollStyle:"defaultScroll"}}}]),t}(u.default.Component),c=h;t.default=c;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(h,"Scroll","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/components/Scroll.jsx"),__REACT_HOT_LOADER__.register(c,"default","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/components/Scroll.jsx"))})()},function(e,t,i){var s=i(301);"string"==typeof s&&(s=[[e.id,s,""]]);i(260)(s,{});s.locals&&(e.exports=s.locals)},function(e,t,i){t=e.exports=i(259)(),t.push([e.id,".defaultScroll{width:10px;position:absolute;top:0;bottom:0;background:#666;border-radius:10px}.defaultScroll:hover{background:#444}.defaultScrollBackground{position:absolute;top:0;width:10px;height:100%;right:0;background:#ccc}",""])},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){return{roomList:e.roomList}}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),u=i(1),h=s(u),c=i(166);i(303);var d=i(281),p=s(d),f=i(272),m=s(f),_=i(299),g=(s(_),i(280),function(e){function t(e){r(this,t);var i=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.state={roomList:{}},i.interval=null,i}return o(t,e),l(t,[{key:"componentDidMount",value:function(){var e=this;p.default.addOnmessage("roomList",function(t){return e.setState({roomList:t.roomList})}),p.default.send({type:"getRoomList"})}},{key:"componentWillUnmount",value:function(){p.default.removeOnmessage("roomList")}},{key:"enter",value:function(e){location.href="#/room/"+this.state.roomList[e].id}},{key:"render",value:function(){var e=this,t=[];for(var i in this.state.roomList){var s=this.state.roomList[i];t.push(h.default.createElement("tbody",{key:i,onClick:function(){return e.enter(i)}},h.default.createElement("tr",{className:1&i?"even":"odd"},h.default.createElement("td",null,s.id),h.default.createElement("td",null,s.players[s.host_id].name),h.default.createElement("td",null,s.game),h.default.createElement("td",null,s.player_count+"/"+s.players.length),h.default.createElement("td",null,m.default.ROOM_STATE_TEXT[s.state]))))}return h.default.createElement("div",null,h.default.createElement("div",{className:"LocationBar"},h.default.createElement("a",{href:"#/gameList"},"游戏大厅")," | ",h.default.createElement("a",{className:"CurrentLocation",href:"#/roomList/"},"房间列表")),h.default.createElement("div",{className:"RoomList",id:"RoomList"},h.default.createElement("table",null,h.default.createElement("thead",null,h.default.createElement("tr",null,h.default.createElement("td",{width:"15%"},"房间号"),h.default.createElement("td",{width:"20%"},"房主"),h.default.createElement("td",{width:"30%"},"游戏名称"),h.default.createElement("td",{width:"10%"},"人数"),h.default.createElement("td",{width:"15%"},"状态"))),t)))}}]),t}(h.default.Component)),b=(0,c.connect)(a,null)(g);t.default=b;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(g,"RoomList","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/RoomList/RoomList.jsx"),__REACT_HOT_LOADER__.register(a,"mapStateToProps","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/RoomList/RoomList.jsx"),__REACT_HOT_LOADER__.register(b,"default","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/RoomList/RoomList.jsx"))})()},function(e,t,i){var s=i(304);"string"==typeof s&&(s=[[e.id,s,""]]);i(260)(s,{});s.locals&&(e.exports=s.locals)},function(e,t,i){t=e.exports=i(259)(),t.push([e.id,".RoomList{position:relative;width:100%;min-height:300px;overflow:scroll;border:1px solid #eaecef;text-align:center}.RoomList>table{width:100%;border-spacing:0}.RoomList>table>thead>tr{height:32px;color:#adb6cd;background:#15385f}.RoomList>table>tbody>tr>td{padding:5px 16px}.RoomList>table>tbody>tr>td>img{height:20px;width:20px;float:left;border:1px solid #a0a0a0;margin-right:12px}.RoomList>table>tbody>tr>td>span{float:left;font-size:16px;padding:3px}.RoomList>table>tbody>.odd{height:32px;color:#adb6cd;background:#02050e}.RoomList>table>tbody>.even{height:32px;color:#adb6cd;background:#1f2126}",""])},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),l=i(1),u=s(l);i(204);i(285);var h=i(264),c=s(h),d=function(e){function t(e){r(this,t);var i=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.state={active:{color:"black",value:"正在激活账户..."}},i}return o(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this;c.default.active(this.props.params.active_code).then(function(t){return t.error?void e.setState({active:{color:"red",value:t.msg}}):void e.setState({active:{color:"green",value:t.msg}})})}},{key:"render",value:function(){return u.default.createElement("div",null,u.default.createElement("div",{className:"LocationBar"},u.default.createElement("a",{href:"#/gameList"},"游戏大厅"),u.default.createElement("span",null," | "),u.default.createElement("a",{href:"#/roomList/"},"房间列表")),u.default.createElement("span",{style:{color:this.state.active.color}},this.state.active.value))}}]),t}(u.default.Component),p=d;t.default=p;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(d,"Active","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Account/Active.jsx"),
__REACT_HOT_LOADER__.register(p,"default","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Account/Active.jsx"))})()},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),l=i(1),u=s(l);i(204);i(285);var h=i(287),c=(s(h),i(264)),d=s(c),p=function(e){function t(e){r(this,t);var i=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.state={checkPassword:{color:"",value:""},resetPassword:{color:"",value:""},buttonEnable:!1},i}return o(t,e),a(t,[{key:"resetPassword",value:function(){var e=this,t=this.refs.mail.value,i=this.props.params.verifyCode,s=this.refs.password.value;d.default.resetPassword(t,i,s).then(function(t){return t.error?void e.setState({resetPassword:{color:"red",value:t.msg}}):void e.setState({resetPassword:{color:"green",value:t.msg}})})}},{key:"checkPassword",value:function(){var e=this.refs.password.value,t=this.refs.rePassword.value;""==e?this.setState({checkPassword:{color:"red",value:"请输入密码"},buttonEnable:!1}):e!=t?this.setState({checkPassword:{color:"red",value:"两次输入的密码不一致"},buttonEnable:!1}):this.setState({checkPassword:{color:"green",value:""},buttonEnable:!0})}},{key:"render",value:function(){return u.default.createElement("div",{className:"Form"},u.default.createElement("h1",null,"重置密码"),u.default.createElement("input",{type:"text",placeholder:"邮箱",ref:"mail"}),u.default.createElement("input",{type:"password",placeholder:"密码",ref:"password",onBlur:this.checkPassword.bind(this)}),u.default.createElement("input",{type:"password",placeholder:"再次输入密码",ref:"rePassword",onBlur:this.checkPassword.bind(this)}),u.default.createElement("div",{ref:"checkPassword",className:"msg",style:{color:this.state.checkPassword.color}},this.state.checkPassword.value),u.default.createElement("button",{type:"button",className:this.state.buttonEnable?"enableButton":"disableButton",onClick:this.resetPassword.bind(this)},"重置密码"),u.default.createElement("div",{ref:"checkRegister",className:"msg",style:{color:this.state.resetPassword.color}},this.state.resetPassword.value))}}]),t}(u.default.Component),f=p;t.default=f;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(p,"ResetPassword","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Account/ResetPassword.jsx"),__REACT_HOT_LOADER__.register(f,"default","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Account/ResetPassword.jsx"))})()},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){return{keyboard:e.keyboard,user:e.user}}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),u=i(1),h=s(u),c=i(204),d=i(166);i(308);var p=i(310),f=(s(p),i(299)),m=(s(f),i(280)),_=i(312),g=(s(_),i(264)),b=s(g),R=function(e){function t(e){r(this,t);var i=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.state={checkName:{color:"",value:""},checkPassword:{color:"",value:""},buttonEnable:!1},i}return o(t,e),l(t,[{key:"changeName",value:function(){var e=this,t=this.refs.name.value;return t==this.props.user.name?void this.setState({checkName:{color:"red",value:"昵称未修改"}}):""==t?void this.setState({checkName:{color:"red",value:"昵称不能为空"}}):t.indexOf("@")>0?void this.setState({checkName:{color:"red",value:"昵称中不允许包含@"}}):void b.default.changeName(t).then(function(t){return t.error?void e.setState({checkName:{color:"red",value:t.msg}}):(e.props.userSet(t.data),void e.setState({checkName:{color:"green",value:t.msg}}))})}},{key:"checkPassword",value:function(){var e=this.refs.password.value,t=this.refs.rePassword.value;""==e?this.setState({checkPassword:{color:"red",value:"请输入密码"},buttonEnable:!1}):e!=t?this.setState({checkPassword:{color:"red",value:"两次输入的密码不一致"},buttonEnable:!1}):this.setState({checkPassword:{color:"green",value:""},buttonEnable:!0})}},{key:"changePassword",value:function(){var e=this;if(this.state.buttonEnable){var t=this.refs.oldPassword.value,i=this.refs.password.value;b.default.changePassword(t,i).then(function(t){return t.error?void e.setState({checkPassword:{color:"red",value:t.msg}}):void e.setState({checkPassword:{color:"green",value:t.msg}})})}}},{key:"render",value:function(){return h.default.createElement("div",null,h.default.createElement("div",{className:"LocationBar"},h.default.createElement("a",{className:"CurrentLocation",href:"#/settings/account"},"账户设置"),h.default.createElement("span",null," | "),h.default.createElement("a",{href:"#/settings/game"},"游戏设置"),h.default.createElement("span",null," | "),h.default.createElement("a",{href:"#/settings/local"},"本地设置")),h.default.createElement("div",{className:"Setting"},h.default.createElement("div",{className:"Item"},h.default.createElement("input",{type:"text",ref:"name",placeholder:this.props.user.name}),h.default.createElement("div",{className:"msg",style:{color:this.state.checkName.color}},this.state.checkName.value),h.default.createElement("button",{type:"button",className:"enableButton",onClick:this.changeName.bind(this)},"修改昵称")),this.props.user.mail?h.default.createElement("div",{className:"Item"},h.default.createElement("input",{type:"password",ref:"oldPassword",placeholder:"旧密码"}),h.default.createElement(c.Link,{to:"/forgetPassword"},"忘记密码？"),h.default.createElement("input",{type:"password",ref:"password",placeholder:"新密码",onBlur:this.checkPassword.bind(this)}),h.default.createElement("input",{type:"password",ref:"rePassword",placeholder:"确认新密码",onBlur:this.checkPassword.bind(this)}),h.default.createElement("div",{className:"msg",style:{color:this.state.checkPassword.color}},this.state.checkPassword.value),h.default.createElement("button",{type:"button",className:this.state.buttonEnable?"enableButton":"disableButton",onClick:this.changePassword.bind(this)},"修改密码")):h.default.createElement("div",{className:"Item"})))}}]),t}(h.default.Component),E=(0,d.connect)(a,{userSet:m.userSet})(R);t.default=E;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(R,"Account","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Setting/Account.jsx"),__REACT_HOT_LOADER__.register(a,"mapStateToProps","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Setting/Account.jsx"),__REACT_HOT_LOADER__.register(E,"default","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Setting/Account.jsx"))})()},function(e,t,i){var s=i(309);"string"==typeof s&&(s=[[e.id,s,""]]);i(260)(s,{});s.locals&&(e.exports=s.locals)},function(e,t,i){t=e.exports=i(259)(),t.push([e.id,".Setting{padding:0 20px}.Setting>.Item{padding:10px 0}.Setting>.Item>input:-moz-placeholder,.Setting>.Item>input::-moz-placeholder{color:#b9b9b9}.Setting>.Item>input:-ms-input-placeholder{color:#b9b9b9}.Setting>.Item>input::-webkit-input-placeholder{color:#b9b9b9}.Setting>.Item>input{display:block;margin:5px 0;width:300px;height:30px;padding:5px 7px 5px 15px;border:1px solid #ddd;font-size:14px;border-radius:6px;transition:all .2s}.Setting>.Item>input:focus{border:1px solid #fff;outline:none;box-shadow:inset 0 2px 3px 0 rgba(0,0,0,.1),0 2px 7px 0 rgba(0,0,0,.2)}.Setting>.Item>.msg{font-size:15px;height:24px;margin-left:5px}.Setting>.Item>button{display:inline-block;margin-bottom:10px;width:130px;font-size:16px;height:30px;color:#fff;text-decoration:none;border:none;outline:none;border-radius:6px;-moz-border-radius:6px;-webkit-border-radius:6px}.Setting>.Item>.disableButton{background:#b9b9b9}.Setting>.Item>.enableButton{background:#1ad996}.Setting>.Item>.enableButton:hover{background:#2ae9a6}.Setting>.Item>.enableButton:active{background:#0ac986}",""])},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}var r=i(311),n=s(r),o=i(266),a=s(o),l=i(280),u=s(l);window.ws=null,window.wsHandler={},window.wsHandler.settingUpdate=function(e){a.default.dispatch(u.default.keyboardSet(null==e.keyboard?new Object:e.keyboard)),a.default.dispatch(u.default.userSet(e.name))},window.wsHandler.info=function(e){a.default.dispatch(u.default.roomlistSet(null==e.roomlist?new Object:e.roomlist)),a.default.dispatch(u.default.gamelistSet(null==e.gamelist?new Array:e.gamelist)),a.default.dispatch(u.default.keyboardSet(null==e.keyboard?new Object:e.keyboard))},window.wsHandler.createRoom=function(e){a.default.dispatch(u.default.roomlistUpdate(e.roomlist)),e.from==a.default.getState().user.name&&(a.default.dispatch(u.default.roomSet(e.room)),a.default.dispatch(u.default.userUpdate("idInRoom",e.idInRoom)),a.default.dispatch(u.default.tabSet("Room")))},window.wsHandler.leaveRoom=function(e){"empty"==e.roomlist?a.default.dispatch(u.default.roomlistRemove(e.roomID)):a.default.dispatch(u.default.roomlistUpdate(e.roomlist)),e.from==a.default.getState().user.name?(a.default.dispatch(u.default.tabSet("RoomList",!0)),a.default.dispatch(u.default.roomSet(null))):null!=e.room&&null!=a.default.getState().room&&e.room.id==a.default.getState().room.id&&a.default.dispatch(u.default.roomSet(e.room))},window.wsHandler.enterRoom=function(e){a.default.dispatch(u.default.roomlistUpdate(e.roomlist)),null==a.default.getState().room?e.from==a.default.getState().user.name&&(a.default.dispatch(u.default.roomSet(e.room)),a.default.dispatch(u.default.userUpdate("idInRoom",e.idInRoom)),a.default.dispatch(u.default.tabSet("Room"))):e.room.id==a.default.getState().room.id&&a.default.dispatch(u.default.roomSet(e.room))},window.wsHandler.updateRoom=function(e){a.default.dispatch(u.default.roomlistUpdate(e.roomlist)),null!=e.room&&null!=a.default.getState().room&&e.room.id==a.default.getState().room.id&&a.default.dispatch(u.default.roomSet(e.room))},window.wsHandler.start=function(e){if(null!=e.room&&null!=a.default.getState().room&&e.room.id==a.default.getState().room.id){a.default.dispatch(u.default.tabSet("Game",!0)),"undefined"!=typeof e.keyboard[0]&&(window.nes.keyboard.player[0]=e.keyboard[0]),"undefined"!=typeof e.keyboard[1]&&(window.nes.keyboard.player[1]=e.keyboard[1]);var t=window.store.getState().room.players;window.keyboardAction=new Array(t.length);for(var i=6,s=0;s<t.length;s++)if(null!=t[s]){window.keyboardAction[s]=new Array(i);for(var r=0;r<i;r++)window.keyboardAction[s][r]=[]}var n=window.store.getState().user.idInRoom;window.keyboardAction[n].push([]),console.log(window.keyboardAction)}},window.wsHandler.relogin=function(e){alert("你的账号在异地登录，如果不是你本人操作，请及时修改密码"),location.reload(!0)},window.wsHandler.keyboard=function(e){keyboardActionSet(e)},t.createWS=function(e){window.WebSocket&&(ws=new WebSocket(n.default.wsServer),ws.onopen=function(){console.log("WebSocket已经打开...")},ws.onmessage=function(e){var t=JSON.parse(e.data);"keyboard"!=t.type&&console.log(t);for(var i in wsHandler)t.type==i&&window.wsHandler[i](t)},ws.onerror=function(e){console.log(e.message)},ws.onclose=function(e){console.log(e.code,e.reason),alert("WebSocket已经断开")})},t.on=function(e,t){console.log("on "+e),wsHandler[e]=t},t.send=function(e){ws.send(JSON.stringify(e))},t.sendRoomMsg=function(e){ws.send(JSON.stringify({type:"roomMsg",msg:e}))};(function(){"undefined"==typeof __REACT_HOT_LOADER__})()},function(e,t){"use strict";var i=document.location.port,s=document.location.hostname;""!=i&&(s=s+":"+i),e.exports={wsServer:"ws://"+s+"/ws",qqRedirectURL:"http://"+s+"/loginQQ"};(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(i,"port","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/utils/config.js"),__REACT_HOT_LOADER__.register(s,"host","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/utils/config.js"))})()},function(e,t){"use strict";t.msgERR=function(e,t){document.getElementById(e).innerHTML="<span style='color:red'>"+t+"</span>"},t.msgOK=function(e,t){document.getElementById(e).innerHTML="<span style='color:green'>"+t+"</span>"},t.msgInfo=function(e,t){document.getElementById(e).innerHTML="<span style='color:white'>"+t+"</span>"};(function(){"undefined"==typeof __REACT_HOT_LOADER__})()},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){return{user:e.user}}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),u=i(1),h=s(u),c=i(166),d=i(264),p=(s(d),i(298)),f=s(p),m=i(314),_=s(m),g=i(281),b=s(g),R=i(272),E=s(R),y=i(315),S=s(y),v=i(318),T=s(v),O=i(328),A=s(O),C=function(e){function t(e){r(this,t);var i=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.state={room:{id:i.props.params.roomID,state:E.default.ROOM_STATE_NORMAL},id_in_room:-1,loadingState:E.default.LOADINGROOM,keyboard:E.default.DEFAULT_KEYBOARD},i.nes=null,i}return o(t,e),l(t,[{key:"updateKeyboard",value:function(e){var t=this;_.default.update(e).then(function(e){return e.error?void alert(e.msg):void t.setState({keyboard:e.data})})}},{key:"componentWillMount",value:function(){var e=this;this.nes=new A.default.NES({}),b.default.addOnmessage("id_in_room",function(t){e.setState({id_in_room:t.id_in_room})}),_.default.get().then(function(t){return t.error?void alert(t.msg):void e.setState({keyboard:t.data})}),b.default.addOnmessage("roomErrMsg",function(e){alert(e.roomErrMsg),location.href="#/roomList/"}),b.default.addOnmessage("roomStateChange",function(t){e.setState({room:t.room}),e.state.loadingState==E.default.LOADINGROOM&&(e.setState({loadingState:E.default.LOADINGMAP}),f.default.getRom(t.room.game).then(function(t){e.setState({loadingState:E.default.LOADED}),e.nes.loadROM(t)}))}),b.default.send({type:"enterRoom",roomID:this.props.params.roomID})}},{key:"componentWillUnmount",value:function(){b.default.removeOnmessage("id_in_room"),b.default.removeOnmessage("roomErrMsg"),b.default.removeOnmessage("roomStateChange")}},{key:"render",value:function(){return h.default.createElement("div",null,h.default.createElement("div",{className:"LocationBar"},h.default.createElement("a",{href:"#/gameList"},"游戏大厅")," | ",h.default.createElement("a",{href:"#/roomList/"},"房间列表")),null==this.state.room?h.default.createElement("div",null):this.state.room.state==E.default.ROOM_STATE_IN_GAME&&this.state.room.players[this.state.id_in_room].state_in_room==E.default.ROOM_PLAYER_STATE_IN_GAME?h.default.createElement(T.default,{room:this.state.room,id_in_room:this.state.id_in_room,keyboard:this.state.keyboard,updateKeyboard:this.updateKeyboard.bind(this),nes:this.nes}):h.default.createElement(S.default,{room:this.state.room,id_in_room:this.state.id_in_room,loadingState:this.state.loadingState}))}}]),t}(h.default.Component),w=(0,c.connect)(a,null)(C);t.default=w;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(C,"Room","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/Room.jsx"),__REACT_HOT_LOADER__.register(a,"mapStateToProps","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/Room.jsx"),__REACT_HOT_LOADER__.register(w,"default","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/Room.jsx"))})()},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}var r=i(265),n=s(r),o=i(266);s(o);t.get=function(e){return new Promise(function(e){var t="/api/getKeyboard";n.default.Get(t).then(function(t){e(JSON.parse(t))}).catch(function(e){console.error(e)})})},t.update=function(e,t){return new Promise(function(t){var i="/api/updateKeyboard",s="keyboard="+JSON.stringify(e);n.default.Post(i,s).then(function(e){t(JSON.parse(e))}).catch(function(e){console.error(e)})})};(function(){"undefined"==typeof __REACT_HOT_LOADER__})()},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){return{user:e.user}}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),u=i(1),h=s(u),c=i(166);i(316);var d=i(264),p=(s(d),i(298)),f=(s(p),i(281)),m=s(f),_=i(272),g=s(_),b=function(e){function t(e){r(this,t);var i=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.state={msg:[]},i}return o(t,e),l(t,[{key:"componentWillMount",value:function(){var e=this;m.default.addOnmessage("roomMsg",function(t){var i={from:t.from,msg:t.msg};e.state.msg.push(i),e.setState({msg:e.state.msg})})}},{key:"componentWillUnmount",value:function(){m.default.removeOnmessage("roomMsg")}},{key:"send",value:function(){var e=this.refs.send.value;""!=e?(m.default.send({type:"roomMsg",msg:e}),this.refs.send.value=""):alert("发送消息不能为空")}},{key:"leaveRoom",value:function(){m.default.send({type:"leaveRoom"}),history.go(-1)}},{key:"ready",value:function(){m.default.send({type:"ready"})}},{key:"unready",value:function(){m.default.send({type:"unready"})}},{key:"start",value:function(){m.default.send({type:"start"})}},{key:"render",value:function(){var e=this,t=[],i=this.props.loadingState==g.default.LOADINGROOM?"正在加载房间信息":"正在下载地图...";if(this.props.loadingState==g.default.LOADED){for(var s=!1,r=0;r<this.props.room.players.length;r++)if(null!=this.props.room.players[r]){var n=this.props.room.players[r].name,o=this.props.room.players[r].avatar,a=this.props.room.players[r].state_in_room,l=this.props.room.host_id;a==g.default.ROOM_PLAYER_STATE_UNREADY&&l!=r&&(s=!0),t.push(h.default.createElement("tbody",{key:r},h.default.createElement("tr",{className:1&r?"even":"odd"},h.default.createElement("td",null,h.default.createElement("img",{src:o}),h.default.createElement("span",null,n)),h.default.createElement("td",null,r==l?h.default.createElement("div",{style:{color:"red"}},"房主"):h.default.createElement("div",{style:{color:"green"}},g.default.ROOM_PLAYER_STATE_TEXT[a])))))}else t.push(h.default.createElement("tbody",{key:r},h.default.createElement("tr",{className:1&r?"even":"odd"},h.default.createElement("td",null,h.default.createElement("img",{src:g.default.ROOM_AVATAR_TOPN}),h.default.createElement("span",null)),h.default.createElement("td",null))));var u=this.props.id_in_room;if(this.props.room.state==g.default.ROOM_STATE_IN_GAME)i="游戏中";else if(u==this.props.room.host_id)i=s?"等待准备":"开始";else switch(this.props.room.players[u].state_in_room){case g.default.ROOM_PLAYER_STATE_UNREADY:i="准备";break;case g.default.ROOM_PLAYER_STATE_READY:i="取消准备";break;case g.default.ROOM_PLAYER_STATE_READY:i="游戏中";break;default:i="未知错误"}}return h.default.createElement("div",{className:"Room-Normal"},h.default.createElement("div",{className:"game-info"},h.default.createElement("div",{className:"id"},"房间号：",this.props.room.id),h.default.createElement("img",{src:"undefined"==typeof this.props.room.game?"/roms/loading.gif":"/roms/"+this.props.room.game+".jpg"}),h.default.createElement("br",null),h.default.createElement("span",null,"游戏 "),h.default.createElement("input",{type:"text",className:"name",value:this.props.room.game,disabled:!0}),h.default.createElement("br",null),h.default.createElement("button",null,"保存设置")),h.default.createElement("div",{className:"users"},h.default.createElement("table",null,h.default.createElement("thead",null,h.default.createElement("tr",null,h.default.createElement("td",{width:"60%"},"玩家"),h.default.createElement("td",{width:"40%"},"状态"))),t)),h.default.createElement("div",{className:"controls"},h.default.createElement("button",{onClick:function(){return e.leaveRoom()}},"退出"),"开始"==i?h.default.createElement("button",{style:{background:"red"},onClick:this.start.bind(this)},i):"等待准备"==i?h.default.createElement("button",{style:{background:"gray"},disabled:!0},i):"取消准备"==i?h.default.createElement("button",{style:{background:"orange"},onClick:this.unready.bind(this)},i):"准备"==i?h.default.createElement("button",{style:{background:"blue"},onClick:this.ready.bind(this)},i):h.default.createElement("button",{style:{background:"gray"},disabled:!0},i)),h.default.createElement("div",{id:"chatHistory",className:"chatHistory"},this.state.msg.map(function(e,t){return h.default.createElement("div",{className:"list",key:t},h.default.createElement("span",{style:{color:e.from==g.default.MSG_FROM_SYSTEM?"red":"green"}},"[",e.from,"]: "),h.default.createElement("span",{style:{color:"white"}},e.msg))})),h.default.createElement("div",{className:"chat"},h.default.createElement("input",{type:"text",ref:"send",onKeyUp:function(t){13==t.keyCode&&e.send()},autoFocus:!0}),h.default.createElement("button",{onClick:this.send.bind(this)},"发送")))}}]),t}(h.default.Component),R=(0,c.connect)(a,null)(b);t.default=R;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(b,"Room","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/Normal/Room.jsx"),__REACT_HOT_LOADER__.register(a,"mapStateToProps","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/Normal/Room.jsx"),__REACT_HOT_LOADER__.register(R,"default","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/Normal/Room.jsx"))})()},function(e,t,i){var s=i(317);"string"==typeof s&&(s=[[e.id,s,""]]);i(260)(s,{});s.locals&&(e.exports=s.locals)},function(e,t,i){t=e.exports=i(259)(),t.push([e.id,".Room-Normal{position:fixed;top:0;left:0;width:100%;height:100%;border:1px solid #eaecef;text-align:center}.Room-Normal>.game-info{position:absolute;top:0;left:0;height:300px;width:200px;background:#515765;text-align:center}.Room-Normal>.game-info>.id{margin-top:8px;margin-bottom:4px;color:#fff;font-size:17px}.Room-Normal>.game-info>span{color:#bfbfbf;font-size:16px}.Room-Normal>.game-info>input[type=text],.Room-Normal>.game-info>input[type=text]:disabled{width:130px;outline:none;color:#dfdfdf;font-size:16px;margin-top:8px}.Room-Normal>.game-info>input[type=text]{border:1px solid #999;background:#000}.Room-Normal>.game-info>input[type=text]:disabled{border:1px solid #515765;background:#515765}.Room-Normal>.game-info>img{width:128px;height:120px;margin:0 36px}.Room-Normal>.game-info>button{width:112px;height:25px;border-radius:4px;margin:8px 36px;outline:none;background:#a0a0a0;color:#efefef;border:1px solid #515765;font-size:16px}.Room-Normal>.users{position:absolute;background:#303940;top:0;height:300px;left:200px;right:0;text-align:center}.Room-Normal>.users>table{width:100%;border-spacing:0}.Room-Normal>.users>table>thead>tr{height:32px;color:#adb6cd;background:#15385f}.Room-Normal>.users>table>tbody>tr>td{padding:5px 16px}.Room-Normal>.users>table>tbody>tr>td>img{height:35px;width:35px;float:left;border:1px solid #a0a0a0;margin-right:12px}.Room-Normal>.users>table>tbody>tr>td>span{float:left;font-size:16px;padding:3px}.Room-Normal>.users>table>tbody>.odd{height:32px;color:#adb6cd;background:#02050e}.Room-Normal>.users>table>tbody>.even{height:32px;color:#adb6cd;background:#1f2126}.Room-Normal>.controls{position:absolute;background:#3d3f3e;top:300px;height:32px;width:100%}.Room-Normal>.controls>button{float:right;width:100px;height:24px;outline:0;margin:4px;color:#dfdfdf;background:#2d6a88;border:1px solid #274252;border-radius:4px}.Room-Normal>.chatHistory{background:#161b1f;position:absolute;top:332px;bottom:32px;left:0;right:0;overflow:scroll}.Room-Normal>.chatHistory>.list{padding:0;border:0;text-align:left}.Room-Normal>.chat{position:absolute;background:#161b1f;height:32px;bottom:0;left:0;right:0}.Room-Normal>.chat>input{width:80%;height:24px;outline:0;margin:4px 10px 4px 4px;background:#161b1f;border:1px solid #a0a0a0;border-radius:4px;color:#dfdfdf;padding:2px 2px 2px 10px;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}.Room-Normal>.chat>button{width:15%;height:24px;outline:0;margin:4px;color:#dfdfdf;background:#2d6a88;border:1px solid #274252;border-radius:4px}",""])},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){return{user:e.user}}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),u=i(1),h=s(u),c=i(166);i(319);var d=i(281),p=s(d),f=i(272),m=s(f),_=i(298),g=(s(_),i(280)),b=i(321),R=s(b),E=i(342),y=s(E),S=i(345),v=s(S),T=i(348),O=s(T),A=i(351),C=s(A),w=i(354),N=s(w),k=function(e){function t(e){r(this,t);var i=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.Menu="Menu",i.Players="Players",i.KeyboardSetting="KeyboardSetting",i.state={tab:"",isRunning:!0,emulateSound:i.props.nes.opts.emulateSound,playMode:m.default.PLAY_MODE_ONLINE,msg:[]},i}return o(t,e),l(t,[{key:"addMsg",value:function(e,t){var i=this,t={from:e,msg:t};this.state.msg.push(t),setTimeout(function(){i.state.msg.shift(),i.setState({msg:i.state.msg})},15e3),this.setState({msg:this.state.msg})}},{key:"componentWillMount",value:function(){}},{key:"componentDidMount",value:function(){var e=this;p.default.addOnmessage("roomMsg",function(t){return e.addMsg(t.from,t.msg)}),this.updatePlayMode(),this.restart()}},{key:"updatePlayMode",value:function(){if(this.state.playMode!=m.default.PLAY_MODE_LOCAL){if(this.props.room.player_count>1){for(var e=0,t=0;t<this.props.room.players.length;t++){var i=this.props.room.players[t];null!=i&&i.state_in_room==m.default.ROOM_PLAYER_STATE_IN_GAME&&e++}if(e>1)return}this.setState({playMode:m.default.PLAY_MODE_LOCAL})}}},{key:"componentDidUpdate",value:function(e,t){this.updatePlayMode()}},{key:"componentWillUnmount",value:function(){p.default.removeOnmessage("roomMsg")}},{key:"closeTab",value:function(){this.refs.window.focus(),this.setState({tab:""})}},{key:"updateIsRunning",value:function(e){this.setState({isRunning:e})}},{key:"updateEmulateSound",value:function(e){this.props.nes.emulateSound=e,this.setState({emulateSound:e})}},{key:"restart",value:function(){this.updateIsRunning(!0),this.props.nes.reloadROM()}},{key:"render",value:function(){var e=this;return h.default.createElement("div",{className:"Room-InGame"},this.state.tab==this.Players?h.default.createElement(O.default,{closeTab:this.closeTab.bind(this),room:this.props.room}):this.state.tab==this.Menu?h.default.createElement(C.default,{closeTab:this.closeTab.bind(this),room:this.props.room,isRunning:this.state.isRunning,updateIsRunning:this.updateIsRunning.bind(this),restart:this.restart.bind(this),emulateSound:this.state.emulateSound,updateEmulateSound:this.updateEmulateSound.bind(this),nes:this.props.nes}):this.state.tab==this.KeyboardSetting?h.default.createElement(N.default,{closeTab:this.closeTab.bind(this),updateKeyboard:this.props.updateKeyboard,keyboard:this.props.keyboard}):h.default.createElement("div",null),h.default.createElement("div",{className:"buttons"},h.default.createElement("button",{disabled:!0},"任务"),h.default.createElement("button",{onClick:function(){e.setState({tab:e.Menu})}},"菜单"),h.default.createElement(y.default,null),h.default.createElement("button",{onClick:function(){e.setState({tab:e.Players})}},"玩家"),h.default.createElement("button",{onClick:function(){e.setState({tab:e.KeyboardSetting})}},"按键设置")),h.default.createElement("div",{className:"window",ref:"window",id:"window",tabIndex:"0"},h.default.createElement(R.default,{room:this.props.room,id_in_room:this.props.id_in_room,emulateSound:this.state.emulateSound,keyboard:this.props.keyboard,isRunning:this.state.isRunning,playMode:this.state.playMode,nes:this.props.nes,addMsg:this.addMsg.bind(this)}),h.default.createElement(v.default,{msg:this.state.msg})))}}]),t}(h.default.Component),D=(0,c.connect)(a,{roomSet:g.roomSet,gameTabSet:g.gameTabSet,msgSet:g.msgSet,msgAdd:g.msgAdd,keyboardGet:g.keyboardGet})(k);t.default=D;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(k,"Room","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/InGame/Room.jsx"),__REACT_HOT_LOADER__.register(a,"mapStateToProps","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/InGame/Room.jsx"),__REACT_HOT_LOADER__.register(D,"default","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/InGame/Room.jsx"))})()},function(e,t,i){var s=i(320);"string"==typeof s&&(s=[[e.id,s,""]]);i(260)(s,{});s.locals&&(e.exports=s.locals)},function(e,t,i){t=e.exports=i(259)(),t.push([e.id,".Room-InGame{position:fixed;top:0;left:0;height:100%;width:100%;background:#000;z-index:100}.Room-InGame>.buttons{position:absolute;top:0;left:0;height:30px;right:0;text-align:left;z-index:100;background:#7a7f7b}.Room-InGame>.buttons>button{background:#001f41;border:1px solid #a4821a;color:#fff;border-radius:7px;width:20%;height:28px;margin:1px 0;font-size:16px;line-height:22px;outline:0}.Room-InGame>.buttons>button:disabled{background:#1e2021;border:1px solid #796520;color:#5a6060}.Room-InGame>.window{position:absolute;top:30px;left:0;bottom:0;right:0;z-index:1}.Room-InGame-Tab{position:fixed;left:0;top:0;width:100%;height:100%;background-color:#444;opacity:.9;-moz-opacity:.9;filter:alpha(opacity=90);z-index:100;font-family:arial}.Room-InGame-Tab>.window{width:auto;position:absolute;left:20%;right:20%;top:10%;bottom:10%;padding:33px 30px;color:gold;background:#111;border:2px solid #b09528;border-radius:3px;opacity:.8}.Room-InGame-Tab>.window>.exitButtons{position:absolute;bottom:31px;left:10%;right:10%}.Room-InGame-Tab>.window>.exitButtons>button{background:#000;border:1px solid #a4821a;color:gold;border-radius:3px;width:40%;margin:0 5%;height:28px;font-size:16px;line-height:22px;outline:0}",""]);
},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),l=i(1),u=s(l);i(166);i(322);var h=i(281),c=(s(h),i(272)),d=s(c),p=i(298),f=(s(p),i(280),i(324)),m=s(f),_=i(325),g=s(_),b=i(326),R=s(b),E=i(338),y=s(E),S=function(e){function t(e){return r(this,t),n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return o(t,e),a(t,[{key:"componentWillMount",value:function(){}},{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(e,t){}},{key:"componentWillUnmount",value:function(){}},{key:"setOnFrame",value:function(e){this.props.nes.opts.onFrame=e}},{key:"setOnAudioSample",value:function(e){this.props.nes.opts.onAudioSample=e}},{key:"render",value:function(){return u.default.createElement("div",{ref:"emulator",className:"Emulator"},u.default.createElement(m.default,{setOnFrame:this.setOnFrame.bind(this)}),u.default.createElement(g.default,{emulateSound:this.props.emulateSound,setOnAudioSample:this.setOnAudioSample.bind(this)}),this.props.playMode==d.default.PLAY_MODE_LOCAL?u.default.createElement(R.default,{keyboard:this.props.keyboard,isRunning:this.props.isRunning,nes:this.props.nes,addMsg:this.props.addMsg}):this.props.playMode==d.default.PLAY_MODE_ONLINE?u.default.createElement(y.default,{id_in_room:this.props.id_in_room,room:this.props.room,keyboard:this.props.keyboard,isRunning:this.props.isRunning,nes:this.props.nes,addMsg:this.props.addMsg}):u.default.createElement("div",null))}}]),t}(u.default.Component),v=S;t.default=v;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(S,"Emulator","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/InGame/Emulator.jsx"),__REACT_HOT_LOADER__.register(v,"default","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/InGame/Emulator.jsx"))})()},function(e,t,i){var s=i(323);"string"==typeof s&&(s=[[e.id,s,""]]);i(260)(s,{});s.locals&&(e.exports=s.locals)},function(e,t,i){t=e.exports=i(259)(),t.push([e.id,".Emulator{position:absolute;top:0;left:0;bottom:0;right:0;text-align:center;z-index:0}#frameID{position:fixed;left:50%;color:red}",""])},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),l=i(1),u=s(l),h=(i(166),function(e){function t(e){return r(this,t),n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return o(t,e),a(t,[{key:"resize",value:function(){var e=document.getElementById("window").clientHeight,t=document.getElementById("window").clientWidth,i=!(e/240*256>t);i?(this.refs.screen.style.height=e+"px",this.refs.screen.style.width=e/240*256+"px"):(this.refs.screen.style.height=t/256*240+"px",this.refs.screen.style.width=t+"px")}},{key:"componentDidMount",value:function(){var e=this.refs.screen.getContext("2d"),t=e.getImageData(0,0,256,240),i=new ArrayBuffer(t.data.length),s=new Uint8ClampedArray(i),r=new Uint32Array(i);e.fillStyle="black",e.fillRect(0,0,256,240);for(var n=0;n<r.length;++n)r[n]=4278190080;var o=0;this.props.setOnFrame(function(i){for(var n=0,a=0;a<240;++a)for(var l=0;l<256;++l)n=256*a+l,r[n]=4278190080|i[n];t.data.set(s),e.putImageData(t,0,0),o++,document.getElementById("frameID").innerHTML=o}),this.resize(),window.addEventListener("resize",this.resize.bind(this))}},{key:"componentWillUnmount",value:function(){this.props.setOnFrame(function(){}),window.removeEventListener("resize",this.resize.bind(this))}},{key:"render",value:function(){return u.default.createElement("div",null,u.default.createElement("span",{id:"frameID"}),u.default.createElement("canvas",{ref:"screen",class:"Screen",width:"256",height:"240"}))}}]),t}(u.default.Component)),c=h;t.default=c;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(h,"Screen","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/InGame/Common/Screen.jsx"),__REACT_HOT_LOADER__.register(c,"default","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/InGame/Common/Screen.jsx"))})()},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),l=i(1),u=s(l),h=(i(166),function(e){function t(e){return r(this,t),n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return o(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=new(window.AudioContext||window.webkitAudioContext),i=2,s=44100,r=8192,n=t.createBuffer(i,r,s),o=0;this.props.setOnAudioSample(function(i,s){if(e.props.emulateSound){if(o==r){var a=t.createBufferSource();a.buffer=n,a.connect(t.destination),a.start(),o=0}n.getChannelData(0)[o]=i,n.getChannelData(1)[o]=s,o++}})}},{key:"componentWillUnmount",value:function(){this.props.setOnAudioSample(function(){})}},{key:"render",value:function(){return u.default.createElement("div",null)}}]),t}(u.default.Component)),c=h;t.default=c;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(h,"Audio","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/InGame/Common/Audio.jsx"),__REACT_HOT_LOADER__.register(c,"default","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/InGame/Common/Audio.jsx"))})()},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),l=i(1),u=s(l),h=(i(166),i(272)),c=s(h),d=i(281),p=(s(d),i(327)),f=s(p),m=function(e){function t(e){r(this,t);var i=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.frameInterval=null,i}return o(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this;this.props.addMsg(c.default.MSG_FROM_SYSTEM,"自动调整为单机模式"),this.frameInterval=setInterval(function(){e.props.isRunning&&e.props.nes.frame()},1e3/60)}},{key:"componentWillUnmount",value:function(){clearInterval(this.frameInterval)}},{key:"render",value:function(){return u.default.createElement(f.default,{keyboard:this.props.keyboard,nes:this.props.nes})}}]),t}(u.default.Component),_=m;t.default=_;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(m,"Emulator","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/InGame/Local/Emulator.jsx"),__REACT_HOT_LOADER__.register(_,"default","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/InGame/Local/Emulator.jsx"))})()},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),l=i(1),u=s(l),h=(i(166),i(328)),c=s(h),d=function(e){function t(e){return r(this,t),n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return o(t,e),a(t,[{key:"keyupListener",value:function(e){var t=this.props.nes,i=this.props.keyboard;switch(e.keyCode){case i.A:t.buttonUp(1,c.default.Controller.BUTTON_A);break;case i.B:t.buttonUp(1,c.default.Controller.BUTTON_B);break;case i.select:t.buttonUp(1,c.default.Controller.BUTTON_SELECT);break;case i.start:t.buttonUp(1,c.default.Controller.BUTTON_START);break;case i.up:t.buttonUp(1,c.default.Controller.BUTTON_UP);break;case i.down:t.buttonUp(1,c.default.Controller.BUTTON_DOWN);break;case i.left:t.buttonUp(1,c.default.Controller.BUTTON_LEFT);break;case i.right:t.buttonUp(1,c.default.Controller.BUTTON_RIGHT)}}},{key:"keydownListener",value:function(e){var t=this.props.nes,i=this.props.keyboard;switch(e.keyCode){case i.A:t.buttonDown(1,c.default.Controller.BUTTON_A);break;case i.B:t.buttonDown(1,c.default.Controller.BUTTON_B);break;case i.select:t.buttonDown(1,c.default.Controller.BUTTON_SELECT);break;case i.start:t.buttonDown(1,c.default.Controller.BUTTON_START);break;case i.up:t.buttonDown(1,c.default.Controller.BUTTON_UP);break;case i.down:t.buttonDown(1,c.default.Controller.BUTTON_DOWN);break;case i.left:t.buttonDown(1,c.default.Controller.BUTTON_LEFT);break;case i.right:t.buttonDown(1,c.default.Controller.BUTTON_RIGHT)}}},{key:"componentDidMount",value:function(){document.getElementById("window").addEventListener("keyup",this.keyupListener.bind(this)),document.getElementById("window").addEventListener("keydown",this.keydownListener.bind(this))}},{key:"componentWillUnmount",value:function(){document.getElementById("window").removeEventListener("keyup",this.keyupListener),document.getElementById("window").removeEventListener("keydown",this.keydownListener)}},{key:"render",value:function(){return u.default.createElement("div",null)}}]),t}(u.default.Component),p=d;t.default=p;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(d,"Controller","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/InGame/Local/Controller.jsx"),__REACT_HOT_LOADER__.register(p,"default","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/InGame/Local/Controller.jsx"))})()},function(e,t,i){"use strict";e.exports={Controller:i(329),NES:i(330)};(function(){"undefined"==typeof __REACT_HOT_LOADER__})()},function(e,t){"use strict";var i=function(){this.state=new Array(8);for(var e=0;e<this.state.length;e++)this.state[e]=64};i.BUTTON_A=0,i.BUTTON_B=1,i.BUTTON_SELECT=2,i.BUTTON_START=3,i.BUTTON_UP=4,i.BUTTON_DOWN=5,i.BUTTON_LEFT=6,i.BUTTON_RIGHT=7,i.prototype={buttonDown:function(e){this.state[e]=65},buttonUp:function(e){this.state[e]=64}},e.exports=i;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(i,"Controller","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/jsnes/controller.js")})()},function(e,t,i){"use strict";var s=i(331),r=i(329),n=i(333),o=i(335),a=i(336),l=function(e){if(this.opts={onFrame:function(){},onAudioSample:null,onStatusUpdate:function(){},preferredFrameRate:60,emulateSound:!0,sampleRate:44100},"undefined"!=typeof e){var t;for(t in this.opts)"undefined"!=typeof e[t]&&(this.opts[t]=e[t])}this.frameTime=1e3/this.opts.preferredFrameRate,this.frameIntervalFunction=null,this.frameInterval=null,this.cpu=new s(this),this.ppu=new n(this),this.papu=new o(this),this.mmap=null,this.controllers={1:new r,2:new r},this.opts.onStatusUpdate("Ready to load a ROM."),this.frame=this.frame.bind(this),this.buttonDown=this.buttonDown.bind(this),this.buttonUp=this.buttonUp.bind(this),this.zapperMove=this.zapperMove.bind(this),this.zapperFireDown=this.zapperFireDown.bind(this),this.zapperFireUp=this.zapperFireUp.bind(this)};l.prototype={fpsFrameCount:0,romData:null,reset:function(){null!==this.mmap&&this.mmap.reset(),this.cpu.reset(),this.ppu.reset(),this.papu.reset(),this.lastFpsTime=null,this.fpsFrameCount=0},frame:function(){this.ppu.startFrame();var e=0,t=this.opts.emulateSound,i=this.cpu,s=this.ppu,r=this.papu;e:for(;;)for(0===i.cyclesToHalt?(e=i.emulate(),t&&r.clockFrameCounter(e),e*=3):i.cyclesToHalt>8?(e=24,t&&r.clockFrameCounter(8),i.cyclesToHalt-=8):(e=3*i.cyclesToHalt,t&&r.clockFrameCounter(i.cyclesToHalt),i.cyclesToHalt=0);e>0;e--){if(s.curX===s.spr0HitX&&1===s.f_spVisibility&&s.scanline-21===s.spr0HitY&&s.setStatusFlag(s.STATUS_SPRITE0HIT,!0),s.requestEndFrame&&(s.nmiCounter--,0===s.nmiCounter)){s.requestEndFrame=!1,s.startVBlank();break e}s.curX++,341===s.curX&&(s.curX=0,s.endScanline())}this.fpsFrameCount++},buttonDown:function(e,t){this.controllers[e].buttonDown(t)},buttonUp:function(e,t){this.controllers[e].buttonUp(t)},zapperMove:function(e,t){this.mmap&&(this.mmap.zapperX=e,this.mmap.zapperY=t)},zapperFireDown:function(){this.mmap&&(this.mmap.zapperFired=!0)},zapperFireUp:function(){this.mmap&&(this.mmap.zapperFired=!1)},getFPS:function(){var e=+new Date,t=null;return this.lastFpsTime&&(t=this.fpsFrameCount/((e-this.lastFpsTime)/1e3)),this.fpsFrameCount=0,this.lastFpsTime=e,t},reloadROM:function(){null!==this.romData&&this.loadROM(this.romData)},loadROM:function(e){this.rom=new a(this),this.rom.load(e),this.reset(),this.mmap=this.rom.createMapper(),this.mmap.loadROM(),this.ppu.setMirroring(this.rom.getMirroringType()),this.romData=e},setFramerate:function(e){this.opts.preferredFrameRate=e,this.frameTime=1e3/e,this.papu.setSampleRate(this.opts.sampleRate,!1)},toJSON:function(){return{romData:this.romData,cpu:this.cpu.toJSON(),mmap:this.mmap.toJSON(),ppu:this.ppu.toJSON()}},fromJSON:function(e){this.loadROM(e.romData),this.cpu.fromJSON(e.cpu),this.mmap.fromJSON(e.mmap),this.ppu.fromJSON(e.ppu)}},e.exports=l;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(l,"NES","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/jsnes/nes.js")})()},function(e,t,i){"use strict";var s=i(332),r=function(e){this.nes=e,this.mem=null,this.REG_ACC=null,this.REG_X=null,this.REG_Y=null,this.REG_SP=null,this.REG_PC=null,this.REG_PC_NEW=null,this.REG_STATUS=null,this.F_CARRY=null,this.F_DECIMAL=null,this.F_INTERRUPT=null,this.F_INTERRUPT_NEW=null,this.F_OVERFLOW=null,this.F_SIGN=null,this.F_ZERO=null,this.F_NOTUSED=null,this.F_NOTUSED_NEW=null,this.F_BRK=null,this.F_BRK_NEW=null,this.opdata=null,this.cyclesToHalt=null,this.crash=null,this.irqRequested=null,this.irqType=null,this.reset()};r.prototype={IRQ_NORMAL:0,IRQ_NMI:1,IRQ_RESET:2,reset:function(){this.mem=new Array(65536);for(var e=0;e<8192;e++)this.mem[e]=255;for(var t=0;t<4;t++){var i=2048*t;this.mem[i+8]=247,this.mem[i+9]=239,this.mem[i+10]=223,this.mem[i+15]=191}for(var s=8193;s<this.mem.length;s++)this.mem[s]=0;this.REG_ACC=0,this.REG_X=0,this.REG_Y=0,this.REG_SP=511,this.REG_PC=32767,this.REG_PC_NEW=32767,this.REG_STATUS=40,this.setStatus(40),this.F_CARRY=0,this.F_DECIMAL=0,this.F_INTERRUPT=1,this.F_INTERRUPT_NEW=1,this.F_OVERFLOW=0,this.F_SIGN=0,this.F_ZERO=1,this.F_NOTUSED=1,this.F_NOTUSED_NEW=1,this.F_BRK=1,this.F_BRK_NEW=1,this.opdata=(new n).opdata,this.cyclesToHalt=0,this.crash=!1,this.irqRequested=!1,this.irqType=null},emulate:function(){var e,t;if(this.irqRequested){switch(e=this.F_CARRY|(0===this.F_ZERO?1:0)<<1|this.F_INTERRUPT<<2|this.F_DECIMAL<<3|this.F_BRK<<4|this.F_NOTUSED<<5|this.F_OVERFLOW<<6|this.F_SIGN<<7,this.REG_PC_NEW=this.REG_PC,this.F_INTERRUPT_NEW=this.F_INTERRUPT,this.irqType){case 0:if(0!==this.F_INTERRUPT)break;this.doIrq(e);break;case 1:this.doNonMaskableInterrupt(e);break;case 2:this.doResetInterrupt()}this.REG_PC=this.REG_PC_NEW,this.F_INTERRUPT=this.F_INTERRUPT_NEW,this.F_BRK=this.F_BRK_NEW,this.irqRequested=!1}var i=this.opdata[this.nes.mmap.load(this.REG_PC+1)],s=i>>24,r=0,n=i>>8&255,o=this.REG_PC;this.REG_PC+=i>>16&255;var a=0;switch(n){case 0:a=this.load(o+2);break;case 1:a=this.load(o+2),a+=a<128?this.REG_PC:this.REG_PC-256;break;case 2:break;case 3:a=this.load16bit(o+2);break;case 4:a=this.REG_ACC;break;case 5:a=this.REG_PC;break;case 6:a=this.load(o+2)+this.REG_X&255;break;case 7:a=this.load(o+2)+this.REG_Y&255;break;case 8:a=this.load16bit(o+2),(65280&a)!==(a+this.REG_X&65280)&&(r=1),a+=this.REG_X;break;case 9:a=this.load16bit(o+2),(65280&a)!==(a+this.REG_Y&65280)&&(r=1),a+=this.REG_Y;break;case 10:a=this.load(o+2),(65280&a)!==(a+this.REG_X&65280)&&(r=1),a+=this.REG_X,a&=255,a=this.load16bit(a);break;case 11:a=this.load16bit(this.load(o+2)),(65280&a)!==(a+this.REG_Y&65280)&&(r=1),a+=this.REG_Y;break;case 12:a=this.load16bit(o+2),a=a<8191?this.mem[a]+(this.mem[65280&a|(255&a)+1&255]<<8):this.nes.mmap.load(a)+(this.nes.mmap.load(65280&a|(255&a)+1&255)<<8)}switch(a&=65535,255&i){case 0:e=this.REG_ACC+this.load(a)+this.F_CARRY,0===(128&(this.REG_ACC^this.load(a)))&&0!==(128&(this.REG_ACC^e))?this.F_OVERFLOW=1:this.F_OVERFLOW=0,this.F_CARRY=e>255?1:0,this.F_SIGN=e>>7&1,this.F_ZERO=255&e,this.REG_ACC=255&e,s+=r;break;case 1:this.REG_ACC=this.REG_ACC&this.load(a),this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC,11!==n&&(s+=r);break;case 2:4===n?(this.F_CARRY=this.REG_ACC>>7&1,this.REG_ACC=this.REG_ACC<<1&255,this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC):(e=this.load(a),this.F_CARRY=e>>7&1,e=e<<1&255,this.F_SIGN=e>>7&1,this.F_ZERO=e,this.write(a,e));break;case 3:0===this.F_CARRY&&(s+=(65280&o)!==(65280&a)?2:1,this.REG_PC=a);break;case 4:1===this.F_CARRY&&(s+=(65280&o)!==(65280&a)?2:1,this.REG_PC=a);break;case 5:0===this.F_ZERO&&(s+=(65280&o)!==(65280&a)?2:1,this.REG_PC=a);break;case 6:e=this.load(a),this.F_SIGN=e>>7&1,this.F_OVERFLOW=e>>6&1,e&=this.REG_ACC,this.F_ZERO=e;break;case 7:1===this.F_SIGN&&(s++,this.REG_PC=a);break;case 8:0!==this.F_ZERO&&(s+=(65280&o)!==(65280&a)?2:1,this.REG_PC=a);break;case 9:0===this.F_SIGN&&(s+=(65280&o)!==(65280&a)?2:1,this.REG_PC=a);break;case 10:this.REG_PC+=2,this.push(this.REG_PC>>8&255),this.push(255&this.REG_PC),this.F_BRK=1,this.push(this.F_CARRY|(0===this.F_ZERO?1:0)<<1|this.F_INTERRUPT<<2|this.F_DECIMAL<<3|this.F_BRK<<4|this.F_NOTUSED<<5|this.F_OVERFLOW<<6|this.F_SIGN<<7),this.F_INTERRUPT=1,this.REG_PC=this.load16bit(65534),this.REG_PC--;break;case 11:0===this.F_OVERFLOW&&(s+=(65280&o)!==(65280&a)?2:1,this.REG_PC=a);break;case 12:1===this.F_OVERFLOW&&(s+=(65280&o)!==(65280&a)?2:1,this.REG_PC=a);break;case 13:this.F_CARRY=0;break;case 14:this.F_DECIMAL=0;break;case 15:this.F_INTERRUPT=0;break;case 16:this.F_OVERFLOW=0;break;case 17:e=this.REG_ACC-this.load(a),this.F_CARRY=e>=0?1:0,this.F_SIGN=e>>7&1,this.F_ZERO=255&e,s+=r;break;case 18:e=this.REG_X-this.load(a),this.F_CARRY=e>=0?1:0,this.F_SIGN=e>>7&1,this.F_ZERO=255&e;break;case 19:e=this.REG_Y-this.load(a),this.F_CARRY=e>=0?1:0,this.F_SIGN=e>>7&1,this.F_ZERO=255&e;break;case 20:e=this.load(a)-1&255,this.F_SIGN=e>>7&1,this.F_ZERO=e,this.write(a,e);break;case 21:this.REG_X=this.REG_X-1&255,this.F_SIGN=this.REG_X>>7&1,this.F_ZERO=this.REG_X;break;case 22:this.REG_Y=this.REG_Y-1&255,this.F_SIGN=this.REG_Y>>7&1,this.F_ZERO=this.REG_Y;break;case 23:this.REG_ACC=255&(this.load(a)^this.REG_ACC),this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC,s+=r;break;case 24:e=this.load(a)+1&255,this.F_SIGN=e>>7&1,this.F_ZERO=e,this.write(a,255&e);break;case 25:this.REG_X=this.REG_X+1&255,this.F_SIGN=this.REG_X>>7&1,this.F_ZERO=this.REG_X;break;case 26:this.REG_Y++,this.REG_Y&=255,this.F_SIGN=this.REG_Y>>7&1,this.F_ZERO=this.REG_Y;break;case 27:this.REG_PC=a-1;break;case 28:this.push(this.REG_PC>>8&255),this.push(255&this.REG_PC),this.REG_PC=a-1;break;case 29:this.REG_ACC=this.load(a),this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC,s+=r;break;case 30:this.REG_X=this.load(a),this.F_SIGN=this.REG_X>>7&1,this.F_ZERO=this.REG_X,s+=r;break;case 31:this.REG_Y=this.load(a),this.F_SIGN=this.REG_Y>>7&1,this.F_ZERO=this.REG_Y,s+=r;break;case 32:4===n?(e=255&this.REG_ACC,this.F_CARRY=1&e,e>>=1,this.REG_ACC=e):(e=255&this.load(a),this.F_CARRY=1&e,e>>=1,this.write(a,e)),this.F_SIGN=0,this.F_ZERO=e;break;case 33:break;case 34:e=255&(this.load(a)|this.REG_ACC),this.F_SIGN=e>>7&1,this.F_ZERO=e,this.REG_ACC=e,11!==n&&(s+=r);break;case 35:this.push(this.REG_ACC);break;case 36:this.F_BRK=1,this.push(this.F_CARRY|(0===this.F_ZERO?1:0)<<1|this.F_INTERRUPT<<2|this.F_DECIMAL<<3|this.F_BRK<<4|this.F_NOTUSED<<5|this.F_OVERFLOW<<6|this.F_SIGN<<7);break;case 37:this.REG_ACC=this.pull(),this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC;break;case 38:e=this.pull(),this.F_CARRY=1&e,this.F_ZERO=1===(e>>1&1)?0:1,this.F_INTERRUPT=e>>2&1,this.F_DECIMAL=e>>3&1,this.F_BRK=e>>4&1,this.F_NOTUSED=e>>5&1,this.F_OVERFLOW=e>>6&1,this.F_SIGN=e>>7&1,this.F_NOTUSED=1;break;case 39:4===n?(e=this.REG_ACC,t=this.F_CARRY,this.F_CARRY=e>>7&1,e=(e<<1&255)+t,this.REG_ACC=e):(e=this.load(a),t=this.F_CARRY,this.F_CARRY=e>>7&1,e=(e<<1&255)+t,this.write(a,e)),this.F_SIGN=e>>7&1,this.F_ZERO=e;break;case 40:4===n?(t=this.F_CARRY<<7,this.F_CARRY=1&this.REG_ACC,e=(this.REG_ACC>>1)+t,this.REG_ACC=e):(e=this.load(a),t=this.F_CARRY<<7,this.F_CARRY=1&e,e=(e>>1)+t,this.write(a,e)),this.F_SIGN=e>>7&1,this.F_ZERO=e;break;case 41:if(e=this.pull(),this.F_CARRY=1&e,this.F_ZERO=0===(e>>1&1)?1:0,this.F_INTERRUPT=e>>2&1,this.F_DECIMAL=e>>3&1,this.F_BRK=e>>4&1,this.F_NOTUSED=e>>5&1,this.F_OVERFLOW=e>>6&1,this.F_SIGN=e>>7&1,this.REG_PC=this.pull(),this.REG_PC+=this.pull()<<8,65535===this.REG_PC)return;this.REG_PC--,this.F_NOTUSED=1;break;case 42:if(this.REG_PC=this.pull(),this.REG_PC+=this.pull()<<8,65535===this.REG_PC)return;break;case 43:e=this.REG_ACC-this.load(a)-(1-this.F_CARRY),this.F_SIGN=e>>7&1,this.F_ZERO=255&e,0!==(128&(this.REG_ACC^e))&&0!==(128&(this.REG_ACC^this.load(a)))?this.F_OVERFLOW=1:this.F_OVERFLOW=0,this.F_CARRY=e<0?0:1,this.REG_ACC=255&e,11!==n&&(s+=r);break;case 44:this.F_CARRY=1;break;case 45:this.F_DECIMAL=1;break;case 46:this.F_INTERRUPT=1;break;case 47:this.write(a,this.REG_ACC);break;case 48:this.write(a,this.REG_X);break;case 49:this.write(a,this.REG_Y);break;case 50:this.REG_X=this.REG_ACC,this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC;break;case 51:this.REG_Y=this.REG_ACC,this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC;break;case 52:this.REG_X=this.REG_SP-256,this.F_SIGN=this.REG_SP>>7&1,this.F_ZERO=this.REG_X;break;case 53:this.REG_ACC=this.REG_X,this.F_SIGN=this.REG_X>>7&1,this.F_ZERO=this.REG_X;break;case 54:this.REG_SP=this.REG_X+256,this.stackWrap();break;case 55:this.REG_ACC=this.REG_Y,this.F_SIGN=this.REG_Y>>7&1,this.F_ZERO=this.REG_Y;break;default:this.nes.stop(),this.nes.crashMessage="Game crashed, invalid opcode at address $"+o.toString(16)}return s},load:function(e){return e<8192?this.mem[2047&e]:this.nes.mmap.load(e)},load16bit:function(e){return e<8191?this.mem[2047&e]|this.mem[e+1&2047]<<8:this.nes.mmap.load(e)|this.nes.mmap.load(e+1)<<8},write:function(e,t){e<8192?this.mem[2047&e]=t:this.nes.mmap.write(e,t)},requestIrq:function(e){this.irqRequested&&e===this.IRQ_NORMAL||(this.irqRequested=!0,this.irqType=e)},push:function(e){this.nes.mmap.write(this.REG_SP,e),this.REG_SP--,this.REG_SP=256|255&this.REG_SP},stackWrap:function(){this.REG_SP=256|255&this.REG_SP},pull:function(){return this.REG_SP++,this.REG_SP=256|255&this.REG_SP,this.nes.mmap.load(this.REG_SP)},pageCrossed:function(e,t){return(65280&e)!==(65280&t)},haltCycles:function(e){this.cyclesToHalt+=e},doNonMaskableInterrupt:function(e){0!==(128&this.nes.mmap.load(8192))&&(this.REG_PC_NEW++,this.push(this.REG_PC_NEW>>8&255),this.push(255&this.REG_PC_NEW),this.push(e),this.REG_PC_NEW=this.nes.mmap.load(65530)|this.nes.mmap.load(65531)<<8,this.REG_PC_NEW--)},doResetInterrupt:function(){this.REG_PC_NEW=this.nes.mmap.load(65532)|this.nes.mmap.load(65533)<<8,this.REG_PC_NEW--},doIrq:function(e){this.REG_PC_NEW++,this.push(this.REG_PC_NEW>>8&255),this.push(255&this.REG_PC_NEW),this.push(e),this.F_INTERRUPT_NEW=1,this.F_BRK_NEW=0,this.REG_PC_NEW=this.nes.mmap.load(65534)|this.nes.mmap.load(65535)<<8,this.REG_PC_NEW--},getStatus:function(){return this.F_CARRY|this.F_ZERO<<1|this.F_INTERRUPT<<2|this.F_DECIMAL<<3|this.F_BRK<<4|this.F_NOTUSED<<5|this.F_OVERFLOW<<6|this.F_SIGN<<7},setStatus:function(e){this.F_CARRY=1&e,this.F_ZERO=e>>1&1,this.F_INTERRUPT=e>>2&1,this.F_DECIMAL=e>>3&1,this.F_BRK=e>>4&1,this.F_NOTUSED=e>>5&1,this.F_OVERFLOW=e>>6&1,this.F_SIGN=e>>7&1},JSON_PROPERTIES:["mem","cyclesToHalt","irqRequested","irqType","REG_ACC","REG_X","REG_Y","REG_SP","REG_PC","REG_PC_NEW","REG_STATUS","F_CARRY","F_DECIMAL","F_INTERRUPT","F_INTERRUPT_NEW","F_OVERFLOW","F_SIGN","F_ZERO","F_NOTUSED","F_NOTUSED_NEW","F_BRK","F_BRK_NEW"],toJSON:function(){return s.toJSON(this)},fromJSON:function(e){s.fromJSON(this,e)}};var n=function(){this.opdata=new Array(256);for(var e=0;e<256;e++)this.opdata[e]=255;this.setOp(this.INS_ADC,105,this.ADDR_IMM,2,2),this.setOp(this.INS_ADC,101,this.ADDR_ZP,2,3),this.setOp(this.INS_ADC,117,this.ADDR_ZPX,2,4),this.setOp(this.INS_ADC,109,this.ADDR_ABS,3,4),this.setOp(this.INS_ADC,125,this.ADDR_ABSX,3,4),this.setOp(this.INS_ADC,121,this.ADDR_ABSY,3,4),this.setOp(this.INS_ADC,97,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_ADC,113,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_AND,41,this.ADDR_IMM,2,2),this.setOp(this.INS_AND,37,this.ADDR_ZP,2,3),this.setOp(this.INS_AND,53,this.ADDR_ZPX,2,4),this.setOp(this.INS_AND,45,this.ADDR_ABS,3,4),this.setOp(this.INS_AND,61,this.ADDR_ABSX,3,4),this.setOp(this.INS_AND,57,this.ADDR_ABSY,3,4),this.setOp(this.INS_AND,33,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_AND,49,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_ASL,10,this.ADDR_ACC,1,2),this.setOp(this.INS_ASL,6,this.ADDR_ZP,2,5),this.setOp(this.INS_ASL,22,this.ADDR_ZPX,2,6),this.setOp(this.INS_ASL,14,this.ADDR_ABS,3,6),this.setOp(this.INS_ASL,30,this.ADDR_ABSX,3,7),this.setOp(this.INS_BCC,144,this.ADDR_REL,2,2),this.setOp(this.INS_BCS,176,this.ADDR_REL,2,2),this.setOp(this.INS_BEQ,240,this.ADDR_REL,2,2),this.setOp(this.INS_BIT,36,this.ADDR_ZP,2,3),this.setOp(this.INS_BIT,44,this.ADDR_ABS,3,4),this.setOp(this.INS_BMI,48,this.ADDR_REL,2,2),this.setOp(this.INS_BNE,208,this.ADDR_REL,2,2),this.setOp(this.INS_BPL,16,this.ADDR_REL,2,2),this.setOp(this.INS_BRK,0,this.ADDR_IMP,1,7),this.setOp(this.INS_BVC,80,this.ADDR_REL,2,2),this.setOp(this.INS_BVS,112,this.ADDR_REL,2,2),this.setOp(this.INS_CLC,24,this.ADDR_IMP,1,2),this.setOp(this.INS_CLD,216,this.ADDR_IMP,1,2),this.setOp(this.INS_CLI,88,this.ADDR_IMP,1,2),this.setOp(this.INS_CLV,184,this.ADDR_IMP,1,2),this.setOp(this.INS_CMP,201,this.ADDR_IMM,2,2),this.setOp(this.INS_CMP,197,this.ADDR_ZP,2,3),this.setOp(this.INS_CMP,213,this.ADDR_ZPX,2,4),this.setOp(this.INS_CMP,205,this.ADDR_ABS,3,4),this.setOp(this.INS_CMP,221,this.ADDR_ABSX,3,4),this.setOp(this.INS_CMP,217,this.ADDR_ABSY,3,4),this.setOp(this.INS_CMP,193,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_CMP,209,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_CPX,224,this.ADDR_IMM,2,2),this.setOp(this.INS_CPX,228,this.ADDR_ZP,2,3),this.setOp(this.INS_CPX,236,this.ADDR_ABS,3,4),this.setOp(this.INS_CPY,192,this.ADDR_IMM,2,2),this.setOp(this.INS_CPY,196,this.ADDR_ZP,2,3),this.setOp(this.INS_CPY,204,this.ADDR_ABS,3,4),this.setOp(this.INS_DEC,198,this.ADDR_ZP,2,5),this.setOp(this.INS_DEC,214,this.ADDR_ZPX,2,6),this.setOp(this.INS_DEC,206,this.ADDR_ABS,3,6),this.setOp(this.INS_DEC,222,this.ADDR_ABSX,3,7),this.setOp(this.INS_DEX,202,this.ADDR_IMP,1,2),this.setOp(this.INS_DEY,136,this.ADDR_IMP,1,2),this.setOp(this.INS_EOR,73,this.ADDR_IMM,2,2),this.setOp(this.INS_EOR,69,this.ADDR_ZP,2,3),this.setOp(this.INS_EOR,85,this.ADDR_ZPX,2,4),this.setOp(this.INS_EOR,77,this.ADDR_ABS,3,4),this.setOp(this.INS_EOR,93,this.ADDR_ABSX,3,4),this.setOp(this.INS_EOR,89,this.ADDR_ABSY,3,4),this.setOp(this.INS_EOR,65,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_EOR,81,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_INC,230,this.ADDR_ZP,2,5),this.setOp(this.INS_INC,246,this.ADDR_ZPX,2,6),this.setOp(this.INS_INC,238,this.ADDR_ABS,3,6),this.setOp(this.INS_INC,254,this.ADDR_ABSX,3,7),this.setOp(this.INS_INX,232,this.ADDR_IMP,1,2),this.setOp(this.INS_INY,200,this.ADDR_IMP,1,2),this.setOp(this.INS_JMP,76,this.ADDR_ABS,3,3),this.setOp(this.INS_JMP,108,this.ADDR_INDABS,3,5),this.setOp(this.INS_JSR,32,this.ADDR_ABS,3,6),this.setOp(this.INS_LDA,169,this.ADDR_IMM,2,2),this.setOp(this.INS_LDA,165,this.ADDR_ZP,2,3),this.setOp(this.INS_LDA,181,this.ADDR_ZPX,2,4),this.setOp(this.INS_LDA,173,this.ADDR_ABS,3,4),this.setOp(this.INS_LDA,189,this.ADDR_ABSX,3,4),this.setOp(this.INS_LDA,185,this.ADDR_ABSY,3,4),this.setOp(this.INS_LDA,161,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_LDA,177,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_LDX,162,this.ADDR_IMM,2,2),this.setOp(this.INS_LDX,166,this.ADDR_ZP,2,3),this.setOp(this.INS_LDX,182,this.ADDR_ZPY,2,4),this.setOp(this.INS_LDX,174,this.ADDR_ABS,3,4),this.setOp(this.INS_LDX,190,this.ADDR_ABSY,3,4),this.setOp(this.INS_LDY,160,this.ADDR_IMM,2,2),this.setOp(this.INS_LDY,164,this.ADDR_ZP,2,3),this.setOp(this.INS_LDY,180,this.ADDR_ZPX,2,4),this.setOp(this.INS_LDY,172,this.ADDR_ABS,3,4),this.setOp(this.INS_LDY,188,this.ADDR_ABSX,3,4),this.setOp(this.INS_LSR,74,this.ADDR_ACC,1,2),this.setOp(this.INS_LSR,70,this.ADDR_ZP,2,5),this.setOp(this.INS_LSR,86,this.ADDR_ZPX,2,6),this.setOp(this.INS_LSR,78,this.ADDR_ABS,3,6),this.setOp(this.INS_LSR,94,this.ADDR_ABSX,3,7),this.setOp(this.INS_NOP,234,this.ADDR_IMP,1,2),
this.setOp(this.INS_ORA,9,this.ADDR_IMM,2,2),this.setOp(this.INS_ORA,5,this.ADDR_ZP,2,3),this.setOp(this.INS_ORA,21,this.ADDR_ZPX,2,4),this.setOp(this.INS_ORA,13,this.ADDR_ABS,3,4),this.setOp(this.INS_ORA,29,this.ADDR_ABSX,3,4),this.setOp(this.INS_ORA,25,this.ADDR_ABSY,3,4),this.setOp(this.INS_ORA,1,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_ORA,17,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_PHA,72,this.ADDR_IMP,1,3),this.setOp(this.INS_PHP,8,this.ADDR_IMP,1,3),this.setOp(this.INS_PLA,104,this.ADDR_IMP,1,4),this.setOp(this.INS_PLP,40,this.ADDR_IMP,1,4),this.setOp(this.INS_ROL,42,this.ADDR_ACC,1,2),this.setOp(this.INS_ROL,38,this.ADDR_ZP,2,5),this.setOp(this.INS_ROL,54,this.ADDR_ZPX,2,6),this.setOp(this.INS_ROL,46,this.ADDR_ABS,3,6),this.setOp(this.INS_ROL,62,this.ADDR_ABSX,3,7),this.setOp(this.INS_ROR,106,this.ADDR_ACC,1,2),this.setOp(this.INS_ROR,102,this.ADDR_ZP,2,5),this.setOp(this.INS_ROR,118,this.ADDR_ZPX,2,6),this.setOp(this.INS_ROR,110,this.ADDR_ABS,3,6),this.setOp(this.INS_ROR,126,this.ADDR_ABSX,3,7),this.setOp(this.INS_RTI,64,this.ADDR_IMP,1,6),this.setOp(this.INS_RTS,96,this.ADDR_IMP,1,6),this.setOp(this.INS_SBC,233,this.ADDR_IMM,2,2),this.setOp(this.INS_SBC,229,this.ADDR_ZP,2,3),this.setOp(this.INS_SBC,245,this.ADDR_ZPX,2,4),this.setOp(this.INS_SBC,237,this.ADDR_ABS,3,4),this.setOp(this.INS_SBC,253,this.ADDR_ABSX,3,4),this.setOp(this.INS_SBC,249,this.ADDR_ABSY,3,4),this.setOp(this.INS_SBC,225,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_SBC,241,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_SEC,56,this.ADDR_IMP,1,2),this.setOp(this.INS_SED,248,this.ADDR_IMP,1,2),this.setOp(this.INS_SEI,120,this.ADDR_IMP,1,2),this.setOp(this.INS_STA,133,this.ADDR_ZP,2,3),this.setOp(this.INS_STA,149,this.ADDR_ZPX,2,4),this.setOp(this.INS_STA,141,this.ADDR_ABS,3,4),this.setOp(this.INS_STA,157,this.ADDR_ABSX,3,5),this.setOp(this.INS_STA,153,this.ADDR_ABSY,3,5),this.setOp(this.INS_STA,129,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_STA,145,this.ADDR_POSTIDXIND,2,6),this.setOp(this.INS_STX,134,this.ADDR_ZP,2,3),this.setOp(this.INS_STX,150,this.ADDR_ZPY,2,4),this.setOp(this.INS_STX,142,this.ADDR_ABS,3,4),this.setOp(this.INS_STY,132,this.ADDR_ZP,2,3),this.setOp(this.INS_STY,148,this.ADDR_ZPX,2,4),this.setOp(this.INS_STY,140,this.ADDR_ABS,3,4),this.setOp(this.INS_TAX,170,this.ADDR_IMP,1,2),this.setOp(this.INS_TAY,168,this.ADDR_IMP,1,2),this.setOp(this.INS_TSX,186,this.ADDR_IMP,1,2),this.setOp(this.INS_TXA,138,this.ADDR_IMP,1,2),this.setOp(this.INS_TXS,154,this.ADDR_IMP,1,2),this.setOp(this.INS_TYA,152,this.ADDR_IMP,1,2),this.cycTable=new Array(7,6,2,8,3,3,5,5,3,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,7,7,6,6,2,8,3,3,5,5,4,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,7,7,6,6,2,8,3,3,5,5,3,2,2,2,3,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,7,7,6,6,2,8,3,3,5,5,4,2,2,2,5,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,7,7,2,6,2,6,3,3,3,3,2,2,2,2,4,4,4,4,2,6,2,6,4,4,4,4,2,5,2,5,5,5,5,5,2,6,2,6,3,3,3,3,2,2,2,2,4,4,4,4,2,5,2,5,4,4,4,4,2,4,2,4,4,4,4,4,2,6,2,8,3,3,5,5,2,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,7,7,2,6,3,8,3,3,5,5,2,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,7,7),this.instname=new Array(56),this.instname[0]="ADC",this.instname[1]="AND",this.instname[2]="ASL",this.instname[3]="BCC",this.instname[4]="BCS",this.instname[5]="BEQ",this.instname[6]="BIT",this.instname[7]="BMI",this.instname[8]="BNE",this.instname[9]="BPL",this.instname[10]="BRK",this.instname[11]="BVC",this.instname[12]="BVS",this.instname[13]="CLC",this.instname[14]="CLD",this.instname[15]="CLI",this.instname[16]="CLV",this.instname[17]="CMP",this.instname[18]="CPX",this.instname[19]="CPY",this.instname[20]="DEC",this.instname[21]="DEX",this.instname[22]="DEY",this.instname[23]="EOR",this.instname[24]="INC",this.instname[25]="INX",this.instname[26]="INY",this.instname[27]="JMP",this.instname[28]="JSR",this.instname[29]="LDA",this.instname[30]="LDX",this.instname[31]="LDY",this.instname[32]="LSR",this.instname[33]="NOP",this.instname[34]="ORA",this.instname[35]="PHA",this.instname[36]="PHP",this.instname[37]="PLA",this.instname[38]="PLP",this.instname[39]="ROL",this.instname[40]="ROR",this.instname[41]="RTI",this.instname[42]="RTS",this.instname[43]="SBC",this.instname[44]="SEC",this.instname[45]="SED",this.instname[46]="SEI";this.instname[47]="STA";this.instname[48]="STX",this.instname[49]="STY",this.instname[50]="TAX",this.instname[51]="TAY",this.instname[52]="TSX",this.instname[53]="TXA",this.instname[54]="TXS",this.instname[55]="TYA",this.addrDesc=new Array("Zero Page           ","Relative            ","Implied             ","Absolute            ","Accumulator         ","Immediate           ","Zero Page,X         ","Zero Page,Y         ","Absolute,X          ","Absolute,Y          ","Preindexed Indirect ","Postindexed Indirect","Indirect Absolute   ")};n.prototype={INS_ADC:0,INS_AND:1,INS_ASL:2,INS_BCC:3,INS_BCS:4,INS_BEQ:5,INS_BIT:6,INS_BMI:7,INS_BNE:8,INS_BPL:9,INS_BRK:10,INS_BVC:11,INS_BVS:12,INS_CLC:13,INS_CLD:14,INS_CLI:15,INS_CLV:16,INS_CMP:17,INS_CPX:18,INS_CPY:19,INS_DEC:20,INS_DEX:21,INS_DEY:22,INS_EOR:23,INS_INC:24,INS_INX:25,INS_INY:26,INS_JMP:27,INS_JSR:28,INS_LDA:29,INS_LDX:30,INS_LDY:31,INS_LSR:32,INS_NOP:33,INS_ORA:34,INS_PHA:35,INS_PHP:36,INS_PLA:37,INS_PLP:38,INS_ROL:39,INS_ROR:40,INS_RTI:41,INS_RTS:42,INS_SBC:43,INS_SEC:44,INS_SED:45,INS_SEI:46,INS_STA:47,INS_STX:48,INS_STY:49,INS_TAX:50,INS_TAY:51,INS_TSX:52,INS_TXA:53,INS_TXS:54,INS_TYA:55,INS_DUMMY:56,ADDR_ZP:0,ADDR_REL:1,ADDR_IMP:2,ADDR_ABS:3,ADDR_ACC:4,ADDR_IMM:5,ADDR_ZPX:6,ADDR_ZPY:7,ADDR_ABSX:8,ADDR_ABSY:9,ADDR_PREIDXIND:10,ADDR_POSTIDXIND:11,ADDR_INDABS:12,setOp:function(e,t,i,s,r){this.opdata[t]=255&e|(255&i)<<8|(255&s)<<16|(255&r)<<24}},e.exports=r;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(r,"CPU","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/jsnes/cpu.js"),__REACT_HOT_LOADER__.register(n,"OpData","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/jsnes/cpu.js"))})()},function(e,t){"use strict";e.exports={copyArrayElements:function(e,t,i,s,r){for(var n=0;n<r;++n)i[s+n]=e[t+n]},copyArray:function(e){for(var t=new Array(e.length),i=0;i<e.length;i++)t[i]=e[i];return t},fromJSON:function(e,t){for(var i=0;i<e.JSON_PROPERTIES.length;i++)e[e.JSON_PROPERTIES[i]]=t[e.JSON_PROPERTIES[i]]},toJSON:function(e){for(var t={},i=0;i<e.JSON_PROPERTIES.length;i++)t[e.JSON_PROPERTIES[i]]=e[e.JSON_PROPERTIES[i]];return t}};(function(){"undefined"==typeof __REACT_HOT_LOADER__})()},function(e,t,i){"use strict";var s=i(334),r=i(332),n=function(e){this.nes=e,this.vramMem=null,this.spriteMem=null,this.vramAddress=null,this.vramTmpAddress=null,this.vramBufferedReadValue=null,this.firstWrite=null,this.sramAddress=null,this.currentMirroring=null,this.requestEndFrame=null,this.nmiOk=null,this.dummyCycleToggle=null,this.validTileData=null,this.nmiCounter=null,this.scanlineAlreadyRendered=null,this.f_nmiOnVblank=null,this.f_spriteSize=null,this.f_bgPatternTable=null,this.f_spPatternTable=null,this.f_addrInc=null,this.f_nTblAddress=null,this.f_color=null,this.f_spVisibility=null,this.f_bgVisibility=null,this.f_spClipping=null,this.f_bgClipping=null,this.f_dispType=null,this.cntFV=null,this.cntV=null,this.cntH=null,this.cntVT=null,this.cntHT=null,this.regFV=null,this.regV=null,this.regH=null,this.regVT=null,this.regHT=null,this.regFH=null,this.regS=null,this.curNt=null,this.attrib=null,this.buffer=null,this.bgbuffer=null,this.pixrendered=null,this.validTileData=null,this.scantile=null,this.scanline=null,this.lastRenderedScanline=null,this.curX=null,this.sprX=null,this.sprY=null,this.sprTile=null,this.sprCol=null,this.vertFlip=null,this.horiFlip=null,this.bgPriority=null,this.spr0HitX=null,this.spr0HitY=null,this.hitSpr0=null,this.sprPalette=null,this.imgPalette=null,this.ptTile=null,this.ntable1=null,this.currentMirroring=null,this.nameTable=null,this.vramMirrorTable=null,this.palTable=null,this.showSpr0Hit=!1,this.clipToTvSize=!0,this.reset()};n.prototype={STATUS_VRAMWRITE:4,STATUS_SLSPRITECOUNT:5,STATUS_SPRITE0HIT:6,STATUS_VBLANK:7,reset:function(){var e;for(this.vramMem=new Array(32768),this.spriteMem=new Array(256),e=0;e<this.vramMem.length;e++)this.vramMem[e]=0;for(e=0;e<this.spriteMem.length;e++)this.spriteMem[e]=0;for(this.vramAddress=null,this.vramTmpAddress=null,this.vramBufferedReadValue=0,this.firstWrite=!0,this.sramAddress=0,this.currentMirroring=-1,this.requestEndFrame=!1,this.nmiOk=!1,this.dummyCycleToggle=!1,this.validTileData=!1,this.nmiCounter=0,this.scanlineAlreadyRendered=null,this.f_nmiOnVblank=0,this.f_spriteSize=0,this.f_bgPatternTable=0,this.f_spPatternTable=0,this.f_addrInc=0,this.f_nTblAddress=0,this.f_color=0,this.f_spVisibility=0,this.f_bgVisibility=0,this.f_spClipping=0,this.f_bgClipping=0,this.f_dispType=0,this.cntFV=0,this.cntV=0,this.cntH=0,this.cntVT=0,this.cntHT=0,this.regFV=0,this.regV=0,this.regH=0,this.regVT=0,this.regHT=0,this.regFH=0,this.regS=0,this.curNt=null,this.attrib=new Array(32),this.buffer=new Array(61440),this.bgbuffer=new Array(61440),this.pixrendered=new Array(61440),this.validTileData=null,this.scantile=new Array(32),this.scanline=0,this.lastRenderedScanline=-1,this.curX=0,this.sprX=new Array(64),this.sprY=new Array(64),this.sprTile=new Array(64),this.sprCol=new Array(64),this.vertFlip=new Array(64),this.horiFlip=new Array(64),this.bgPriority=new Array(64),this.spr0HitX=0,this.spr0HitY=0,this.hitSpr0=!1,this.sprPalette=new Array(16),this.imgPalette=new Array(16),this.ptTile=new Array(512),e=0;e<512;e++)this.ptTile[e]=new s;for(this.ntable1=new Array(4),this.currentMirroring=-1,this.nameTable=new Array(4),e=0;e<4;e++)this.nameTable[e]=new o(32,32,"Nt"+e);for(this.vramMirrorTable=new Array(32768),e=0;e<32768;e++)this.vramMirrorTable[e]=e;this.palTable=new a,this.palTable.loadNTSCPalette(),this.updateControlReg1(0),this.updateControlReg2(0)},setMirroring:function(e){if(e!==this.currentMirroring){this.currentMirroring=e,this.triggerRendering(),null===this.vramMirrorTable&&(this.vramMirrorTable=new Array(32768));for(var t=0;t<32768;t++)this.vramMirrorTable[t]=t;this.defineMirrorRegion(16160,16128,32),this.defineMirrorRegion(16192,16128,32),this.defineMirrorRegion(16256,16128,32),this.defineMirrorRegion(16320,16128,32),this.defineMirrorRegion(12288,8192,3840),this.defineMirrorRegion(16384,0,16384),e===this.nes.rom.HORIZONTAL_MIRRORING?(this.ntable1[0]=0,this.ntable1[1]=0,this.ntable1[2]=1,this.ntable1[3]=1,this.defineMirrorRegion(9216,8192,1024),this.defineMirrorRegion(11264,10240,1024)):e===this.nes.rom.VERTICAL_MIRRORING?(this.ntable1[0]=0,this.ntable1[1]=1,this.ntable1[2]=0,this.ntable1[3]=1,this.defineMirrorRegion(10240,8192,1024),this.defineMirrorRegion(11264,9216,1024)):e===this.nes.rom.SINGLESCREEN_MIRRORING?(this.ntable1[0]=0,this.ntable1[1]=0,this.ntable1[2]=0,this.ntable1[3]=0,this.defineMirrorRegion(9216,8192,1024),this.defineMirrorRegion(10240,8192,1024),this.defineMirrorRegion(11264,8192,1024)):e===this.nes.rom.SINGLESCREEN_MIRRORING2?(this.ntable1[0]=1,this.ntable1[1]=1,this.ntable1[2]=1,this.ntable1[3]=1,this.defineMirrorRegion(9216,9216,1024),this.defineMirrorRegion(10240,9216,1024),this.defineMirrorRegion(11264,9216,1024)):(this.ntable1[0]=0,this.ntable1[1]=1,this.ntable1[2]=2,this.ntable1[3]=3)}},defineMirrorRegion:function(e,t,i){for(var s=0;s<i;s++)this.vramMirrorTable[e+s]=t+s},startVBlank:function(){this.nes.cpu.requestIrq(this.nes.cpu.IRQ_NMI),this.lastRenderedScanline<239&&this.renderFramePartially(this.lastRenderedScanline+1,240-this.lastRenderedScanline),this.endFrame(),this.lastRenderedScanline=-1},endScanline:function(){switch(this.scanline){case 19:this.dummyCycleToggle&&(this.curX=1,this.dummyCycleToggle=!this.dummyCycleToggle);break;case 20:this.setStatusFlag(this.STATUS_VBLANK,!1),this.setStatusFlag(this.STATUS_SPRITE0HIT,!1),this.hitSpr0=!1,this.spr0HitX=-1,this.spr0HitY=-1,1!==this.f_bgVisibility&&1!==this.f_spVisibility||(this.cntFV=this.regFV,this.cntV=this.regV,this.cntH=this.regH,this.cntVT=this.regVT,this.cntHT=this.regHT,1===this.f_bgVisibility&&this.renderBgScanline(!1,0)),1===this.f_bgVisibility&&1===this.f_spVisibility&&this.checkSprite0(0),1!==this.f_bgVisibility&&1!==this.f_spVisibility||this.nes.mmap.clockIrqCounter();break;case 261:this.setStatusFlag(this.STATUS_VBLANK,!0),this.requestEndFrame=!0,this.nmiCounter=9,this.scanline=-1;break;default:this.scanline>=21&&this.scanline<=260&&(1===this.f_bgVisibility&&(this.scanlineAlreadyRendered||(this.cntHT=this.regHT,this.cntH=this.regH,this.renderBgScanline(!0,this.scanline+1-21)),this.scanlineAlreadyRendered=!1,this.hitSpr0||1!==this.f_spVisibility||this.sprX[0]>=-7&&this.sprX[0]<256&&this.sprY[0]+1<=this.scanline-20&&this.sprY[0]+1+(0===this.f_spriteSize?8:16)>=this.scanline-20&&this.checkSprite0(this.scanline-20)&&(this.hitSpr0=!0)),1!==this.f_bgVisibility&&1!==this.f_spVisibility||this.nes.mmap.clockIrqCounter())}this.scanline++,this.regsToAddress(),this.cntsToAddress()},startFrame:function(){var e=0;if(0===this.f_dispType)e=this.imgPalette[0];else switch(this.f_color){case 0:e=0;break;case 1:e=65280;break;case 2:e=16711680;break;case 3:e=0;break;case 4:e=255;break;default:e=0}var t,i=this.buffer;for(t=0;t<61440;t++)i[t]=e;var s=this.pixrendered;for(t=0;t<s.length;t++)s[t]=65},endFrame:function(){var e,t,i,s=this.buffer;if(this.showSpr0Hit){if(this.sprX[0]>=0&&this.sprX[0]<256&&this.sprY[0]>=0&&this.sprY[0]<240){for(e=0;e<256;e++)s[(this.sprY[0]<<8)+e]=16733525;for(e=0;e<240;e++)s[(e<<8)+this.sprX[0]]=16733525}if(this.spr0HitX>=0&&this.spr0HitX<256&&this.spr0HitY>=0&&this.spr0HitY<240){for(e=0;e<256;e++)s[(this.spr0HitY<<8)+e]=5635925;for(e=0;e<240;e++)s[(e<<8)+this.spr0HitX]=5635925}}if(this.clipToTvSize||0===this.f_bgClipping||0===this.f_spClipping)for(i=0;i<240;i++)for(t=0;t<8;t++)s[(i<<8)+t]=0;if(this.clipToTvSize)for(i=0;i<240;i++)for(t=0;t<8;t++)s[(i<<8)+255-t]=0;if(this.clipToTvSize)for(i=0;i<8;i++)for(t=0;t<256;t++)s[(i<<8)+t]=0,s[(239-i<<8)+t]=0;this.nes.opts.onFrame(s)},updateControlReg1:function(e){this.triggerRendering(),this.f_nmiOnVblank=e>>7&1,this.f_spriteSize=e>>5&1,this.f_bgPatternTable=e>>4&1,this.f_spPatternTable=e>>3&1,this.f_addrInc=e>>2&1,this.f_nTblAddress=3&e,this.regV=e>>1&1,this.regH=1&e,this.regS=e>>4&1},updateControlReg2:function(e){this.triggerRendering(),this.f_color=e>>5&7,this.f_spVisibility=e>>4&1,this.f_bgVisibility=e>>3&1,this.f_spClipping=e>>2&1,this.f_bgClipping=e>>1&1,this.f_dispType=1&e,0===this.f_dispType&&this.palTable.setEmphasis(this.f_color),this.updatePalettes()},setStatusFlag:function(e,t){var i=1<<e;this.nes.cpu.mem[8194]=this.nes.cpu.mem[8194]&255-i|(t?i:0)},readStatusRegister:function(){var e=this.nes.cpu.mem[8194];return this.firstWrite=!0,this.setStatusFlag(this.STATUS_VBLANK,!1),e},writeSRAMAddress:function(e){this.sramAddress=e},sramLoad:function(){return this.spriteMem[this.sramAddress]},sramWrite:function(e){this.spriteMem[this.sramAddress]=e,this.spriteRamWriteUpdate(this.sramAddress,e),this.sramAddress++,this.sramAddress%=256},scrollWrite:function(e){this.triggerRendering(),this.firstWrite?(this.regHT=e>>3&31,this.regFH=7&e):(this.regFV=7&e,this.regVT=e>>3&31),this.firstWrite=!this.firstWrite},writeVRAMAddress:function(e){this.firstWrite?(this.regFV=e>>4&3,this.regV=e>>3&1,this.regH=e>>2&1,this.regVT=7&this.regVT|(3&e)<<3):(this.triggerRendering(),this.regVT=24&this.regVT|e>>5&7,this.regHT=31&e,this.cntFV=this.regFV,this.cntV=this.regV,this.cntH=this.regH,this.cntVT=this.regVT,this.cntHT=this.regHT,this.checkSprite0(this.scanline-20)),this.firstWrite=!this.firstWrite,this.cntsToAddress(),this.vramAddress<8192&&this.nes.mmap.latchAccess(this.vramAddress)},vramLoad:function(){var e;return this.cntsToAddress(),this.regsToAddress(),this.vramAddress<=16127?(e=this.vramBufferedReadValue,this.vramAddress<8192?this.vramBufferedReadValue=this.vramMem[this.vramAddress]:this.vramBufferedReadValue=this.mirroredLoad(this.vramAddress),this.vramAddress<8192&&this.nes.mmap.latchAccess(this.vramAddress),this.vramAddress+=1===this.f_addrInc?32:1,this.cntsFromAddress(),this.regsFromAddress(),e):(e=this.mirroredLoad(this.vramAddress),this.vramAddress+=1===this.f_addrInc?32:1,this.cntsFromAddress(),this.regsFromAddress(),e)},vramWrite:function(e){this.triggerRendering(),this.cntsToAddress(),this.regsToAddress(),this.vramAddress>=8192?this.mirroredWrite(this.vramAddress,e):(this.writeMem(this.vramAddress,e),this.nes.mmap.latchAccess(this.vramAddress)),this.vramAddress+=1===this.f_addrInc?32:1,this.regsFromAddress(),this.cntsFromAddress()},sramDMA:function(e){for(var t,i=256*e,s=this.sramAddress;s<256;s++)t=this.nes.cpu.mem[i+s],this.spriteMem[s]=t,this.spriteRamWriteUpdate(s,t);this.nes.cpu.haltCycles(513)},regsFromAddress:function(){var e=this.vramTmpAddress>>8&255;this.regFV=e>>4&7,this.regV=e>>3&1,this.regH=e>>2&1,this.regVT=7&this.regVT|(3&e)<<3,e=255&this.vramTmpAddress,this.regVT=24&this.regVT|e>>5&7,this.regHT=31&e},cntsFromAddress:function(){var e=this.vramAddress>>8&255;this.cntFV=e>>4&3,this.cntV=e>>3&1,this.cntH=e>>2&1,this.cntVT=7&this.cntVT|(3&e)<<3,e=255&this.vramAddress,this.cntVT=24&this.cntVT|e>>5&7,this.cntHT=31&e},regsToAddress:function(){var e=(7&this.regFV)<<4;e|=(1&this.regV)<<3,e|=(1&this.regH)<<2,e|=this.regVT>>3&3;var t=(7&this.regVT)<<5;t|=31&this.regHT,this.vramTmpAddress=32767&(e<<8|t)},cntsToAddress:function(){var e=(7&this.cntFV)<<4;e|=(1&this.cntV)<<3,e|=(1&this.cntH)<<2,e|=this.cntVT>>3&3;var t=(7&this.cntVT)<<5;t|=31&this.cntHT,this.vramAddress=32767&(e<<8|t)},incTileCounter:function(e){for(var t=e;0!==t;t--)this.cntHT++,32===this.cntHT&&(this.cntHT=0,this.cntVT++,this.cntVT>=30&&(this.cntH++,2===this.cntH&&(this.cntH=0,this.cntV++,2===this.cntV&&(this.cntV=0,this.cntFV++,this.cntFV&=7))))},mirroredLoad:function(e){return this.vramMem[this.vramMirrorTable[e]]},mirroredWrite:function(e,t){if(e>=16128&&e<16160)16128===e||16144===e?(this.writeMem(16128,t),this.writeMem(16144,t)):16132===e||16148===e?(this.writeMem(16132,t),this.writeMem(16148,t)):16136===e||16152===e?(this.writeMem(16136,t),this.writeMem(16152,t)):16140===e||16156===e?(this.writeMem(16140,t),this.writeMem(16156,t)):this.writeMem(e,t);else{if(!(e<this.vramMirrorTable.length))throw new Error("Invalid VRAM address: "+e.toString(16));this.writeMem(this.vramMirrorTable[e],t)}},triggerRendering:function(){this.scanline>=21&&this.scanline<=260&&(this.renderFramePartially(this.lastRenderedScanline+1,this.scanline-21-this.lastRenderedScanline),this.lastRenderedScanline=this.scanline-21)},renderFramePartially:function(e,t){if(1===this.f_spVisibility&&this.renderSpritesPartially(e,t,!0),1===this.f_bgVisibility){var i=e<<8,s=e+t<<8;s>61440&&(s=61440);for(var r=this.buffer,n=this.bgbuffer,o=this.pixrendered,a=i;a<s;a++)o[a]>255&&(r[a]=n[a])}1===this.f_spVisibility&&this.renderSpritesPartially(e,t,!1),this.validTileData=!1},renderBgScanline:function(e,t){var i=0===this.regS?0:256,s=(t<<8)-this.regFH;if(this.curNt=this.ntable1[this.cntV+this.cntV+this.cntH],this.cntHT=this.regHT,this.cntH=this.regH,this.curNt=this.ntable1[this.cntV+this.cntV+this.cntH],t<240&&t-this.cntFV>=0){for(var r,n,o,a,l=this.cntFV<<3,u=this.scantile,h=this.attrib,c=this.ptTile,d=this.nameTable,p=this.imgPalette,f=this.pixrendered,m=e?this.bgbuffer:this.buffer,_=0;_<32;_++){if(t>=0){if(this.validTileData){if(r=u[_],"undefined"==typeof r)continue;n=r.pix,o=h[_]}else{if(r=c[i+d[this.curNt].getTileIndex(this.cntHT,this.cntVT)],"undefined"==typeof r)continue;n=r.pix,o=d[this.curNt].getAttrib(this.cntHT,this.cntVT),u[_]=r,h[_]=o}var g=0,b=(_<<3)-this.regFH;if(b>-8)if(b<0&&(s-=b,g=-b),r.opaque[this.cntFV])for(;g<8;g++)m[s]=p[n[l+g]+o],f[s]|=256,s++;else for(;g<8;g++)a=n[l+g],0!==a&&(m[s]=p[a+o],f[s]|=256),s++}32===++this.cntHT&&(this.cntHT=0,this.cntH++,this.cntH%=2,this.curNt=this.ntable1[(this.cntV<<1)+this.cntH])}this.validTileData=!0}this.cntFV++,8===this.cntFV&&(this.cntFV=0,this.cntVT++,30===this.cntVT?(this.cntVT=0,this.cntV++,this.cntV%=2,this.curNt=this.ntable1[(this.cntV<<1)+this.cntH]):32===this.cntVT&&(this.cntVT=0),this.validTileData=!1)},renderSpritesPartially:function(e,t,i){if(1===this.f_spVisibility)for(var s=0;s<64;s++)if(this.bgPriority[s]===i&&this.sprX[s]>=0&&this.sprX[s]<256&&this.sprY[s]+8>=e&&this.sprY[s]<e+t)if(0===this.f_spriteSize)this.srcy1=0,this.srcy2=8,this.sprY[s]<e&&(this.srcy1=e-this.sprY[s]-1),this.sprY[s]+8>e+t&&(this.srcy2=e+t-this.sprY[s]+1),0===this.f_spPatternTable?this.ptTile[this.sprTile[s]].render(this.buffer,0,this.srcy1,8,this.srcy2,this.sprX[s],this.sprY[s]+1,this.sprCol[s],this.sprPalette,this.horiFlip[s],this.vertFlip[s],s,this.pixrendered):this.ptTile[this.sprTile[s]+256].render(this.buffer,0,this.srcy1,8,this.srcy2,this.sprX[s],this.sprY[s]+1,this.sprCol[s],this.sprPalette,this.horiFlip[s],this.vertFlip[s],s,this.pixrendered);else{var r=this.sprTile[s];0!==(1&r)&&(r=this.sprTile[s]-1+256);var n=0,o=8;this.sprY[s]<e&&(n=e-this.sprY[s]-1),this.sprY[s]+8>e+t&&(o=e+t-this.sprY[s]),this.ptTile[r+(this.vertFlip[s]?1:0)].render(this.buffer,0,n,8,o,this.sprX[s],this.sprY[s]+1,this.sprCol[s],this.sprPalette,this.horiFlip[s],this.vertFlip[s],s,this.pixrendered),n=0,o=8,this.sprY[s]+8<e&&(n=e-(this.sprY[s]+8+1)),this.sprY[s]+16>e+t&&(o=e+t-(this.sprY[s]+8)),this.ptTile[r+(this.vertFlip[s]?0:1)].render(this.buffer,0,n,8,o,this.sprX[s],this.sprY[s]+1+8,this.sprCol[s],this.sprPalette,this.horiFlip[s],this.vertFlip[s],s,this.pixrendered)}},checkSprite0:function(e){this.spr0HitX=-1,this.spr0HitY=-1;var t,i,s,r,n,o,a,l,u=0===this.f_spPatternTable?0:256;if(i=this.sprX[0],s=this.sprY[0]+1,0===this.f_spriteSize){if(s<=e&&s+8>e&&i>=-7&&i<256)if(r=this.ptTile[this.sprTile[0]+u],a=this.sprCol[0],l=this.bgPriority[0],t=this.vertFlip[0]?7-(e-s):e-s,t*=8,o=256*e+i,this.horiFlip[0])for(n=7;n>=0;n--){if(i>=0&&i<256&&o>=0&&o<61440&&0!==this.pixrendered[o]&&0!==r.pix[t+n])return this.spr0HitX=o%256,this.spr0HitY=e,!0;i++,o++}else for(n=0;n<8;n++){if(i>=0&&i<256&&o>=0&&o<61440&&0!==this.pixrendered[o]&&0!==r.pix[t+n])return this.spr0HitX=o%256,this.spr0HitY=e,!0;i++,o++}}else if(s<=e&&s+16>e&&i>=-7&&i<256)if(t=this.vertFlip[0]?15-(e-s):e-s,t<8?r=this.ptTile[this.sprTile[0]+(this.vertFlip[0]?1:0)+(0!==(1&this.sprTile[0])?255:0)]:(r=this.ptTile[this.sprTile[0]+(this.vertFlip[0]?0:1)+(0!==(1&this.sprTile[0])?255:0)],this.vertFlip[0]?t=15-t:t-=8),t*=8,a=this.sprCol[0],l=this.bgPriority[0],o=256*e+i,this.horiFlip[0])for(n=7;n>=0;n--){if(i>=0&&i<256&&o>=0&&o<61440&&0!==this.pixrendered[o]&&0!==r.pix[t+n])return this.spr0HitX=o%256,this.spr0HitY=e,!0;i++,o++}else for(n=0;n<8;n++){if(i>=0&&i<256&&o>=0&&o<61440&&0!==this.pixrendered[o]&&0!==r.pix[t+n])return this.spr0HitX=o%256,this.spr0HitY=e,!0;i++,o++}return!1},writeMem:function(e,t){this.vramMem[e]=t,e<8192?(this.vramMem[e]=t,this.patternWrite(e,t)):e>=8192&&e<9152?this.nameTableWrite(this.ntable1[0],e-8192,t):e>=9152&&e<9216?this.attribTableWrite(this.ntable1[0],e-9152,t):e>=9216&&e<10176?this.nameTableWrite(this.ntable1[1],e-9216,t):e>=10176&&e<10240?this.attribTableWrite(this.ntable1[1],e-10176,t):e>=10240&&e<11200?this.nameTableWrite(this.ntable1[2],e-10240,t):e>=11200&&e<11264?this.attribTableWrite(this.ntable1[2],e-11200,t):e>=11264&&e<12224?this.nameTableWrite(this.ntable1[3],e-11264,t):e>=12224&&e<12288?this.attribTableWrite(this.ntable1[3],e-12224,t):e>=16128&&e<16160&&this.updatePalettes()},updatePalettes:function(){var e;for(e=0;e<16;e++)0===this.f_dispType?this.imgPalette[e]=this.palTable.getEntry(63&this.vramMem[16128+e]):this.imgPalette[e]=this.palTable.getEntry(32&this.vramMem[16128+e]);for(e=0;e<16;e++)0===this.f_dispType?this.sprPalette[e]=this.palTable.getEntry(63&this.vramMem[16144+e]):this.sprPalette[e]=this.palTable.getEntry(32&this.vramMem[16144+e])},patternWrite:function(e,t){var i=Math.floor(e/16),s=e%16;s<8?this.ptTile[i].setScanline(s,t,this.vramMem[e+8]):this.ptTile[i].setScanline(s-8,this.vramMem[e-8],t)},nameTableWrite:function(e,t,i){this.nameTable[e].tile[t]=i,this.checkSprite0(this.scanline-20)},attribTableWrite:function(e,t,i){this.nameTable[e].writeAttrib(t,i)},spriteRamWriteUpdate:function(e,t){var i=Math.floor(e/4);0===i&&this.checkSprite0(this.scanline-20),e%4===0?this.sprY[i]=t:e%4===1?this.sprTile[i]=t:e%4===2?(this.vertFlip[i]=0!==(128&t),this.horiFlip[i]=0!==(64&t),this.bgPriority[i]=0!==(32&t),this.sprCol[i]=(3&t)<<2):e%4===3&&(this.sprX[i]=t)},doNMI:function(){this.setStatusFlag(this.STATUS_VBLANK,!0),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_NMI)},isPixelWhite:function(e,t){return this.triggerRendering(),16777215===this.nes.ppu.buffer[(t<<8)+e]},JSON_PROPERTIES:["vramMem","spriteMem","cntFV","cntV","cntH","cntVT","cntHT","regFV","regV","regH","regVT","regHT","regFH","regS","vramAddress","vramTmpAddress","f_nmiOnVblank","f_spriteSize","f_bgPatternTable","f_spPatternTable","f_addrInc","f_nTblAddress","f_color","f_spVisibility","f_bgVisibility","f_spClipping","f_bgClipping","f_dispType","vramBufferedReadValue","firstWrite","currentMirroring","vramMirrorTable","ntable1","sramAddress","hitSpr0","sprPalette","imgPalette","curX","scanline","lastRenderedScanline","curNt","scantile","attrib","buffer","bgbuffer","pixrendered","requestEndFrame","nmiOk","dummyCycleToggle","nmiCounter","validTileData","scanlineAlreadyRendered"],toJSON:function(){var e,t=r.toJSON(this);for(t.nameTable=[],e=0;e<this.nameTable.length;e++)t.nameTable[e]=this.nameTable[e].toJSON();for(t.ptTile=[],e=0;e<this.ptTile.length;e++)t.ptTile[e]=this.ptTile[e].toJSON();return t},fromJSON:function(e){var t;for(r.fromJSON(this,e),t=0;t<this.nameTable.length;t++)this.nameTable[t].fromJSON(e.nameTable[t]);for(t=0;t<this.ptTile.length;t++)this.ptTile[t].fromJSON(e.ptTile[t]);for(t=0;t<this.spriteMem.length;t++)this.spriteRamWriteUpdate(t,this.spriteMem[t])}};var o=function(e,t,i){this.width=e,this.height=t,this.name=i,this.tile=new Array(e*t),this.attrib=new Array(e*t);for(var s=0;s<e*t;s++)this.tile[s]=0,this.attrib[s]=0};o.prototype={getTileIndex:function(e,t){return this.tile[t*this.width+e]},getAttrib:function(e,t){return this.attrib[t*this.width+e]},writeAttrib:function(e,t){for(var i,s,r,n,o=e%8*4,a=4*Math.floor(e/8),l=0;l<2;l++)for(var u=0;u<2;u++){i=t>>2*(2*l+u)&3;for(var h=0;h<2;h++)for(var c=0;c<2;c++)s=o+2*u+c,r=a+2*l+h,n=r*this.width+s,this.attrib[r*this.width+s]=i<<2&12}},toJSON:function(){return{tile:this.tile,attrib:this.attrib}},fromJSON:function(e){this.tile=e.tile,this.attrib=e.attrib}};var a=function(){this.curTable=new Array(64),this.emphTable=new Array(8),this.currentEmph=-1};a.prototype={reset:function(){this.setEmphasis(0)},loadNTSCPalette:function(){this.curTable=[5395026,11796480,10485760,11599933,7602281,91,95,6208,12048,543240,26368,1196544,7153664,0,0,0,12899815,16728064,14421538,16729963,14090399,6818519,6588,21681,27227,35843,43776,2918400,10777088,0,0,0,16316664,16755516,16742785,16735173,16730354,14633471,4681215,46327,57599,58229,259115,7911470,15065624,7895160,0,0,16777215,16773822,16300216,16300248,16758527,16761855,13095423,10148607,8973816,8650717,12122296,16119980,16777136,16308472,0,0],this.makeTables(),this.setEmphasis(0)},loadPALPalette:function(){this.curTable=[5395026,11796480,10485760,11599933,7602281,91,95,6208,12048,543240,26368,1196544,7153664,0,0,0,12899815,16728064,14421538,16729963,14090399,6818519,6588,21681,27227,35843,43776,2918400,10777088,0,0,0,16316664,16755516,16742785,16735173,16730354,14633471,4681215,46327,57599,58229,259115,7911470,15065624,7895160,0,0,16777215,16773822,16300216,16300248,16758527,16761855,13095423,10148607,8973816,8650717,12122296,16119980,16777136,16308472,0,0],this.makeTables(),this.setEmphasis(0)},makeTables:function(){for(var e,t,i,s,r,n,o,a,l=0;l<8;l++)for(n=1,o=1,a=1,0!==(1&l)&&(n=.75,a=.75),0!==(2&l)&&(n=.75,o=.75),0!==(4&l)&&(o=.75,a=.75),this.emphTable[l]=new Array(64),r=0;r<64;r++)s=this.curTable[r],e=Math.floor(this.getRed(s)*n),t=Math.floor(this.getGreen(s)*o),i=Math.floor(this.getBlue(s)*a),this.emphTable[l][r]=this.getRgb(e,t,i)},setEmphasis:function(e){if(e!==this.currentEmph){this.currentEmph=e;for(var t=0;t<64;t++)this.curTable[t]=this.emphTable[e][t]}},getEntry:function(e){return this.curTable[e]},getRed:function(e){return e>>16&255},getGreen:function(e){return e>>8&255},getBlue:function(e){return 255&e},getRgb:function(e,t,i){return e<<16|t<<8|i},loadDefaultPalette:function(){this.curTable[0]=this.getRgb(117,117,117),this.curTable[1]=this.getRgb(39,27,143),this.curTable[2]=this.getRgb(0,0,171),this.curTable[3]=this.getRgb(71,0,159),this.curTable[4]=this.getRgb(143,0,119),this.curTable[5]=this.getRgb(171,0,19),this.curTable[6]=this.getRgb(167,0,0),this.curTable[7]=this.getRgb(127,11,0),this.curTable[8]=this.getRgb(67,47,0),this.curTable[9]=this.getRgb(0,71,0),this.curTable[10]=this.getRgb(0,81,0),this.curTable[11]=this.getRgb(0,63,23),this.curTable[12]=this.getRgb(27,63,95),this.curTable[13]=this.getRgb(0,0,0),this.curTable[14]=this.getRgb(0,0,0),this.curTable[15]=this.getRgb(0,0,0),this.curTable[16]=this.getRgb(188,188,188),this.curTable[17]=this.getRgb(0,115,239),this.curTable[18]=this.getRgb(35,59,239),this.curTable[19]=this.getRgb(131,0,243),this.curTable[20]=this.getRgb(191,0,191),this.curTable[21]=this.getRgb(231,0,91),this.curTable[22]=this.getRgb(219,43,0),this.curTable[23]=this.getRgb(203,79,15),this.curTable[24]=this.getRgb(139,115,0),this.curTable[25]=this.getRgb(0,151,0),this.curTable[26]=this.getRgb(0,171,0),this.curTable[27]=this.getRgb(0,147,59),this.curTable[28]=this.getRgb(0,131,139),this.curTable[29]=this.getRgb(0,0,0),this.curTable[30]=this.getRgb(0,0,0),this.curTable[31]=this.getRgb(0,0,0),this.curTable[32]=this.getRgb(255,255,255),this.curTable[33]=this.getRgb(63,191,255),this.curTable[34]=this.getRgb(95,151,255),this.curTable[35]=this.getRgb(167,139,253),this.curTable[36]=this.getRgb(247,123,255),this.curTable[37]=this.getRgb(255,119,183),this.curTable[38]=this.getRgb(255,119,99),this.curTable[39]=this.getRgb(255,155,59),this.curTable[40]=this.getRgb(243,191,63),this.curTable[41]=this.getRgb(131,211,19),this.curTable[42]=this.getRgb(79,223,75),this.curTable[43]=this.getRgb(88,248,152),this.curTable[44]=this.getRgb(0,235,219),this.curTable[45]=this.getRgb(0,0,0),this.curTable[46]=this.getRgb(0,0,0),this.curTable[47]=this.getRgb(0,0,0),this.curTable[48]=this.getRgb(255,255,255),this.curTable[49]=this.getRgb(171,231,255),this.curTable[50]=this.getRgb(199,215,255),this.curTable[51]=this.getRgb(215,203,255),this.curTable[52]=this.getRgb(255,199,255),this.curTable[53]=this.getRgb(255,199,219),this.curTable[54]=this.getRgb(255,191,179),this.curTable[55]=this.getRgb(255,219,171),this.curTable[56]=this.getRgb(255,231,163),this.curTable[57]=this.getRgb(227,255,163),this.curTable[58]=this.getRgb(171,243,191),this.curTable[59]=this.getRgb(179,255,207),this.curTable[60]=this.getRgb(159,255,243),this.curTable[61]=this.getRgb(0,0,0),this.curTable[62]=this.getRgb(0,0,0),this.curTable[63]=this.getRgb(0,0,0),this.makeTables(),this.setEmphasis(0)}},e.exports=n;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(n,"PPU","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/jsnes/ppu.js"),__REACT_HOT_LOADER__.register(o,"NameTable","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/jsnes/ppu.js"),__REACT_HOT_LOADER__.register(a,"PaletteTable","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/jsnes/ppu.js"))})()},function(e,t){"use strict";var i=function(){this.pix=new Array(64),this.fbIndex=null,this.tIndex=null,this.x=null,this.y=null,this.w=null,this.h=null,this.incX=null,this.incY=null,this.palIndex=null,this.tpri=null,this.c=null,this.initialized=!1,this.opaque=new Array(8)};i.prototype={setBuffer:function(e){for(this.y=0;this.y<8;this.y++)this.setScanline(this.y,e[this.y],e[this.y+8])},setScanline:function(e,t,i){for(this.initialized=!0,this.tIndex=e<<3,this.x=0;this.x<8;this.x++)this.pix[this.tIndex+this.x]=(t>>7-this.x&1)+((i>>7-this.x&1)<<1),0===this.pix[this.tIndex+this.x]&&(this.opaque[e]=!1)},render:function(e,t,i,s,r,n,o,a,l,u,h,c,d){if(!(n<-7||n>=256||o<-7||o>=240))if(this.w=s-t,
this.h=r-i,n<0&&(t-=n),n+s>=256&&(s=256-n),o<0&&(i-=o),o+r>=240&&(r=240-o),u||h)if(u&&!h)for(this.fbIndex=(o<<8)+n,this.tIndex=7,this.y=0;this.y<8;this.y++){for(this.x=0;this.x<8;this.x++)this.x>=t&&this.x<s&&this.y>=i&&this.y<r&&(this.palIndex=this.pix[this.tIndex],this.tpri=d[this.fbIndex],0!==this.palIndex&&c<=(255&this.tpri)&&(e[this.fbIndex]=l[this.palIndex+a],this.tpri=3840&this.tpri|c,d[this.fbIndex]=this.tpri)),this.fbIndex++,this.tIndex--;this.fbIndex-=8,this.fbIndex+=256,this.tIndex+=16}else if(h&&!u)for(this.fbIndex=(o<<8)+n,this.tIndex=56,this.y=0;this.y<8;this.y++){for(this.x=0;this.x<8;this.x++)this.x>=t&&this.x<s&&this.y>=i&&this.y<r&&(this.palIndex=this.pix[this.tIndex],this.tpri=d[this.fbIndex],0!==this.palIndex&&c<=(255&this.tpri)&&(e[this.fbIndex]=l[this.palIndex+a],this.tpri=3840&this.tpri|c,d[this.fbIndex]=this.tpri)),this.fbIndex++,this.tIndex++;this.fbIndex-=8,this.fbIndex+=256,this.tIndex-=16}else for(this.fbIndex=(o<<8)+n,this.tIndex=63,this.y=0;this.y<8;this.y++){for(this.x=0;this.x<8;this.x++)this.x>=t&&this.x<s&&this.y>=i&&this.y<r&&(this.palIndex=this.pix[this.tIndex],this.tpri=d[this.fbIndex],0!==this.palIndex&&c<=(255&this.tpri)&&(e[this.fbIndex]=l[this.palIndex+a],this.tpri=3840&this.tpri|c,d[this.fbIndex]=this.tpri)),this.fbIndex++,this.tIndex--;this.fbIndex-=8,this.fbIndex+=256}else for(this.fbIndex=(o<<8)+n,this.tIndex=0,this.y=0;this.y<8;this.y++){for(this.x=0;this.x<8;this.x++)this.x>=t&&this.x<s&&this.y>=i&&this.y<r&&(this.palIndex=this.pix[this.tIndex],this.tpri=d[this.fbIndex],0!==this.palIndex&&c<=(255&this.tpri)&&(e[this.fbIndex]=l[this.palIndex+a],this.tpri=3840&this.tpri|c,d[this.fbIndex]=this.tpri)),this.fbIndex++,this.tIndex++;this.fbIndex-=8,this.fbIndex+=256}},isTransparent:function(e,t){return 0===this.pix[(t<<3)+e]},toJSON:function(){return{opaque:this.opaque,pix:this.pix}},fromJSON:function(e){this.opaque=e.opaque,this.pix=e.pix}},e.exports=i;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(i,"Tile","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/jsnes/tile.js")})()},function(e,t){"use strict";var i=1789772.5,s=function(e){this.nes=e,this.square1=new o(this,!0),this.square2=new o(this,!1),this.triangle=new a(this),this.noise=new n(this),this.dmc=new r(this),this.frameIrqCounter=null,this.frameIrqCounterMax=4,this.initCounter=2048,this.channelEnableValue=null,this.sampleRate=44100,this.lengthLookup=null,this.dmcFreqLookup=null,this.noiseWavelengthLookup=null,this.square_table=null,this.tnd_table=null,this.frameIrqEnabled=!1,this.frameIrqActive=null,this.frameClockNow=null,this.startedPlaying=!1,this.recordOutput=!1,this.initingHardware=!1,this.masterFrameCounter=null,this.derivedFrameCounter=null,this.countSequence=null,this.sampleTimer=null,this.frameTime=null,this.sampleTimerMax=null,this.sampleCount=null,this.triValue=0,this.smpSquare1=null,this.smpSquare2=null,this.smpTriangle=null,this.smpDmc=null,this.accCount=null,this.prevSampleL=0,this.prevSampleR=0,this.smpAccumL=0,this.smpAccumR=0,this.dacRange=0,this.dcValue=0,this.masterVolume=256,this.stereoPosLSquare1=null,this.stereoPosLSquare2=null,this.stereoPosLTriangle=null,this.stereoPosLNoise=null,this.stereoPosLDMC=null,this.stereoPosRSquare1=null,this.stereoPosRSquare2=null,this.stereoPosRTriangle=null,this.stereoPosRNoise=null,this.stereoPosRDMC=null,this.extraCycles=null,this.maxSample=null,this.minSample=null,this.panning=[80,170,100,150,128],this.setPanning(this.panning),this.initLengthLookup(),this.initDmcFrequencyLookup(),this.initNoiseWavelengthLookup(),this.initDACtables();for(var t=0;t<20;t++)16===t?this.writeReg(16400,16):this.writeReg(16384+t,0);this.reset()};s.prototype={reset:function(){this.sampleRate=this.nes.opts.sampleRate,this.sampleTimerMax=Math.floor(1024*i*this.nes.opts.preferredFrameRate/(60*this.sampleRate)),this.frameTime=Math.floor(14915*this.nes.opts.preferredFrameRate/60),this.sampleTimer=0,this.updateChannelEnable(0),this.masterFrameCounter=0,this.derivedFrameCounter=0,this.countSequence=0,this.sampleCount=0,this.initCounter=2048,this.frameIrqEnabled=!1,this.initingHardware=!1,this.resetCounter(),this.square1.reset(),this.square2.reset(),this.triangle.reset(),this.noise.reset(),this.dmc.reset(),this.accCount=0,this.smpSquare1=0,this.smpSquare2=0,this.smpTriangle=0,this.smpDmc=0,this.frameIrqEnabled=!1,this.frameIrqCounterMax=4,this.channelEnableValue=255,this.startedPlaying=!1,this.prevSampleL=0,this.prevSampleR=0,this.smpAccumL=0,this.smpAccumR=0,this.maxSample=-5e5,this.minSample=5e5},readReg:function(e){var t=0;return t|=this.square1.getLengthStatus(),t|=this.square2.getLengthStatus()<<1,t|=this.triangle.getLengthStatus()<<2,t|=this.noise.getLengthStatus()<<3,t|=this.dmc.getLengthStatus()<<4,t|=(this.frameIrqActive&&this.frameIrqEnabled?1:0)<<6,t|=this.dmc.getIrqStatus()<<7,this.frameIrqActive=!1,this.dmc.irqGenerated=!1,65535&t},writeReg:function(e,t){e>=16384&&e<16388?this.square1.writeReg(e,t):e>=16388&&e<16392?this.square2.writeReg(e,t):e>=16392&&e<16396?this.triangle.writeReg(e,t):e>=16396&&e<=16399?this.noise.writeReg(e,t):16400===e?this.dmc.writeReg(e,t):16401===e?this.dmc.writeReg(e,t):16402===e?this.dmc.writeReg(e,t):16403===e?this.dmc.writeReg(e,t):16405===e?(this.updateChannelEnable(t),0!==t&&this.initCounter>0&&(this.initingHardware=!0),this.dmc.writeReg(e,t)):16407===e&&(this.countSequence=t>>7&1,this.masterFrameCounter=0,this.frameIrqActive=!1,0===(t>>6&1)?this.frameIrqEnabled=!0:this.frameIrqEnabled=!1,0===this.countSequence?(this.frameIrqCounterMax=4,this.derivedFrameCounter=4):(this.frameIrqCounterMax=5,this.derivedFrameCounter=0,this.frameCounterTick()))},resetCounter:function(){0===this.countSequence?this.derivedFrameCounter=4:this.derivedFrameCounter=0},updateChannelEnable:function(e){this.channelEnableValue=65535&e,this.square1.setEnabled(0!==(1&e)),this.square2.setEnabled(0!==(2&e)),this.triangle.setEnabled(0!==(4&e)),this.noise.setEnabled(0!==(8&e)),this.dmc.setEnabled(0!==(16&e))},clockFrameCounter:function(e){if(this.initCounter>0&&this.initingHardware)return this.initCounter-=e,void(this.initCounter<=0&&(this.initingHardware=!1));e+=this.extraCycles;var t=this.sampleTimerMax-this.sampleTimer;e<<10>t?(this.extraCycles=(e<<10)-t>>10,e-=this.extraCycles):this.extraCycles=0;var i=this.dmc,s=this.triangle,r=this.square1,n=this.square2,o=this.noise;if(i.isEnabled)for(i.shiftCounter-=e<<3;i.shiftCounter<=0&&i.dmaFrequency>0;)i.shiftCounter+=i.dmaFrequency,i.clockDmc();if(s.progTimerMax>0)for(s.progTimerCount-=e;s.progTimerCount<=0;)s.progTimerCount+=s.progTimerMax+1,s.linearCounter>0&&s.lengthCounter>0&&(s.triangleCounter++,s.triangleCounter&=31,s.isEnabled&&(s.triangleCounter>=16?s.sampleValue=15&s.triangleCounter:s.sampleValue=15-(15&s.triangleCounter),s.sampleValue<<=4));r.progTimerCount-=e,r.progTimerCount<=0&&(r.progTimerCount+=r.progTimerMax+1<<1,r.squareCounter++,r.squareCounter&=7,r.updateSampleValue()),n.progTimerCount-=e,n.progTimerCount<=0&&(n.progTimerCount+=n.progTimerMax+1<<1,n.squareCounter++,n.squareCounter&=7,n.updateSampleValue());var a=e;if(o.progTimerCount-a>0)o.progTimerCount-=a,o.accCount+=a,o.accValue+=a*o.sampleValue;else for(;a-- >0;)--o.progTimerCount<=0&&o.progTimerMax>0&&(o.shiftReg<<=1,o.tmp=32768&(o.shiftReg<<(0===o.randomMode?1:6)^o.shiftReg),0!==o.tmp?(o.shiftReg|=1,o.randomBit=0,o.sampleValue=0):(o.randomBit=1,o.isEnabled&&o.lengthCounter>0?o.sampleValue=o.masterVolume:o.sampleValue=0),o.progTimerCount+=o.progTimerMax),o.accValue+=o.sampleValue,o.accCount++;this.frameIrqEnabled&&this.frameIrqActive&&this.nes.cpu.requestIrq(this.nes.cpu.IRQ_NORMAL),this.masterFrameCounter+=e<<1,this.masterFrameCounter>=this.frameTime&&(this.masterFrameCounter-=this.frameTime,this.frameCounterTick()),this.accSample(e),this.sampleTimer+=e<<10,this.sampleTimer>=this.sampleTimerMax&&(this.sample(),this.sampleTimer-=this.sampleTimerMax)},accSample:function(e){this.triangle.sampleCondition&&(this.triValue=Math.floor((this.triangle.progTimerCount<<4)/(this.triangle.progTimerMax+1)),this.triValue>16&&(this.triValue=16),this.triangle.triangleCounter>=16&&(this.triValue=16-this.triValue),this.triValue+=this.triangle.sampleValue),2===e?(this.smpTriangle+=this.triValue<<1,this.smpDmc+=this.dmc.sample<<1,this.smpSquare1+=this.square1.sampleValue<<1,this.smpSquare2+=this.square2.sampleValue<<1,this.accCount+=2):4===e?(this.smpTriangle+=this.triValue<<2,this.smpDmc+=this.dmc.sample<<2,this.smpSquare1+=this.square1.sampleValue<<2,this.smpSquare2+=this.square2.sampleValue<<2,this.accCount+=4):(this.smpTriangle+=e*this.triValue,this.smpDmc+=e*this.dmc.sample,this.smpSquare1+=e*this.square1.sampleValue,this.smpSquare2+=e*this.square2.sampleValue,this.accCount+=e)},frameCounterTick:function(){this.derivedFrameCounter++,this.derivedFrameCounter>=this.frameIrqCounterMax&&(this.derivedFrameCounter=0),1!==this.derivedFrameCounter&&3!==this.derivedFrameCounter||(this.triangle.clockLengthCounter(),this.square1.clockLengthCounter(),this.square2.clockLengthCounter(),this.noise.clockLengthCounter(),this.square1.clockSweep(),this.square2.clockSweep()),this.derivedFrameCounter>=0&&this.derivedFrameCounter<4&&(this.square1.clockEnvDecay(),this.square2.clockEnvDecay(),this.noise.clockEnvDecay(),this.triangle.clockLinearCounter()),3===this.derivedFrameCounter&&0===this.countSequence&&(this.frameIrqActive=!0)},sample:function(){var e,t;this.accCount>0?(this.smpSquare1<<=4,this.smpSquare1=Math.floor(this.smpSquare1/this.accCount),this.smpSquare2<<=4,this.smpSquare2=Math.floor(this.smpSquare2/this.accCount),this.smpTriangle=Math.floor(this.smpTriangle/this.accCount),this.smpDmc<<=4,this.smpDmc=Math.floor(this.smpDmc/this.accCount),this.accCount=0):(this.smpSquare1=this.square1.sampleValue<<4,this.smpSquare2=this.square2.sampleValue<<4,this.smpTriangle=this.triangle.sampleValue,this.smpDmc=this.dmc.sample<<4);var i=Math.floor((this.noise.accValue<<4)/this.noise.accCount);this.noise.accValue=i>>4,this.noise.accCount=1,e=this.smpSquare1*this.stereoPosLSquare1+this.smpSquare2*this.stereoPosLSquare2>>8,t=3*this.smpTriangle*this.stereoPosLTriangle+(i<<1)*this.stereoPosLNoise+this.smpDmc*this.stereoPosLDMC>>8,e>=this.square_table.length&&(e=this.square_table.length-1),t>=this.tnd_table.length&&(t=this.tnd_table.length-1);var s=this.square_table[e]+this.tnd_table[t]-this.dcValue;e=this.smpSquare1*this.stereoPosRSquare1+this.smpSquare2*this.stereoPosRSquare2>>8,t=3*this.smpTriangle*this.stereoPosRTriangle+(i<<1)*this.stereoPosRNoise+this.smpDmc*this.stereoPosRDMC>>8,e>=this.square_table.length&&(e=this.square_table.length-1),t>=this.tnd_table.length&&(t=this.tnd_table.length-1);var r=this.square_table[e]+this.tnd_table[t]-this.dcValue,n=s-this.prevSampleL;this.prevSampleL+=n,this.smpAccumL+=n-(this.smpAccumL>>10),s=this.smpAccumL;var o=r-this.prevSampleR;this.prevSampleR+=o,this.smpAccumR+=o-(this.smpAccumR>>10),r=this.smpAccumR,s>this.maxSample&&(this.maxSample=s),s<this.minSample&&(this.minSample=s),this.nes.opts.onAudioSample&&this.nes.opts.onAudioSample(s/32768,r/32768),this.smpSquare1=0,this.smpSquare2=0,this.smpTriangle=0,this.smpDmc=0},getLengthMax:function(e){return this.lengthLookup[e>>3]},getDmcFrequency:function(e){return e>=0&&e<16?this.dmcFreqLookup[e]:0},getNoiseWaveLength:function(e){return e>=0&&e<16?this.noiseWavelengthLookup[e]:0},setPanning:function(e){for(var t=0;t<5;t++)this.panning[t]=e[t];this.updateStereoPos()},setMasterVolume:function(e){e<0&&(e=0),e>256&&(e=256),this.masterVolume=e,this.updateStereoPos()},updateStereoPos:function(){this.stereoPosLSquare1=this.panning[0]*this.masterVolume>>8,this.stereoPosLSquare2=this.panning[1]*this.masterVolume>>8,this.stereoPosLTriangle=this.panning[2]*this.masterVolume>>8,this.stereoPosLNoise=this.panning[3]*this.masterVolume>>8,this.stereoPosLDMC=this.panning[4]*this.masterVolume>>8,this.stereoPosRSquare1=this.masterVolume-this.stereoPosLSquare1,this.stereoPosRSquare2=this.masterVolume-this.stereoPosLSquare2,this.stereoPosRTriangle=this.masterVolume-this.stereoPosLTriangle,this.stereoPosRNoise=this.masterVolume-this.stereoPosLNoise,this.stereoPosRDMC=this.masterVolume-this.stereoPosLDMC},initLengthLookup:function(){this.lengthLookup=[10,254,20,2,40,4,80,6,160,8,60,10,14,12,26,14,12,16,24,18,48,20,96,22,192,24,72,26,16,28,32,30]},initDmcFrequencyLookup:function(){this.dmcFreqLookup=new Array(16),this.dmcFreqLookup[0]=3424,this.dmcFreqLookup[1]=3040,this.dmcFreqLookup[2]=2720,this.dmcFreqLookup[3]=2560,this.dmcFreqLookup[4]=2288,this.dmcFreqLookup[5]=2032,this.dmcFreqLookup[6]=1808,this.dmcFreqLookup[7]=1712,this.dmcFreqLookup[8]=1520,this.dmcFreqLookup[9]=1280,this.dmcFreqLookup[10]=1136,this.dmcFreqLookup[11]=1024,this.dmcFreqLookup[12]=848,this.dmcFreqLookup[13]=672,this.dmcFreqLookup[14]=576,this.dmcFreqLookup[15]=432},initNoiseWavelengthLookup:function(){this.noiseWavelengthLookup=new Array(16),this.noiseWavelengthLookup[0]=4,this.noiseWavelengthLookup[1]=8,this.noiseWavelengthLookup[2]=16,this.noiseWavelengthLookup[3]=32,this.noiseWavelengthLookup[4]=64,this.noiseWavelengthLookup[5]=96,this.noiseWavelengthLookup[6]=128,this.noiseWavelengthLookup[7]=160,this.noiseWavelengthLookup[8]=202,this.noiseWavelengthLookup[9]=254,this.noiseWavelengthLookup[10]=380,this.noiseWavelengthLookup[11]=508,this.noiseWavelengthLookup[12]=762,this.noiseWavelengthLookup[13]=1016,this.noiseWavelengthLookup[14]=2034,this.noiseWavelengthLookup[15]=4068},initDACtables:function(){var e,t,i,s=0,r=0;for(this.square_table=new Array(512),this.tnd_table=new Array(3264),i=0;i<512;i++)e=95.52/(8128/(i/16)+100),e*=.98411,e*=5e4,t=Math.floor(e),this.square_table[i]=t,t>s&&(s=t);for(i=0;i<3264;i++)e=163.67/(24329/(i/16)+100),e*=.98411,e*=5e4,t=Math.floor(e),this.tnd_table[i]=t,t>r&&(r=t);this.dacRange=s+r,this.dcValue=this.dacRange/2}};var r=function(e){this.papu=e,this.MODE_NORMAL=0,this.MODE_LOOP=1,this.MODE_IRQ=2,this.isEnabled=null,this.hasSample=null,this.irqGenerated=!1,this.playMode=null,this.dmaFrequency=null,this.dmaCounter=null,this.deltaCounter=null,this.playStartAddress=null,this.playAddress=null,this.playLength=null,this.playLengthCounter=null,this.shiftCounter=null,this.reg4012=null,this.reg4013=null,this.sample=null,this.dacLsb=null,this.data=null,this.reset()};r.prototype={clockDmc:function(){this.hasSample&&(0===(1&this.data)?this.deltaCounter>0&&this.deltaCounter--:this.deltaCounter<63&&this.deltaCounter++,this.sample=this.isEnabled?(this.deltaCounter<<1)+this.dacLsb:0,this.data>>=1),this.dmaCounter--,this.dmaCounter<=0&&(this.hasSample=!1,this.endOfSample(),this.dmaCounter=8),this.irqGenerated&&this.papu.nes.cpu.requestIrq(this.papu.nes.cpu.IRQ_NORMAL)},endOfSample:function(){0===this.playLengthCounter&&this.playMode===this.MODE_LOOP&&(this.playAddress=this.playStartAddress,this.playLengthCounter=this.playLength),this.playLengthCounter>0&&(this.nextSample(),0===this.playLengthCounter&&this.playMode===this.MODE_IRQ&&(this.irqGenerated=!0))},nextSample:function(){this.data=this.papu.nes.mmap.load(this.playAddress),this.papu.nes.cpu.haltCycles(4),this.playLengthCounter--,this.playAddress++,this.playAddress>65535&&(this.playAddress=32768),this.hasSample=!0},writeReg:function(e,t){16400===e?(t>>6===0?this.playMode=this.MODE_NORMAL:1===(t>>6&1)?this.playMode=this.MODE_LOOP:t>>6===2&&(this.playMode=this.MODE_IRQ),0===(128&t)&&(this.irqGenerated=!1),this.dmaFrequency=this.papu.getDmcFrequency(15&t)):16401===e?(this.deltaCounter=t>>1&63,this.dacLsb=1&t,this.sample=(this.deltaCounter<<1)+this.dacLsb):16402===e?(this.playStartAddress=t<<6|49152,this.playAddress=this.playStartAddress,this.reg4012=t):16403===e?(this.playLength=(t<<4)+1,this.playLengthCounter=this.playLength,this.reg4013=t):16405===e&&(0===(t>>4&1)?this.playLengthCounter=0:(this.playAddress=this.playStartAddress,this.playLengthCounter=this.playLength),this.irqGenerated=!1)},setEnabled:function(e){!this.isEnabled&&e&&(this.playLengthCounter=this.playLength),this.isEnabled=e},getLengthStatus:function(){return 0!==this.playLengthCounter&&this.isEnabled?1:0},getIrqStatus:function(){return this.irqGenerated?1:0},reset:function(){this.isEnabled=!1,this.irqGenerated=!1,this.playMode=this.MODE_NORMAL,this.dmaFrequency=0,this.dmaCounter=0,this.deltaCounter=0,this.playStartAddress=0,this.playAddress=0,this.playLength=0,this.playLengthCounter=0,this.sample=0,this.dacLsb=0,this.shiftCounter=0,this.reg4012=0,this.reg4013=0,this.data=0}};var n=function(e){this.papu=e,this.isEnabled=null,this.envDecayDisable=null,this.envDecayLoopEnable=null,this.lengthCounterEnable=null,this.envReset=null,this.shiftNow=null,this.lengthCounter=null,this.progTimerCount=null,this.progTimerMax=null,this.envDecayRate=null,this.envDecayCounter=null,this.envVolume=null,this.masterVolume=null,this.shiftReg=16384,this.randomBit=null,this.randomMode=null,this.sampleValue=null,this.accValue=0,this.accCount=1,this.tmp=null,this.reset()};n.prototype={reset:function(){this.progTimerCount=0,this.progTimerMax=0,this.isEnabled=!1,this.lengthCounter=0,this.lengthCounterEnable=!1,this.envDecayDisable=!1,this.envDecayLoopEnable=!1,this.shiftNow=!1,this.envDecayRate=0,this.envDecayCounter=0,this.envVolume=0,this.masterVolume=0,this.shiftReg=1,this.randomBit=0,this.randomMode=0,this.sampleValue=0,this.tmp=0},clockLengthCounter:function(){this.lengthCounterEnable&&this.lengthCounter>0&&(this.lengthCounter--,0===this.lengthCounter&&this.updateSampleValue())},clockEnvDecay:function(){this.envReset?(this.envReset=!1,this.envDecayCounter=this.envDecayRate+1,this.envVolume=15):--this.envDecayCounter<=0&&(this.envDecayCounter=this.envDecayRate+1,this.envVolume>0?this.envVolume--:this.envVolume=this.envDecayLoopEnable?15:0),this.envDecayDisable?this.masterVolume=this.envDecayRate:this.masterVolume=this.envVolume,this.updateSampleValue()},updateSampleValue:function(){this.isEnabled&&this.lengthCounter>0&&(this.sampleValue=this.randomBit*this.masterVolume)},writeReg:function(e,t){16396===e?(this.envDecayDisable=0!==(16&t),this.envDecayRate=15&t,this.envDecayLoopEnable=0!==(32&t),this.lengthCounterEnable=0===(32&t),this.envDecayDisable?this.masterVolume=this.envDecayRate:this.masterVolume=this.envVolume):16398===e?(this.progTimerMax=this.papu.getNoiseWaveLength(15&t),this.randomMode=t>>7):16399===e&&(this.lengthCounter=this.papu.getLengthMax(248&t),this.envReset=!0)},setEnabled:function(e){this.isEnabled=e,e||(this.lengthCounter=0),this.updateSampleValue()},getLengthStatus:function(){return 0!==this.lengthCounter&&this.isEnabled?1:0}};var o=function(e,t){this.papu=e,this.dutyLookup=[0,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,1,1,1,0,0,0,1,0,0,1,1,1,1,1],this.impLookup=[1,-1,0,0,0,0,0,0,1,0,-1,0,0,0,0,0,1,0,0,0,-1,0,0,0,-1,0,1,0,0,0,0,0],this.sqr1=t,this.isEnabled=null,this.lengthCounterEnable=null,this.sweepActive=null,this.envDecayDisable=null,this.envDecayLoopEnable=null,this.envReset=null,this.sweepCarry=null,this.updateSweepPeriod=null,this.progTimerCount=null,this.progTimerMax=null,this.lengthCounter=null,this.squareCounter=null,this.sweepCounter=null,this.sweepCounterMax=null,this.sweepMode=null,this.sweepShiftAmount=null,this.envDecayRate=null,this.envDecayCounter=null,this.envVolume=null,this.masterVolume=null,this.dutyMode=null,this.sweepResult=null,this.sampleValue=null,this.vol=null,this.reset()};o.prototype={reset:function(){this.progTimerCount=0,this.progTimerMax=0,this.lengthCounter=0,this.squareCounter=0,this.sweepCounter=0,this.sweepCounterMax=0,this.sweepMode=0,this.sweepShiftAmount=0,this.envDecayRate=0,this.envDecayCounter=0,this.envVolume=0,this.masterVolume=0,this.dutyMode=0,this.vol=0,this.isEnabled=!1,this.lengthCounterEnable=!1,this.sweepActive=!1,this.sweepCarry=!1,this.envDecayDisable=!1,this.envDecayLoopEnable=!1},clockLengthCounter:function(){this.lengthCounterEnable&&this.lengthCounter>0&&(this.lengthCounter--,0===this.lengthCounter&&this.updateSampleValue())},clockEnvDecay:function(){this.envReset?(this.envReset=!1,this.envDecayCounter=this.envDecayRate+1,this.envVolume=15):--this.envDecayCounter<=0&&(this.envDecayCounter=this.envDecayRate+1,this.envVolume>0?this.envVolume--:this.envVolume=this.envDecayLoopEnable?15:0),this.envDecayDisable?this.masterVolume=this.envDecayRate:this.masterVolume=this.envVolume,this.updateSampleValue()},clockSweep:function(){--this.sweepCounter<=0&&(this.sweepCounter=this.sweepCounterMax+1,this.sweepActive&&this.sweepShiftAmount>0&&this.progTimerMax>7&&(this.sweepCarry=!1,0===this.sweepMode?(this.progTimerMax+=this.progTimerMax>>this.sweepShiftAmount,this.progTimerMax>4095&&(this.progTimerMax=4095,this.sweepCarry=!0)):this.progTimerMax=this.progTimerMax-((this.progTimerMax>>this.sweepShiftAmount)-(this.sqr1?1:0)))),this.updateSweepPeriod&&(this.updateSweepPeriod=!1,this.sweepCounter=this.sweepCounterMax+1)},updateSampleValue:function(){this.isEnabled&&this.lengthCounter>0&&this.progTimerMax>7?0===this.sweepMode&&this.progTimerMax+(this.progTimerMax>>this.sweepShiftAmount)>4095?this.sampleValue=0:this.sampleValue=this.masterVolume*this.dutyLookup[(this.dutyMode<<3)+this.squareCounter]:this.sampleValue=0},writeReg:function(e,t){var i=this.sqr1?0:4;e===16384+i?(this.envDecayDisable=0!==(16&t),this.envDecayRate=15&t,this.envDecayLoopEnable=0!==(32&t),this.dutyMode=t>>6&3,this.lengthCounterEnable=0===(32&t),this.envDecayDisable?this.masterVolume=this.envDecayRate:this.masterVolume=this.envVolume,this.updateSampleValue()):e===16385+i?(this.sweepActive=0!==(128&t),this.sweepCounterMax=t>>4&7,this.sweepMode=t>>3&1,this.sweepShiftAmount=7&t,this.updateSweepPeriod=!0):e===16386+i?(this.progTimerMax&=1792,this.progTimerMax|=t):e===16387+i&&(this.progTimerMax&=255,this.progTimerMax|=(7&t)<<8,this.isEnabled&&(this.lengthCounter=this.papu.getLengthMax(248&t)),this.envReset=!0)},setEnabled:function(e){this.isEnabled=e,e||(this.lengthCounter=0),this.updateSampleValue()},getLengthStatus:function(){return 0!==this.lengthCounter&&this.isEnabled?1:0}};var a=function(e){this.papu=e,this.isEnabled=null,this.sampleCondition=null,this.lengthCounterEnable=null,this.lcHalt=null,this.lcControl=null,this.progTimerCount=null,this.progTimerMax=null,this.triangleCounter=null,this.lengthCounter=null,this.linearCounter=null,this.lcLoadValue=null,this.sampleValue=null,this.tmp=null,this.reset()};a.prototype={reset:function(){this.progTimerCount=0,this.progTimerMax=0,this.triangleCounter=0,this.isEnabled=!1,this.sampleCondition=!1,this.lengthCounter=0,this.lengthCounterEnable=!1,this.linearCounter=0,this.lcLoadValue=0,this.lcHalt=!0,this.lcControl=!1,this.tmp=0,this.sampleValue=15},clockLengthCounter:function(){this.lengthCounterEnable&&this.lengthCounter>0&&(this.lengthCounter--,0===this.lengthCounter&&this.updateSampleCondition())},clockLinearCounter:function(){this.lcHalt?(this.linearCounter=this.lcLoadValue,this.updateSampleCondition()):this.linearCounter>0&&(this.linearCounter--,this.updateSampleCondition()),this.lcControl||(this.lcHalt=!1)},getLengthStatus:function(){return 0!==this.lengthCounter&&this.isEnabled?1:0},readReg:function(e){return 0},writeReg:function(e,t){16392===e?(this.lcControl=0!==(128&t),this.lcLoadValue=127&t,this.lengthCounterEnable=!this.lcControl):16394===e?(this.progTimerMax&=1792,this.progTimerMax|=t):16395===e&&(this.progTimerMax&=255,this.progTimerMax|=(7&t)<<8,this.lengthCounter=this.papu.getLengthMax(248&t),this.lcHalt=!0),this.updateSampleCondition()},clockProgrammableTimer:function(e){if(this.progTimerMax>0)for(this.progTimerCount+=e;this.progTimerMax>0&&this.progTimerCount>=this.progTimerMax;)this.progTimerCount-=this.progTimerMax,this.isEnabled&&this.lengthCounter>0&&this.linearCounter>0&&this.clockTriangleGenerator()},clockTriangleGenerator:function(){this.triangleCounter++,this.triangleCounter&=31},setEnabled:function(e){this.isEnabled=e,e||(this.lengthCounter=0),this.updateSampleCondition()},updateSampleCondition:function(){this.sampleCondition=this.isEnabled&&this.progTimerMax>7&&this.linearCounter>0&&this.lengthCounter>0}},e.exports=s;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(i,"CPU_FREQ_NTSC","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/jsnes/papu.js"),__REACT_HOT_LOADER__.register(s,"PAPU","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/jsnes/papu.js"),__REACT_HOT_LOADER__.register(r,"ChannelDM","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/jsnes/papu.js"),__REACT_HOT_LOADER__.register(n,"ChannelNoise","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/jsnes/papu.js"),__REACT_HOT_LOADER__.register(o,"ChannelSquare","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/jsnes/papu.js"),__REACT_HOT_LOADER__.register(a,"ChannelTriangle","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/jsnes/papu.js"))})()},function(e,t,i){"use strict";var s=i(337),r=i(334),n=function(e){this.nes=e,this.mapperName=new Array(92);for(var t=0;t<92;t++)this.mapperName[t]="Unknown Mapper";this.mapperName[0]="Direct Access",this.mapperName[1]="Nintendo MMC1",this.mapperName[2]="UNROM",this.mapperName[3]="CNROM",this.mapperName[4]="Nintendo MMC3",this.mapperName[5]="Nintendo MMC5",this.mapperName[6]="FFE F4xxx",this.mapperName[7]="AOROM",this.mapperName[8]="FFE F3xxx",this.mapperName[9]="Nintendo MMC2",this.mapperName[10]="Nintendo MMC4",this.mapperName[11]="Color Dreams Chip",this.mapperName[12]="FFE F6xxx",this.mapperName[15]="100-in-1 switch",this.mapperName[16]="Bandai chip",this.mapperName[17]="FFE F8xxx",this.mapperName[18]="Jaleco SS8806 chip",this.mapperName[19]="Namcot 106 chip",this.mapperName[20]="Famicom Disk System",this.mapperName[21]="Konami VRC4a",this.mapperName[22]="Konami VRC2a",this.mapperName[23]="Konami VRC2a",this.mapperName[24]="Konami VRC6",this.mapperName[25]="Konami VRC4b",this.mapperName[32]="Irem G-101 chip",this.mapperName[33]="Taito TC0190/TC0350",this.mapperName[34]="32kB ROM switch",this.mapperName[64]="Tengen RAMBO-1 chip",this.mapperName[65]="Irem H-3001 chip",this.mapperName[66]="GNROM switch",this.mapperName[67]="SunSoft3 chip",this.mapperName[68]="SunSoft4 chip",this.mapperName[69]="SunSoft5 FME-7 chip",this.mapperName[71]="Camerica chip",this.mapperName[78]="Irem 74HC161/32-based",this.mapperName[91]="Pirate HK-SF3 chip"};n.prototype={VERTICAL_MIRRORING:0,HORIZONTAL_MIRRORING:1,FOURSCREEN_MIRRORING:2,SINGLESCREEN_MIRRORING:3,SINGLESCREEN_MIRRORING2:4,SINGLESCREEN_MIRRORING3:5,SINGLESCREEN_MIRRORING4:6,CHRROM_MIRRORING:7,header:null,rom:null,vrom:null,vromTile:null,romCount:null,vromCount:null,mirroring:null,batteryRam:null,trainer:null,fourScreen:null,mapperType:null,valid:!1,load:function(e){var t,i,s;if(e.indexOf("NES")===-1)throw new Error("Not a valid NES ROM.");for(this.header=new Array(16),t=0;t<16;t++)this.header[t]=255&e.charCodeAt(t);this.romCount=this.header[4],this.vromCount=2*this.header[5],this.mirroring=0!==(1&this.header[6])?1:0,this.batteryRam=0!==(2&this.header[6]),this.trainer=0!==(4&this.header[6]),this.fourScreen=0!==(8&this.header[6]),this.mapperType=this.header[6]>>4|240&this.header[7];var n=!1;for(t=8;t<16;t++)if(0!==this.header[t]){n=!0;break}n&&(this.mapperType&=15),this.rom=new Array(this.romCount);var o=16;for(t=0;t<this.romCount;t++){for(this.rom[t]=new Array(16384),i=0;i<16384&&!(o+i>=e.length);i++)this.rom[t][i]=255&e.charCodeAt(o+i);o+=16384}for(this.vrom=new Array(this.vromCount),t=0;t<this.vromCount;t++){for(this.vrom[t]=new Array(4096),i=0;i<4096&&!(o+i>=e.length);i++)this.vrom[t][i]=255&e.charCodeAt(o+i);o+=4096}for(this.vromTile=new Array(this.vromCount),t=0;t<this.vromCount;t++)for(this.vromTile[t]=new Array(256),i=0;i<256;i++)this.vromTile[t][i]=new r;var a,l;for(s=0;s<this.vromCount;s++)for(t=0;t<4096;t++)a=t>>4,l=t%16,l<8?this.vromTile[s][a].setScanline(l,this.vrom[s][t],this.vrom[s][t+8]):this.vromTile[s][a].setScanline(l-8,this.vrom[s][t-8],this.vrom[s][t]);this.valid=!0},getMirroringType:function(){return this.fourScreen?this.FOURSCREEN_MIRRORING:0===this.mirroring?this.HORIZONTAL_MIRRORING:this.VERTICAL_MIRRORING},getMapperName:function(){return this.mapperType>=0&&this.mapperType<this.mapperName.length?this.mapperName[this.mapperType]:"Unknown Mapper, "+this.mapperType},mapperSupported:function(){return"undefined"!=typeof s[this.mapperType]},createMapper:function(){if(this.mapperSupported())return new s[this.mapperType](this.nes);throw new Error("This ROM uses a mapper not supported by JSNES: "+this.getMapperName()+"("+this.mapperType+")")}},e.exports=n;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(n,"ROM","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/jsnes/rom.js")})()},function(e,t,i){"use strict";var s=i(332),r={};r[0]=function(e){this.nes=e},r[0].prototype={reset:function(){this.joy1StrobeState=0,this.joy2StrobeState=0,this.joypadLastWrite=0,this.zapperFired=!1,this.zapperX=null,this.zapperY=null},write:function(e,t){e<8192?this.nes.cpu.mem[2047&e]=t:e>16407?this.nes.cpu.mem[e]=t:e>8199&&e<16384?this.regWrite(8192+(7&e),t):this.regWrite(e,t)},writelow:function(e,t){e<8192?this.nes.cpu.mem[2047&e]=t:e>16407?this.nes.cpu.mem[e]=t:e>8199&&e<16384?this.regWrite(8192+(7&e),t):this.regWrite(e,t)},load:function(e){return e&=65535,e>16407?this.nes.cpu.mem[e]:e>=8192?this.regLoad(e):this.nes.cpu.mem[2047&e]},regLoad:function(e){switch(e>>12){case 0:break;case 1:break;case 2:case 3:switch(7&e){case 0:return this.nes.cpu.mem[8192];case 1:return this.nes.cpu.mem[8193];case 2:return this.nes.ppu.readStatusRegister();case 3:return 0;case 4:return this.nes.ppu.sramLoad();case 5:return 0;case 6:return 0;case 7:return this.nes.ppu.vramLoad()}break;case 4:switch(e-16405){case 0:return this.nes.papu.readReg(e);case 1:return this.joy1Read();case 2:var t;return t=null!==this.zapperX&&null!==this.zapperY&&this.nes.ppu.isPixelWhite(this.zapperX,this.zapperY)?0:8,this.zapperFired&&(t|=16),65535&(this.joy2Read()|t)}}return 0},regWrite:function(e,t){switch(e){case 8192:this.nes.cpu.mem[e]=t,this.nes.ppu.updateControlReg1(t);break;case 8193:this.nes.cpu.mem[e]=t,this.nes.ppu.updateControlReg2(t);break;case 8195:this.nes.ppu.writeSRAMAddress(t);break;case 8196:this.nes.ppu.sramWrite(t);break;case 8197:this.nes.ppu.scrollWrite(t);break;case 8198:this.nes.ppu.writeVRAMAddress(t);break;case 8199:this.nes.ppu.vramWrite(t);break;case 16404:this.nes.ppu.sramDMA(t);break;case 16405:this.nes.papu.writeReg(e,t);break;case 16406:0===(1&t)&&1===(1&this.joypadLastWrite)&&(this.joy1StrobeState=0,this.joy2StrobeState=0),this.joypadLastWrite=t;break;case 16407:this.nes.papu.writeReg(e,t);break;default:e>=16384&&e<=16407&&this.nes.papu.writeReg(e,t)}},joy1Read:function(){var e;switch(this.joy1StrobeState){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:e=this.nes.controllers[1].state[this.joy1StrobeState];break;case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:e=0;break;case 19:e=1;break;default:e=0}return this.joy1StrobeState++,24===this.joy1StrobeState&&(this.joy1StrobeState=0),e},joy2Read:function(){var e;switch(this.joy2StrobeState){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:e=this.nes.controllers[2].state[this.joy2StrobeState];break;case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:e=0;break;case 19:e=1;break;default:e=0}return this.joy2StrobeState++,24===this.joy2StrobeState&&(this.joy2StrobeState=0),e},loadROM:function(){if(!this.nes.rom.valid||this.nes.rom.romCount<1)throw new Error("NoMapper: Invalid ROM! Unable to load.");this.loadPRGROM(),this.loadCHRROM(),this.loadBatteryRam(),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_RESET)},loadPRGROM:function(){this.nes.rom.romCount>1?(this.loadRomBank(0,32768),this.loadRomBank(1,49152)):(this.loadRomBank(0,32768),this.loadRomBank(0,49152))},loadCHRROM:function(){this.nes.rom.vromCount>0&&(1===this.nes.rom.vromCount?(this.loadVromBank(0,0),this.loadVromBank(0,4096)):(this.loadVromBank(0,0),this.loadVromBank(1,4096)))},loadBatteryRam:function(){if(this.nes.rom.batteryRam){
var e=this.nes.rom.batteryRam;null!==e&&8192===e.length&&s.copyArrayElements(e,0,this.nes.cpu.mem,24576,8192)}},loadRomBank:function(e,t){e%=this.nes.rom.romCount,s.copyArrayElements(this.nes.rom.rom[e],0,this.nes.cpu.mem,t,16384)},loadVromBank:function(e,t){if(0!==this.nes.rom.vromCount){this.nes.ppu.triggerRendering(),s.copyArrayElements(this.nes.rom.vrom[e%this.nes.rom.vromCount],0,this.nes.ppu.vramMem,t,4096);var i=this.nes.rom.vromTile[e%this.nes.rom.vromCount];s.copyArrayElements(i,0,this.nes.ppu.ptTile,t>>4,256)}},load32kRomBank:function(e,t){this.loadRomBank(2*e%this.nes.rom.romCount,t),this.loadRomBank((2*e+1)%this.nes.rom.romCount,t+16384)},load8kVromBank:function(e,t){0!==this.nes.rom.vromCount&&(this.nes.ppu.triggerRendering(),this.loadVromBank(e%this.nes.rom.vromCount,t),this.loadVromBank((e+1)%this.nes.rom.vromCount,t+4096))},load1kVromBank:function(e,t){if(0!==this.nes.rom.vromCount){this.nes.ppu.triggerRendering();var i=Math.floor(e/4)%this.nes.rom.vromCount,r=e%4*1024;s.copyArrayElements(this.nes.rom.vrom[i],0,this.nes.ppu.vramMem,r,1024);for(var n=this.nes.rom.vromTile[i],o=t>>4,a=0;a<64;a++)this.nes.ppu.ptTile[o+a]=n[(e%4<<6)+a]}},load2kVromBank:function(e,t){if(0!==this.nes.rom.vromCount){this.nes.ppu.triggerRendering();var i=Math.floor(e/2)%this.nes.rom.vromCount,r=e%2*2048;s.copyArrayElements(this.nes.rom.vrom[i],r,this.nes.ppu.vramMem,t,2048);for(var n=this.nes.rom.vromTile[i],o=t>>4,a=0;a<128;a++)this.nes.ppu.ptTile[o+a]=n[(e%2<<7)+a]}},load8kRomBank:function(e,t){var i=Math.floor(e/2)%this.nes.rom.romCount,r=e%2*8192;s.copyArrayElements(this.nes.rom.rom[i],r,this.nes.cpu.mem,t,8192)},clockIrqCounter:function(){},latchAccess:function(e){},toJSON:function(){return{joy1StrobeState:this.joy1StrobeState,joy2StrobeState:this.joy2StrobeState,joypadLastWrite:this.joypadLastWrite}},fromJSON:function(e){this.joy1StrobeState=e.joy1StrobeState,this.joy2StrobeState=e.joy2StrobeState,this.joypadLastWrite=e.joypadLastWrite}},r[1]=function(e){this.nes=e},r[1].prototype=new r[0],r[1].prototype.reset=function(){r[0].prototype.reset.apply(this),this.regBuffer=0,this.regBufferCounter=0,this.mirroring=0,this.oneScreenMirroring=0,this.prgSwitchingArea=1,this.prgSwitchingSize=1,this.vromSwitchingSize=0,this.romSelectionReg0=0,this.romSelectionReg1=0,this.romBankSelect=0},r[1].prototype.write=function(e,t){return e<32768?void r[0].prototype.write.apply(this,arguments):void(0!==(128&t)?(this.regBufferCounter=0,this.regBuffer=0,0===this.getRegNumber(e)&&(this.prgSwitchingArea=1,this.prgSwitchingSize=1)):(this.regBuffer=this.regBuffer&255-(1<<this.regBufferCounter)|(1&t)<<this.regBufferCounter,this.regBufferCounter++,5===this.regBufferCounter&&(this.setReg(this.getRegNumber(e),this.regBuffer),this.regBuffer=0,this.regBufferCounter=0)))},r[1].prototype.setReg=function(e,t){var i;switch(e){case 0:i=3&t,i!==this.mirroring&&(this.mirroring=i,0===(2&this.mirroring)?this.nes.ppu.setMirroring(this.nes.rom.SINGLESCREEN_MIRRORING):0!==(1&this.mirroring)?this.nes.ppu.setMirroring(this.nes.rom.HORIZONTAL_MIRRORING):this.nes.ppu.setMirroring(this.nes.rom.VERTICAL_MIRRORING)),this.prgSwitchingArea=t>>2&1,this.prgSwitchingSize=t>>3&1,this.vromSwitchingSize=t>>4&1;break;case 1:this.romSelectionReg0=t>>4&1,this.nes.rom.vromCount>0&&(0===this.vromSwitchingSize?0===this.romSelectionReg0?this.load8kVromBank(15&t,0):this.load8kVromBank(Math.floor(this.nes.rom.vromCount/2)+(15&t),0):0===this.romSelectionReg0?this.loadVromBank(15&t,0):this.loadVromBank(Math.floor(this.nes.rom.vromCount/2)+(15&t),0));break;case 2:this.romSelectionReg1=t>>4&1,this.nes.rom.vromCount>0&&1===this.vromSwitchingSize&&(0===this.romSelectionReg1?this.loadVromBank(15&t,4096):this.loadVromBank(Math.floor(this.nes.rom.vromCount/2)+(15&t),4096));break;default:i=15&t;var s,r=0;this.nes.rom.romCount>=32?0===this.vromSwitchingSize?1===this.romSelectionReg0&&(r=16):r=(this.romSelectionReg0|this.romSelectionReg1<<1)<<3:this.nes.rom.romCount>=16&&1===this.romSelectionReg0&&(r=8),0===this.prgSwitchingSize?(s=r+(15&t),this.load32kRomBank(s,32768)):(s=2*r+(15&t),0===this.prgSwitchingArea?this.loadRomBank(s,49152):this.loadRomBank(s,32768))}},r[1].prototype.getRegNumber=function(e){return e>=32768&&e<=40959?0:e>=40960&&e<=49151?1:e>=49152&&e<=57343?2:3},r[1].prototype.loadROM=function(){if(!this.nes.rom.valid)throw new Error("MMC1: Invalid ROM! Unable to load.");this.loadRomBank(0,32768),this.loadRomBank(this.nes.rom.romCount-1,49152),this.loadCHRROM(),this.loadBatteryRam(),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_RESET)},r[1].prototype.switchLowHighPrgRom=function(e){},r[1].prototype.switch16to32=function(){},r[1].prototype.switch32to16=function(){},r[1].prototype.toJSON=function(){var e=r[0].prototype.toJSON.apply(this);return e.mirroring=this.mirroring,e.oneScreenMirroring=this.oneScreenMirroring,e.prgSwitchingArea=this.prgSwitchingArea,e.prgSwitchingSize=this.prgSwitchingSize,e.vromSwitchingSize=this.vromSwitchingSize,e.romSelectionReg0=this.romSelectionReg0,e.romSelectionReg1=this.romSelectionReg1,e.romBankSelect=this.romBankSelect,e.regBuffer=this.regBuffer,e.regBufferCounter=this.regBufferCounter,e},r[1].prototype.fromJSON=function(e){r[0].prototype.fromJSON.apply(this,arguments),this.mirroring=e.mirroring,this.oneScreenMirroring=e.oneScreenMirroring,this.prgSwitchingArea=e.prgSwitchingArea,this.prgSwitchingSize=e.prgSwitchingSize,this.vromSwitchingSize=e.vromSwitchingSize,this.romSelectionReg0=e.romSelectionReg0,this.romSelectionReg1=e.romSelectionReg1,this.romBankSelect=e.romBankSelect,this.regBuffer=e.regBuffer,this.regBufferCounter=e.regBufferCounter},r[2]=function(e){this.nes=e},r[2].prototype=new r[0],r[2].prototype.write=function(e,t){return e<32768?void r[0].prototype.write.apply(this,arguments):void this.loadRomBank(t,32768)},r[2].prototype.loadROM=function(){if(!this.nes.rom.valid)throw new Error("UNROM: Invalid ROM! Unable to load.");this.loadRomBank(0,32768),this.loadRomBank(this.nes.rom.romCount-1,49152),this.loadCHRROM(),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_RESET)},r[3]=function(e){this.nes=e},r[3].prototype=new r[0],r[3].prototype.write=function(e,t){if(e<32768)return void r[0].prototype.write.apply(this,arguments);var i=t%(this.nes.rom.vromCount/2)*2;this.loadVromBank(i,0),this.loadVromBank(i+1,4096),this.load8kVromBank(2*t,0)},r[4]=function(e){this.nes=e,this.CMD_SEL_2_1K_VROM_0000=0,this.CMD_SEL_2_1K_VROM_0800=1,this.CMD_SEL_1K_VROM_1000=2,this.CMD_SEL_1K_VROM_1400=3,this.CMD_SEL_1K_VROM_1800=4,this.CMD_SEL_1K_VROM_1C00=5,this.CMD_SEL_ROM_PAGE1=6,this.CMD_SEL_ROM_PAGE2=7,this.command=null,this.prgAddressSelect=null,this.chrAddressSelect=null,this.pageNumber=null,this.irqCounter=null,this.irqLatchValue=null,this.irqEnable=null,this.prgAddressChanged=!1},r[4].prototype=new r[0],r[4].prototype.write=function(e,t){if(e<32768)return void r[0].prototype.write.apply(this,arguments);switch(e){case 32768:this.command=7&t;var i=t>>6&1;i!==this.prgAddressSelect&&(this.prgAddressChanged=!0),this.prgAddressSelect=i,this.chrAddressSelect=t>>7&1;break;case 32769:this.executeCommand(this.command,t);break;case 40960:0!==(1&t)?this.nes.ppu.setMirroring(this.nes.rom.HORIZONTAL_MIRRORING):this.nes.ppu.setMirroring(this.nes.rom.VERTICAL_MIRRORING);break;case 40961:break;case 49152:this.irqCounter=t;break;case 49153:this.irqLatchValue=t;break;case 57344:this.irqEnable=0;break;case 57345:this.irqEnable=1}},r[4].prototype.executeCommand=function(e,t){switch(e){case this.CMD_SEL_2_1K_VROM_0000:0===this.chrAddressSelect?(this.load1kVromBank(t,0),this.load1kVromBank(t+1,1024)):(this.load1kVromBank(t,4096),this.load1kVromBank(t+1,5120));break;case this.CMD_SEL_2_1K_VROM_0800:0===this.chrAddressSelect?(this.load1kVromBank(t,2048),this.load1kVromBank(t+1,3072)):(this.load1kVromBank(t,6144),this.load1kVromBank(t+1,7168));break;case this.CMD_SEL_1K_VROM_1000:0===this.chrAddressSelect?this.load1kVromBank(t,4096):this.load1kVromBank(t,0);break;case this.CMD_SEL_1K_VROM_1400:0===this.chrAddressSelect?this.load1kVromBank(t,5120):this.load1kVromBank(t,1024);break;case this.CMD_SEL_1K_VROM_1800:0===this.chrAddressSelect?this.load1kVromBank(t,6144):this.load1kVromBank(t,2048);break;case this.CMD_SEL_1K_VROM_1C00:0===this.chrAddressSelect?this.load1kVromBank(t,7168):this.load1kVromBank(t,3072);break;case this.CMD_SEL_ROM_PAGE1:this.prgAddressChanged&&(0===this.prgAddressSelect?this.load8kRomBank(2*(this.nes.rom.romCount-1),49152):this.load8kRomBank(2*(this.nes.rom.romCount-1),32768),this.prgAddressChanged=!1),0===this.prgAddressSelect?this.load8kRomBank(t,32768):this.load8kRomBank(t,49152);break;case this.CMD_SEL_ROM_PAGE2:this.load8kRomBank(t,40960),this.prgAddressChanged&&(0===this.prgAddressSelect?this.load8kRomBank(2*(this.nes.rom.romCount-1),49152):this.load8kRomBank(2*(this.nes.rom.romCount-1),32768),this.prgAddressChanged=!1)}},r[4].prototype.loadROM=function(){if(!this.nes.rom.valid)throw new Error("MMC3: Invalid ROM! Unable to load.");this.load8kRomBank(2*(this.nes.rom.romCount-1),49152),this.load8kRomBank(2*(this.nes.rom.romCount-1)+1,57344),this.load8kRomBank(0,32768),this.load8kRomBank(1,40960),this.loadCHRROM(),this.loadBatteryRam(),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_RESET)},r[4].prototype.clockIrqCounter=function(){1===this.irqEnable&&(this.irqCounter--,this.irqCounter<0&&(this.nes.cpu.requestIrq(this.nes.cpu.IRQ_NORMAL),this.irqCounter=this.irqLatchValue))},r[4].prototype.toJSON=function(){var e=r[0].prototype.toJSON.apply(this);return e.command=this.command,e.prgAddressSelect=this.prgAddressSelect,e.chrAddressSelect=this.chrAddressSelect,e.pageNumber=this.pageNumber,e.irqCounter=this.irqCounter,e.irqLatchValue=this.irqLatchValue,e.irqEnable=this.irqEnable,e.prgAddressChanged=this.prgAddressChanged,e},r[4].prototype.fromJSON=function(e){r[0].prototype.fromJSON.apply(this,arguments),this.command=e.command,this.prgAddressSelect=e.prgAddressSelect,this.chrAddressSelect=e.chrAddressSelect,this.pageNumber=e.pageNumber,this.irqCounter=e.irqCounter,this.irqLatchValue=e.irqLatchValue,this.irqEnable=e.irqEnable,this.prgAddressChanged=e.prgAddressChanged},r[5]=function(e){this.nes=e},r[5].prototype=new r[0],r[5].prototype.write=function(e,t){e<32768?r[0].prototype.write.apply(this,arguments):this.load8kVromBank(t,0)},r[5].prototype.write=function(e,t){if(e<20480)return void r[0].prototype.write.apply(this,arguments);switch(e){case 20736:this.prg_size=3&t;break;case 20737:this.chr_size=3&t;break;case 20738:this.sram_we_a=3&t;break;case 20739:this.sram_we_b=3&t;break;case 20740:this.graphic_mode=3&t;break;case 20741:this.nametable_mode=t,this.nametable_type[0]=3&t,this.load1kVromBank(3&t,8192),t>>=2,this.nametable_type[1]=3&t,this.load1kVromBank(3&t,9216),t>>=2,this.nametable_type[2]=3&t,this.load1kVromBank(3&t,10240),t>>=2,this.nametable_type[3]=3&t,this.load1kVromBank(3&t,11264);break;case 20742:this.fill_chr=t;break;case 20743:this.fill_pal=3&t;break;case 20755:this.SetBank_SRAM(3,3&t);break;case 20756:case 20757:case 20758:case 20759:this.SetBank_CPU(e,t);break;case 20768:case 20769:case 20770:case 20771:case 20772:case 20773:case 20774:case 20775:this.chr_mode=0,this.chr_page[0][7&e]=t,this.SetBank_PPU();break;case 20776:case 20777:case 20778:case 20779:this.chr_mode=1,this.chr_page[1][(3&e)+0]=t,this.chr_page[1][(3&e)+4]=t,this.SetBank_PPU();break;case 20992:this.split_control=t;break;case 20993:this.split_scroll=t;break;case 20994:this.split_page=63&t;break;case 20995:this.irq_line=t,this.nes.cpu.ClearIRQ();break;case 20996:this.irq_enable=t,this.nes.cpu.ClearIRQ();break;case 20997:this.mult_a=t;break;case 20998:this.mult_b=t;break;default:e>=20480&&e<=20501?this.nes.papu.exWrite(e,t):e>=23552&&e<=24575?2===this.graphic_mode||3!==this.graphic_mode&&64&this.irq_status:e>=24576&&e<=32767&&2===this.sram_we_a&&1===this.sram_we_b}},r[5].prototype.loadROM=function(){if(!this.nes.rom.valid)throw new Error("UNROM: Invalid ROM! Unable to load.");this.load8kRomBank(2*this.nes.rom.romCount-1,32768),this.load8kRomBank(2*this.nes.rom.romCount-1,40960),this.load8kRomBank(2*this.nes.rom.romCount-1,49152),this.load8kRomBank(2*this.nes.rom.romCount-1,57344),this.loadCHRROM(),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_RESET)},r[7]=function(e){this.nes=e},r[7].prototype=new r[0],r[7].prototype.write=function(e,t){e<32768?r[0].prototype.write.apply(this,arguments):(this.load32kRomBank(7&t,32768),16&t?this.nes.ppu.setMirroring(this.nes.rom.SINGLESCREEN_MIRRORING2):this.nes.ppu.setMirroring(this.nes.rom.SINGLESCREEN_MIRRORING))},r[7].prototype.loadROM=function(){if(!this.nes.rom.valid)throw new Error("AOROM: Invalid ROM! Unable to load.");this.loadPRGROM(),this.loadCHRROM(),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_RESET)},r[11]=function(e){this.nes=e},r[11].prototype=new r[0],r[11].prototype.write=function(e,t){if(e<32768)return void r[0].prototype.write.apply(this,arguments);var i=2*(15&t)%this.nes.rom.romCount,s=(2*(15&t)+1)%this.nes.rom.romCount;if(this.loadRomBank(i,32768),this.loadRomBank(s,49152),this.nes.rom.vromCount>0){var n=2*(t>>4)%this.nes.rom.vromCount;this.loadVromBank(n,0),this.loadVromBank(n+1,4096)}},r[34]=function(e){this.nes=e},r[34].prototype=new r[0],r[34].prototype.write=function(e,t){return e<32768?void r[0].prototype.write.apply(this,arguments):void this.load32kRomBank(t,32768)},r[66]=function(e){this.nes=e,console.log("Mapper 66")},r[66].prototype=new r[0],r[66].prototype.write=function(e,t){return e<32768?void r[0].prototype.write.apply(this,arguments):(this.load32kRomBank(t>>4&3,32768),void this.load8kVromBank(2*(3&t),0))},e.exports=r;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(r,"Mappers","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/jsnes/mappers.js")})()},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),l=i(1),u=s(l),h=(i(166),i(272)),c=s(h),d=i(281),p=s(d),f=i(339),m=s(f),_=i(340),g=s(_),b=i(341),R=s(b),E=function(e){function t(e){r(this,t);var i=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.frameInterval=null,i.state={frameCount:0},i.delay=5,i.localLog=[],i.send=null,i.receivedLog=new Array(i.props.room.player_count),i.checkPeerCoonInterval=null,i}return o(t,e),a(t,[{key:"addOperation",value:function(e,t){this.localLog.push(g.default.encode(this.state.frameCount+this.delay,this.props.id_in_room,e,t))}},{key:"action",value:function(e){if(e!=-1){var t=(g.default.frameCount(e),g.default.id(e)),i=g.default.command(e),s=g.default.state(e);i>=g.default.COMMAND_BUTTON_BEGIN&&i<=g.default.COMMAND_BUTTON_END&&(s?this.props.nes.buttonDown(t+1,i):this.props.nes.buttonUp(t+1,i),console.log("user "+this.props.id_in_room+" "+i+" "+s+" in"+this.state.frameCount))}}},{key:"componentWillMount",value:function(){var e=this;p.default.addOnmessage("protocolSwitch",function(t){e.props.addMsg(c.default.MSG_FROM_SYSTEM,"p2p连接失败, 自动调整为websocket模式"),null!=e.checkPeerCoonInterval&&clearInterval(e.checkPeerCoonInterval),p.default.addOnmessage("operation",function(t){e.receivedLog[t.id][t.frameCount-e.state.frameCount]=t.operation}),e.send=p.default.send,e.start()})}},{key:"componentDidMount",value:function(){var e=this;this.props.addMsg(c.default.MSG_FROM_SYSTEM,"正在尝试p2p连接，请等待"),window.receivedLog=this.receivedLog;for(var t=0;t<this.props.room.player_count;t++){this.receivedLog[t]=new Array(this.delay);for(var i=0;i<this.delay;i++)this.receivedLog[t][i]=new Array(0)}try{var s=new R.default(this.props.id_in_room,function(t){"operation"==t.type&&(e.receivedLog[t.id][t.frameCount-e.state.frameCount]=t.operation)});window.pc=s;var r=0;this.checkPeerCoonInterval=setInterval(function(){var t=s.getState();return r<10&&t==R.default.CONNECTING?void r++:void(t==R.default.CONNECTED?(e.props.addMsg(c.default.MSG_FROM_SYSTEM,"p2p连接成功"),e.send=function(e){s.dataChannel.send(JSON.stringify(e))},e.start(),clearInterval(e.checkPeerCoonInterval)):p.default.send({type:"protocolSwitch",protocol:"websocket"}))},500)}catch(e){p.default.send({type:"protocolSwitch",protocol:"websocket"})}}},{key:"start",value:function(){var e=this,t=0;this.frameInterval=setInterval(function(){if(e.props.isRunning){for(var i=0;i<e.props.room.player_count;i++)if("undefined"==typeof e.receivedLog[i][0])return t++,void(t>=60&&(t-=60,e.props.addMsg(c.default.MSG_FROM_SYSTEM,"正在等待玩家"+(i+1)+"的指令传输")));t=0,e.receivedLog[e.props.id_in_room][e.delay]=e.localLog;for(var i=0;i<e.props.room.player_count;i++){for(var s=0;s<e.receivedLog[i][0].length;s++)e.action(e.receivedLog[i][0][s]);e.receivedLog[i].shift()}e.props.nes.frame(),e.send({type:"operation",id:e.props.id_in_room,frameCount:e.state.frameCount+e.delay,operation:e.localLog}),e.localLog=[],e.setState({frameCount:e.state.frameCount+1})}},1e3/60)}},{key:"componentWillUnmount",value:function(){p.default.removeOnmessage("protocolSwitch"),p.default.removeOnmessage("operaion"),clearInterval(this.frameInterval)}},{key:"render",value:function(){return u.default.createElement(m.default,{id_in_room:this.state.id_in_room,controller:this.props.controller,nes:this.props.nes,keyboard:this.props.keyboard,addOperation:this.addOperation.bind(this)})}}]),t}(u.default.Component),y=E;t.default=y;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(E,"Emulator","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/InGame/OnLine/Emulator.jsx"),__REACT_HOT_LOADER__.register(y,"default","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/InGame/OnLine/Emulator.jsx"))})()},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),l=i(1),u=s(l),h=(i(166),i(328)),c=(s(h),i(281)),d=(s(c),i(272)),p=(s(d),i(340)),f=s(p),m=function(e){function t(e){return r(this,t),n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return o(t,e),a(t,[{key:"keyboardLog",value:function(){}},{key:"operationEncode",value:function(e,t){return f.default.encode(this.props.frameCount,this.props.id_in_room,e,t)}},{key:"keyupListener",value:function(e){var t=(this.props.nes,this.props.keyboard);switch(e.keyCode){case t.A:this.props.addOperation(f.default.COMMAND_BUTTON_A,f.default.STATE_UNSET);break;case t.B:this.props.addOperation(f.default.COMMAND_BUTTON_B,f.default.STATE_UNSET);break;case t.select:this.props.addOperation(f.default.COMMAND_BUTTON_SELECT,f.default.STATE_UNSET);break;case t.start:this.props.addOperation(f.default.COMMAND_BUTTON_START,f.default.STATE_UNSET);break;case t.up:this.props.addOperation(f.default.COMMAND_BUTTON_UP,f.default.STATE_UNSET);break;case t.down:this.props.addOperation(f.default.COMMAND_BUTTON_DOWN,f.default.STATE_UNSET);break;case t.left:this.props.addOperation(f.default.COMMAND_BUTTON_LEFT,f.default.STATE_UNSET);break;case t.right:this.props.addOperation(f.default.COMMAND_BUTTON_RIGHT,f.default.STATE_UNSET)}}},{key:"keydownListener",value:function(e){var t=(this.props.nes,this.props.keyboard);switch(e.keyCode){case t.A:this.props.addOperation(f.default.COMMAND_BUTTON_A,f.default.STATE_SET);break;case t.B:this.props.addOperation(f.default.COMMAND_BUTTON_B,f.default.STATE_SET);break;case t.select:this.props.addOperation(f.default.COMMAND_BUTTON_SELECT,f.default.STATE_SET);break;case t.start:this.props.addOperation(f.default.COMMAND_BUTTON_START,f.default.STATE_SET);break;case t.up:this.props.addOperation(f.default.COMMAND_BUTTON_UP,f.default.STATE_SET);break;case t.down:this.props.addOperation(f.default.COMMAND_BUTTON_DOWN,f.default.STATE_SET);break;case t.left:this.props.addOperation(f.default.COMMAND_BUTTON_LEFT,f.default.STATE_SET);break;case t.right:this.props.addOperation(f.default.COMMAND_BUTTON_RIGHT,f.default.STATE_SET)}}},{key:"componentDidMount",value:function(){document.getElementById("window").addEventListener("keyup",this.keyupListener.bind(this)),document.getElementById("window").addEventListener("keydown",this.keydownListener.bind(this))}},{key:"componentWillUnmount",value:function(){document.getElementById("window").removeEventListener("keyup",this.keyupListener),document.getElementById("window").removeEventListener("keydown",this.keydownListener)}},{key:"render",value:function(){return u.default.createElement("div",null)}}]),t}(u.default.Component),_=m;t.default=_;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(m,"Controller","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/InGame/OnLine/Controller.jsx"),__REACT_HOT_LOADER__.register(_,"default","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/InGame/OnLine/Controller.jsx"))})()},function(e,t){"use strict";t.COMMAND_BUTTON_BEGIN=0,t.COMMAND_BUTTON_A=0,t.COMMAND_BUTTON_B=1,t.COMMAND_BUTTON_SELECT=2,t.COMMAND_BUTTON_START=3,t.COMMAND_BUTTON_UP=4,t.COMMAND_BUTTON_DOWN=5,t.COMMAND_BUTTON_LEFT=6,t.COMMAND_BUTTON_RIGHT=7,t.COMMAND_BUTTON_X=8,t.COMMAND_BUTTON_Y=9,t.COMMAND_BUTTON_END=9,t.COMMAND_SOUND=12,t.COMMAND_STOPGAME=13,t.COMMAND_RESTART=14,t.COMMAND_ENDGAME=15,t.STATE_SET=1,t.STATE_UNSET=0,t.encode=function(e,t,i,s){return e<<8|t<<5|i<<1|s},t.frameCount=function(e){return e>>8},t.id=function(e){return e>>5&7},t.command=function(e){return e>>1&15},t.state=function(e){return 1&e};(function(){"undefined"==typeof __REACT_HOT_LOADER__})()},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}var r=i(281),n=s(r),o=function(e,t){var i=this,s=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;this.pc=new s({iceServers:[{url:"stun:stun.l.google.com:19302"}]}),this.dataChannel=null,this.pc.onicecandidate=function(e){n.default.send({type:"__ice_candidate",candidate:e.candidate})},n.default.addOnmessage("__ice_candidate",function(e){if(console.log(e),null!=e.candidate){var t=new RTCIceCandidate(e.candidate);i.pc.addIceCandidate(t)}}),0==e?(this.dataChannel=this.pc.createDataChannel("keyboard"),console.log("createDataChannel"),this.pc.createOffer().then(function(e){return i.pc.setLocalDescription(e)}).then(function(){n.default.send({type:"__offer",sdp:i.pc.localDescription})}),this.dataChannel.onopen=function(e){console.log("dataChannel open")},this.dataChannel.onmessage=function(e){t(JSON.parse(e.data))},this.dataChannel.onclose=function(e){console.log("dataChannel closed")},n.default.addOnmessage("__answer",function(e){var t=new RTCSessionDescription(e.sdp);i.pc.setRemoteDescription(t)})):(n.default.addOnmessage("__offer",function(e){var t=new RTCSessionDescription(e.sdp);i.pc.setRemoteDescription(t),i.pc.createAnswer().then(function(e){return i.pc.setLocalDescription(e)}).then(function(){n.default.send({type:"__answer",sdp:i.pc.localDescription})})}),console.log("ondatachannel"),this.pc.ondatachannel=function(e){i.dataChannel=e.channel,i.dataChannel.onopen=function(e){console.log("receiveChannel start")},i.dataChannel.onmessage=function(e){t(JSON.parse(e.data))},i.dataChannel.onclose=function(e){console.log("receiveChannel closed")}})};o.CONNECTED=0,o.CONNECTING=1,o.FAILED=2,o.prototype={getState:function(){var e=this.pc.iceConnectionState;return"completed"!=e&&"connected"!=e||"open"!=this.dataChannel.readyState?"failed"==e||"closed"==e?o.FAILED:o.CONNECTING:o.CONNECTED},close:function(){this.dataChannel.close(),this.pc.close()}},e.exports=o;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(o,"peerConnection","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/InGame/OnLine/peerConnection.js")})()},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),l=i(1),u=s(l);i(343);var h=function(e){function t(e){r(this,t);var i=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.state={time:0},i}return o(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this;this.interval=setInterval(function(){e.setState({time:e.state.time+1})},1e3)}},{key:"render",value:function(){var e=parseInt(this.state.time%60);e<10&&(e="0"+e);var t=parseInt(this.state.time/60%60);t<10&&(t="0"+t);var i=parseInt(this.state.time/3600);i<10&&(i="0"+i);var s=i+":"+t+":"+e;return u.default.createElement("input",{type:"text",value:s,className:"Timer",disabled:!0})}}]),t}(u.default.Component),c=h;t.default=c;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(h,"Timer","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/InGame/Timer.jsx"),__REACT_HOT_LOADER__.register(c,"default","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/InGame/Timer.jsx"))})()},function(e,t,i){var s=i(344);"string"==typeof s&&(s=[[e.id,s,""]]);i(260)(s,{});s.locals&&(e.exports=s.locals)},function(e,t,i){t=e.exports=i(259)(),t.push([e.id,".Timer{background:#000;border:2px solid #293232;border-radius:7px;color:#fff;left:40%;width:20%;height:28px;margin:1px 0;font-size:16px;line-height:22px;outline:0;text-align:center;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}",""])},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),l=i(1),u=s(l);i(166);i(346);var h=i(281),c=s(h),d=i(272),p=s(d),f=i(298),m=(s(f),i(280),function(e){function t(e){r(this,t);var i=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.state={hide:!0},i}return o(t,e),a(t,[{key:"chatBox",value:function(e){13==e.keyCode&&(this.setState({hide:!this.state.hide}),this.state.hide||this.refs.chat.focus())}},{key:"componentDidMount",value:function(){document.addEventListener("keyup",this.chatBox.bind(this))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keyup",this.chatBox.bind(this))}},{key:"enter",value:function(e){if(13==e.keyCode){var t=this.refs.chat.value;""!=t&&(c.default.send({type:"roomMsg",msg:t}),this.refs.chat.value=""),this.setState({chatHide:!0}),document.getElementById("window").focus()}}},{key:"render",value:function(){return u.default.createElement("div",{className:"Chat"},u.default.createElement("div",{className:"chatHistory"},this.props.msg.map(function(e,t){return u.default.createElement("div",{className:"list",key:t},u.default.createElement("span",{style:{color:e.from==p.default.MSG_FROM_SYSTEM?"red":"green"}},"[",e.from,"]: "),u.default.createElement("span",{style:{color:"white"}},e.msg))})),this.state.hide?u.default.createElement("div",null):u.default.createElement("div",{className:"chatBox"},u.default.createElement("div",{className:"chatInfo"},"发送消息："),u.default.createElement("input",{type:"text",className:"chat",ref:"chat",onKeyUp:this.enter.bind(this)})))}}]),t}(u.default.Component)),_=m;t.default=_;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(m,"Chat","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/InGame/Chat.jsx"),__REACT_HOT_LOADER__.register(_,"default","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/InGame/Chat.jsx"))})()},function(e,t,i){var s=i(347);"string"==typeof s&&(s=[[e.id,s,""]]);i(260)(s,{});s.locals&&(e.exports=s.locals)},function(e,t,i){t=e.exports=i(259)(),t.push([e.id,".Chat>.chatHistory{position:absolute;bottom:200px;left:10px;width:90%;z-index:1000}.Chat>.chatBox{z-index:100;position:fixed;bottom:120px;left:25%;width:50%;height:30px;line-height:30px;opacity:.9}.Chat>.chatBox>.chatInfo{position:absolute;z-index:100;left:7px;color:#efc41d;font-size:16px}.Chat>.chatBox>.chat{position:absolute;font-size:16px;z-index:1;width:100%;height:100%;outline:0;background:#161b1f;border:1px solid #efc41d;border-radius:4px;color:#dfdfdf;padding:2px 2px 2px 85px;text-align:left;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}",""])},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){return{game:e.game}}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),
Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),u=i(1),h=s(u),c=i(166);i(349);var d=i(281),p=(s(d),i(272)),f=s(p),m=i(280),_=function(e){function t(e){return r(this,t),n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return o(t,e),l(t,[{key:"render",value:function(){var e=this,t=[];for(var i in this.props.room.players)if(null!=this.props.room.players[i]){var s=this.props.room.players[i].name,r=this.props.room.players[i].avatar,n=this.props.room.players[i].state_in_room;this.props.room.host_id;t.push(h.default.createElement("tbody",{key:i},h.default.createElement("tr",null,h.default.createElement("td",null,h.default.createElement("span",null,"玩家",parseInt(i)+1)),h.default.createElement("td",{style:{textAlign:"center"}},h.default.createElement("img",{className:"gameTabAvatar",src:r})),h.default.createElement("td",null,h.default.createElement("span",null,s)),h.default.createElement("td",null,h.default.createElement("span",null,f.default.ROOM_PLAYER_STATE_TEXT[n])))))}return h.default.createElement("div",{className:"Room-InGame-Tab Players"},h.default.createElement("div",{className:"window"},h.default.createElement("div",{style:{textAlign:"center"}},"玩家列表"),h.default.createElement("table",{style:{width:"100%"}},h.default.createElement("thead",null,h.default.createElement("tr",null,h.default.createElement("td",{width:"50px"}),h.default.createElement("td",{width:"50px"}),h.default.createElement("td",{width:"auto"}),h.default.createElement("td",{width:"50px"}))),t),h.default.createElement("div",{className:"exitButtons"},h.default.createElement("button",{onClick:function(){e.props.closeTab()}},"确定"),h.default.createElement("button",{onClick:function(){e.props.closeTab()}},"取消"))))}}]),t}(h.default.Component),g=(0,c.connect)(a,{roomSet:m.roomSet,gameTabSet:m.gameTabSet})(_);t.default=g;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(_,"Players","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/InGame/Players.jsx"),__REACT_HOT_LOADER__.register(a,"mapStateToProps","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/InGame/Players.jsx"),__REACT_HOT_LOADER__.register(g,"default","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/InGame/Players.jsx"))})()},function(e,t,i){var s=i(350);"string"==typeof s&&(s=[[e.id,s,""]]);i(260)(s,{});s.locals&&(e.exports=s.locals)},function(e,t,i){t=e.exports=i(259)(),t.push([e.id,".Players .gameTabAvatar{height:32px;width:32px}",""])},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),l=i(1),u=s(l);i(166);i(352);var h=i(281),c=s(h),d=function(e){function t(e){r(this,t);var i=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.state={},i}return o(t,e),a(t,[{key:"end",value:function(){c.default.send({type:"endGame"})}},{key:"render",value:function(){var e=this;return u.default.createElement("div",{className:"Menu"},u.default.createElement("div",{className:"window"},u.default.createElement("div",{style:{textAlign:"center"}},"游戏菜单"),u.default.createElement("div",{className:"buttons"},this.props.isRunning?u.default.createElement("button",{onClick:function(){return e.props.updateIsRunning(!1)}},"暂停游戏"):u.default.createElement("button",{onClick:function(){return e.props.updateIsRunning(!0)}},"继续游戏"),u.default.createElement("button",{onClick:function(){return e.props.restart()}},"重新开始"),u.default.createElement("button",{disabled:!0},"保存游戏"),u.default.createElement("button",{disabled:!0},"装载游戏"),this.props.emulateSound?u.default.createElement("button",{onClick:function(){return e.props.updateEmulateSound(!1)}},"关闭声音"):u.default.createElement("button",{onClick:function(){return e.props.updateEmulateSound(!0)}},"打开声音"),u.default.createElement("button",{onClick:function(){return e.end()}},"结束游戏"),u.default.createElement("br",null),u.default.createElement("button",{onClick:function(){e.props.closeTab()}},"回到游戏"))))}}]),t}(u.default.Component),p=d;t.default=p;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(d,"Menu","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/InGame/Menu.jsx"),__REACT_HOT_LOADER__.register(p,"default","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/InGame/Menu.jsx"))})()},function(e,t,i){var s=i(353);"string"==typeof s&&(s=[[e.id,s,""]]);i(260)(s,{});s.locals&&(e.exports=s.locals)},function(e,t,i){t=e.exports=i(259)(),t.push([e.id,".Menu{position:fixed;left:0;top:0;width:100%;height:100%;background-color:#444;opacity:.9;-moz-opacity:.9;filter:alpha(opacity=90);z-index:100;font-family:arial}.Menu>.window{width:300px;margin:50px auto;top:10%;bottom:10%;padding:33px 30px;color:gold;background:#111;border:2px solid #b09528;border-radius:3px;opacity:.8}.Menu>.window>.buttons{left:10px;right:10px;text-align:center;margin:10px 0}.Menu>.window>.buttons>button{background:#000;border:1px solid #a4821a;color:gold;border-radius:3px;width:100%;margin:5px 0;height:36px;font-size:16px;line-height:22px;outline:0}.Menu>.window>.buttons>button:disabled{border:1px solid #796520;color:#5a6060}.key{float:right}.value{width:38px;height:16px}",""])},function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){return{user:e.user}}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),u=i(1),h=s(u),c=i(166);i(355);var d=i(281),p=(s(d),i(272)),f=s(p),m=i(314),_=(s(m),i(280)),g=function(e){function t(e){r(this,t);var i=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.state=i.props.keyboard,i}return o(t,e),l(t,[{key:"render",value:function(){var e=this;return h.default.createElement("div",{className:"Room-InGame-Tab Keyboard"},h.default.createElement("div",{className:"window"},h.default.createElement("div",{style:{textAlign:"center"}},"按键设置"),h.default.createElement("table",{style:{width:"100%"}},h.default.createElement("thead",null,h.default.createElement("tr",null,h.default.createElement("td",{width:"50%"}),h.default.createElement("td",{width:"50%"}))),h.default.createElement("tbody",null,h.default.createElement("tr",null,h.default.createElement("td",{className:"key"},"上："),h.default.createElement("td",null,h.default.createElement("input",{className:"value",ref:"up",type:"text",value:f.default.KEYCODE_TABLE[this.state.up],onKeyUp:function(t){e.setState({up:t.keyCode}),e.refs.down.focus()}})))),h.default.createElement("tbody",null,h.default.createElement("tr",null,h.default.createElement("td",{className:"key"},"下："),h.default.createElement("td",null,h.default.createElement("input",{className:"value",ref:"down",type:"text",value:f.default.KEYCODE_TABLE[this.state.down],onKeyUp:function(t){e.setState({down:t.keyCode}),e.refs.left.focus()}})))),h.default.createElement("tbody",null,h.default.createElement("tr",null,h.default.createElement("td",{className:"key"},"左："),h.default.createElement("td",null,h.default.createElement("input",{className:"value",ref:"left",type:"text",value:f.default.KEYCODE_TABLE[this.state.left],onKeyUp:function(t){e.setState({left:t.keyCode}),e.refs.right.focus()}})))),h.default.createElement("tbody",null,h.default.createElement("tr",null,h.default.createElement("td",{className:"key"},"右："),h.default.createElement("td",null,h.default.createElement("input",{className:"value",ref:"right",type:"text",value:f.default.KEYCODE_TABLE[this.state.right],onKeyUp:function(t){e.setState({right:t.keyCode}),e.refs.select.focus()}})))),h.default.createElement("tbody",null,h.default.createElement("tr",null,h.default.createElement("td",{className:"key"},"选择："),h.default.createElement("td",null,h.default.createElement("input",{className:"value",ref:"select",type:"text",value:f.default.KEYCODE_TABLE[this.state.select],onKeyUp:function(t){e.setState({select:t.keyCode}),e.refs.start.focus()}})))),h.default.createElement("tbody",null,h.default.createElement("tr",null,h.default.createElement("td",{className:"key"},"确认："),h.default.createElement("td",null,h.default.createElement("input",{className:"value",ref:"start",type:"text",value:f.default.KEYCODE_TABLE[this.state.start],onKeyUp:function(t){e.setState({start:t.keyCode}),e.refs.A.focus()}})))),h.default.createElement("tbody",null,h.default.createElement("tr",null,h.default.createElement("td",{className:"key"},"A："),h.default.createElement("td",null,h.default.createElement("input",{className:"value",ref:"A",type:"text",value:f.default.KEYCODE_TABLE[this.state.A],onKeyUp:function(t){e.setState({A:t.keyCode}),e.refs.B.focus()}})))),h.default.createElement("tbody",null,h.default.createElement("tr",null,h.default.createElement("td",{className:"key"},"B："),h.default.createElement("td",null,h.default.createElement("input",{className:"value",ref:"B",type:"text",value:f.default.KEYCODE_TABLE[this.state.B],onKeyUp:function(t){e.setState({B:t.keyCode}),e.refs.X.focus()}})))),h.default.createElement("tbody",null,h.default.createElement("tr",null,h.default.createElement("td",{className:"key"},"X："),h.default.createElement("td",null,h.default.createElement("input",{className:"value",ref:"X",type:"text",value:f.default.KEYCODE_TABLE[this.state.X],onKeyUp:function(t){e.setState({X:t.keyCode}),e.refs.Y.focus()}})))),h.default.createElement("tbody",null,h.default.createElement("tr",null,h.default.createElement("td",{className:"key"},"Y："),h.default.createElement("td",null,h.default.createElement("input",{className:"value",ref:"Y",type:"text",value:f.default.KEYCODE_TABLE[this.state.Y],onKeyUp:function(t){e.setState({Y:t.keyCode}),e.refs.up.focus()}}))))),h.default.createElement("div",{className:"exitButtons"},h.default.createElement("button",{onClick:function(){e.props.updateKeyboard(e.state),e.props.closeTab()}},"确定"),h.default.createElement("button",{onClick:function(){e.props.closeTab()}},"取消"))))}}]),t}(h.default.Component),b=(0,c.connect)(a,{roomSet:_.roomSet,gameTabSet:_.gameTabSet,tabSet:_.tabSet,keyboardSet:_.keyboardSet})(g);t.default=b;(function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(g,"KeyboardSetting","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/InGame/KeyboardSetting.jsx"),__REACT_HOT_LOADER__.register(a,"mapStateToProps","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/InGame/KeyboardSetting.jsx"),__REACT_HOT_LOADER__.register(b,"default","/Users/meteor/go/src/github.com/MeteorKL/nes-online/react/src/container/Room/InGame/KeyboardSetting.jsx"))})()},function(e,t,i){var s=i(356);"string"==typeof s&&(s=[[e.id,s,""]]);i(260)(s,{});s.locals&&(e.exports=s.locals)},function(e,t,i){t=e.exports=i(259)(),t.push([e.id,"",""])}]);